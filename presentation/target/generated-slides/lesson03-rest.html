<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>REST Grundlagen</title><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport"><link href="reveal.js-3.9.2/css/reveal.css" rel="stylesheet"><link href="reveal.js-3.9.2/plugin/title-footer/title-footer.css" rel="stylesheet"><link rel="stylesheet" href="reveal.js-3.9.2/css/theme/anderscore.css" id="theme"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css"><style>/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}</style><link href="reveal.js-3.9.2/lib/css/zenburn.css" rel="stylesheet"><script>document.write( '<link rel="stylesheet" href="reveal.js-3.9.2/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script></head><body><div class="reveal"><div class="slides"><section><section id="_rest_grundlagen"><h2>REST Grundlagen</h2><div class="ulist"><ul><li><p>Steht für <strong>Representational State Transfer</strong></p></li><li><p>Begriff: Doktorarbeit von Roy Fielding aus dem Jahr 2000</p></li><li><p>Technologie für Maschine zu Maschine Kommunikation</p></li><li><p>Fußt auf den Prinzipien des Web (Web für Maschinen)</p></li><li><p>Eine REST-API muss 5 Bedingungen erfüllen</p></li></ul></div></section><section id="_1_client_server"><h2>1. Client-Server</h2><div class="ulist"><ul><li><p>Strikte Trennung der Systeme</p></li><li><p>Verbindung kann unterbrochen sein</p></li></ul></div></section><section id="_2_zustandslos"><h2>2. Zustandslos</h2><div class="ulist"><ul><li><p>Keine Sitzungsinformation auf dem Server<br>
(Andernfalls nur REST-artig)</p></li><li><p>Zustand (Sitzung) wird auf Client vorgehalten</p></li><li><p>Nachrichten sind selbstbeschreibend</p></li><li><p>Jede Anfrage muss alle notwendigen Informationen enthalten,
damit der Server diese verarbeiten kann (inkl. Sitzungsinformationen)</p></li><li><p>Jede Antwort muss alle Informationen enthalten, die der Client
benötigt, um die Sitzung zu aktualisieren</p></li></ul></div></section><section id="_3_cachbar"><h2>3. Cachbar</h2><div class="ulist"><ul><li><p>Antworten müssen Informationen enthalten,
ob und wie lange gecached werden kann</p></li><li><p>Client kann nicht davon Ausgehen, dass Antwort direkt vom Server kommt</p></li></ul></div></section><section id="_4_schichtenarchitektur"><h2>4. Schichtenarchitektur</h2><div class="ulist"><ul><li><p>Zwischen Client und Server kann diverse Middleware liegen</p></li><li><p>&#8658; Erhöht Skalierbarkeit und Ausfallsicherheit</p></li></ul></div></section><section id="_5_einheitliche_schnittstelle"><h2>5. Einheitliche Schnittstelle</h2><div class="ulist"><ul><li><p>Einhaltung der HTTP-Spezifikation</p></li><li><p>Ein Vertrag für alle Belange</p></li></ul></div>
<div class="paragraph"><p><br></p></div>
<div class="paragraph"><p>Richtlinien der einheitlichen Schnittstelle:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Ressourcen basiert (URIs zur Identifizierung, repräsentationsunabhängig)</p></li><li><p>Bearbeitung der Ressourcen über deren Repräsentation</p></li><li><p>Selbstbeschreibende Nachrichten (jede Nachricht enthält explizt alles, was zu
deren Verarbeitung notwendig ist, z. B. Typ, Cachbarkeit)</p></li><li><p><em>Hypermedia as the Engine of Application State</em> (HATEOS)</p></li></ol></div></section><section id="_hateoas"><h2>HATEOAS</h2><div class="ulist"><ul><li><p>Client-Request enthält alle notwendigen Zustandsinformationen, die der Server benötigt,
um den Request zu bearbeiten. Der Server weiß (speichert) nichts zu dem Client.</p></li><li><p>Der Server muss in seiner Antwort jeglichen Zustand an den Client übertragen, der
für den nächsten Schritt notwendig ist.</p></li><li><p>Der Client übertägt die Zustandsinformation in Form von URLs, Request-Parametern,
Request-Headern und dem Request-Inhalt (Body). Der Server überträgt Zustand mittels
dem Inhalt der Antwort (Body), den Headern und dem Response-Code.</p></li><li><p>Daneben versteht man unter HATEOAS auch, dass Antworten im Inhalt oder im Header (<em>Location</em>, <em>Link</em>)
die Links zu den zurückgegeben Objekten und ggf. zu weiterführenden Objekten enthalten.</p></li></ul></div></section><section id="_6_ausführbarer_code_auf_anforderung_optional"><h2>6. Ausführbarer Code auf Anforderung (optional)</h2><div class="paragraph"><p>Server kann Funktionalität auf den Client übertragen (z. B. JavaScript-Code)</p></div></section><section id="_resourcen_basiert"><h2>Resourcen basiert</h2><div class="ulist"><ul><li><p>Resourcen (Dinge) werden über URIs identifiziert<br>
(es kann mehrere URIs geben, die auf die gleiche Ressource zeigen)</p></li><li><p>Resourcen sind unabhängig von deren Repräsenation (verschiedene Repräsenationen möglich)</p></li><li><p>Aktionen werden über HTTP-Verben (GET, POST, PUT, DELETE) angegeben</p></li><li><p>Repräsenationen (JSON, XML, HTML, PDF, etc.) werden über den Content-Type (MIME) angegeben</p></li><li><p>&#8658; URLs werden zum Adressieren von Ressourcen verwendet</p></li></ul></div>
<div class="paragraph"><p><br></p></div>
<table class="tableblock frame-all grid-all" style="width:50%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">REST URLs</th><th class="tableblock halign-left valign-top">SOAP-RPC URLs</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Dinge</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Aktionen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Substantive</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Verben</p></td></tr></table></section><section id="_repräsentationen"><h2>Repräsentationen</h2><div class="ulist"><ul><li><p>Die Repräsentationen sind das, was tatsächlich zwischen Client und Server übertragen wird</p></li><li><p>Sie geben den Ressourcen Zustand (oder einen Teil davon) wieder</p></li><li><p>Umfassen neben Nutzdaten auch Metadaten (Typinformationen)</p></li><li><p>Typischerweise JSON oder XML, kann aber beliebiges Format sein (z. B. PDF, HTML, &#8230;&#8203;)</p></li></ul></div></section><section id="_vorteile"><h2>Vorteile</h2><div class="ulist"><ul><li><p>Skalierbarkeit</p></li><li><p>Einfachheit</p></li><li><p>Wartbarkeit</p></li><li><p>Sichtbarkeit</p></li><li><p>Portierbarkeit</p></li><li><p>Zuverlässigkeit</p></li></ul></div>
<div class="paragraph"><p><a href="https://www.restapitutorial.com/lessons/whatisrest.html">
&#8594; www.restapitutorial.com: What is REST?</a></p></div></section><section id="_http_verben"><h2>HTTP Verben</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:14.2857%"><col style="width:28.5714%"><col style="width:57.1429%"></colgroup><tbody><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">GET</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">idempotent und sicher</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Eine (Menge von) Ressource(n) über ihre URI abrufen</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">POST</p></th><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erstellt eine Ressource</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">PUT</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">idempotent</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Eine (Menge von) Ressource(n) anhand ihrer URI ändern (vollständig ersetzen)</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">PATCH</p></th><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class="tableblock">Eine Ressource ändern (nur einzelne Attribute)</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">DELETE</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">idempotent</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Entfernt eine Ressource anhand ihrer URI</p></td></tr></table>
<div class="paragraph"><p><a href="https://www.restapitutorial.com/lessons/httpmethods.html">
&#8594; HTTP-Methods für REST</a><br>
<a href="https://www.tutorialspoint.com/http/http_methods.htm">
&#8594; HTTP-Methods allgemein</a></p></div>
<aside class="notes"><div class="ulist"><ul><li><p><strong>Sicher</strong> heißt: Die Operation ändert nichts.</p></li><li><p><strong>GET</strong> Parameter können für Filter verwendet werden.</p></li><li><p><strong>PUT</strong> kann auch zum Anlegen verwendet werden, wenn der Identifier (die URI) bereits vorher bekannt ist.
Die URI muss die zu ändernde(n) Resource(n) eindeutig identifizieren (nicht der Nachrichteninhalt).</p></li><li><p><strong>POST</strong> kann für alle anderen Operationen verwendet werden, die zu keiner der genannten Kategorieen passt.</p></li><li><p><strong>DELETE</strong> ist zwar idempotnent, kann aber dennoch verschiedene Resposes liefern: 204 (wurde gelöscht)
und 404 (nicht mehr vorhanden)</p></li></ul></div></aside></section><section id="_richtlinien_für_rest_uris"><h2>Richtlinien für REST-URIs</h2><div class="ulist"><ul><li><p>IDs sind immer Bestandteil der URL (Parameter nur zum Filtern)</p></li><li><p>Nur Substantive (Verben sind ein <em>Bad Smell</em>)</p></li><li><p>Plural</p></li><li><p>Nur Kleinbuchstaben und '-' zur Trennung</p></li><li><p><em>/users</em> für eine Menge und <em>/users/123</em> für einzelne Ressource</p></li></ul></div>
<div class="paragraph"><p>Beispiel: <code>account/payment</code> statt <code>account/pay</code></p></div></section><section id="_wichtigste_http_antwortcodes"><h2>Wichtigste HTTP Antwortcodes</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:33.3333%"><col style="width:66.6667%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">200 OK</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erfolg (normale Antwort)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">201 CREATED</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erfolgreich erstellt (Antwort auf POST)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">204 NO CONTENT</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erfolg, aber kein Inhalt (Antwort auf DELETE)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">400 BAD REQUEST</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Anfrage kann nicht verarbeitet werden (Validierungsfehler)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">401 UNAUTHORIZED</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Notwendige Authentifizerung fehlt (z.B. kein Token vorhanden)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">403 FORBIDDEN</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Berechtigung nicht ausreichend</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">404 NOT FOUND</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Ressource existiert nicht</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">405 METHOD NOT ALLOWED</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">HTTP-Methode für die entsprechende URI nicht anwendbar</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">409 CONFLICT</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Bearbeitung der Anfrage würde zu Inkonsistenzen führen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">410 GONE</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Die Ressource wurde gelöscht (wenn das bekannt ist, sonst 404)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">415 UNSUPPORTED MEDIA TYPE</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Format der übertragenen Daten nicht untersützt</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">500 INTERNAL SERVER ERROR</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Unerwarteter Fehler auf Server</p></td></tr></table>
<div class="paragraph"><p><a href="https://www.restapitutorial.com/lessons/httpstatuscodes.html">
&#8594; HTTP Status Codes</a><br></p></div>
<aside class="notes"><div class="dlist"><dl><dt class="hdlist1">405 METHOD NOT ALLOWED</dt><dd><p>Beispielsweise bei einem POST auf <em>/users/123</em> statt auf <em>/users</em>. Die Antwort muss einen <em>Allow</em> Header mit den
unterstützten Methoden enthalten, z. B. <code>Allow: GET, PUT</code></p></dd><dt class="hdlist1">409 CONFLICT</dt><dd><p>Beispielsweise doppelte Einträge</p></dd></dl></div></aside></section><section id="_fragen"><h2>Fragen?</h2><div class="ulist"><div class="title">Auch interessant:</div><ul><li><p>JSON-API</p></li></ul></div></section></section>
<section id="_rest_mit_jsr_370_jax_rs_2_1"><h2>REST mit JSR 370 / JAX-RS 2.1</h2><div class="paragraph heading"><p>JSR 370: Java API for RESTful Web Services (JAX-RS 2.1)</p></div>
<div class="ulist"><ul><li><p>Vormals JSR-339, JSR-311</p></li><li><p>Paket <code>java.ws.rs</code></p></li><li><p>Implementierungen:</p><div class="ulist"><ul><li><p>Project Jersey (<a href="http://jersey.java.net" class="bare">http://jersey.java.net</a>), <em>Referenz</em></p></li><li><p>RESTEasy (<a href="https://resteasy.github.io/" class="bare">https://resteasy.github.io/</a>), <em>In Quarkus verwendet</em></p></li></ul></div></li><li><p>Pfade, HTTP-Verben, etc. als Annotationen</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/echo</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">EchoResource</span> {
    <span class="comment">// ...</span>
    <span class="annotation">@GET</span> <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{spell}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
    <span class="directive">public</span> <span class="predefined-type">String</span> echo(<span class="annotation">@PathParam</span> <span class="predefined-type">String</span> spell) {
        <span class="keyword">return</span> service.echo(spell);
    }
}</code></pre></section>
<section id="_rest_apis_testen_http_client"><h2>REST-APIs testen: HTTP-Client</h2><div class="paragraph heading"><p><strong>curl</strong> (über <strong>Git Bash</strong> aufrufbar)</p></div>
<div class="paragraph"><p>Liste aller Tasks:</p></div>
<div class="literalblock"><div class="content"><pre>curl http://localhost:8080/tasks</pre></div></div>
<div class="paragraph"><p>Einen Task hinzufügen:</p></div>
<div class="literalblock"><div class="content"><pre>curl -d '{"description": "curl lernen", "state":"STARTED", "dateDue":"2019-05-25T10:15:00Z"}' \
     -H "Content-Type: application/json" -X POST http://localhost:8080/tasks</pre></div></div>
<div class="paragraph"><p>Task löschen (mit <code>-v</code> werden u. a. Status-Code und Header ausgegeben):</p></div>
<div class="literalblock"><div class="content"><pre>curl -v -X DELETE http://localhost:8080/tasks/2</pre></div></div>
<div class="paragraph heading"><p>Alternativen:</p></div>
<div class="ulist"><ul><li><p><a href="https://www.getpostman.com/">&#8594; Postman</a></p></li><li><p><a href="https://addons.mozilla.org/de/firefox/addon/restclient/">&#8594; RESTClient (Browser-Plugin)</a></p></li></ul></div></section>
<section id="_aufgabe_3_1_lesson03_rest"><h2>Aufgabe 3.1: lesson03-rest</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong>:</p></div>
<div class="ulist"><ul><li><p>Implementieren Sie eine REST-API für die Verwaltung von Pizza-Bestellungen.</p></li><li><p>Die Resource soll Create-, Read-, Update- und Delete-Operationen erlauben.</p></li><li><p>Zusätzlich sollen alle Bestellungen als Liste abrufbar sein (index).</p></li><li><p>Testen Sie die API mit postman</p></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong>:</p></div>
<div class="ulist"><ul><li><p>Im Ordner <code>lesson03_1-rest/lesson03</code> befindet sich bereits ein Skelett samt Repository und Model</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson03/lesson03_1-rest</code></p></li><li><p>Es sollen erstmal nur die Positivfälle behandelt und noch kein HTTP Status Code zurück gegeben werden</p></li><li><p><a href="https://quarkus.io/guides/rest-json">&#8594; Quarkus Guide</a></p></li></ul></div></section>
<section id="_rest_apis_response_builder"><h2>REST-APIs: Response Builder</h2><div class="paragraph heading"><p>HTTP-Semantik</p></div>
<div class="ulist"><ul><li><p>Bisher: Direkte Rückgabe (JSON-Encoding)</p></li><li><p>Alternativ: Response-Builder (z.B. HTTP-Status-Codes)</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="java language-java">    <span class="annotation">@POST</span>
    <span class="directive">public</span> Response create(Customer customer) {
        customerRepository.createCustomer(customer);
        <span class="keyword">return</span> Response.status(<span class="integer">201</span>).build();
    }</code></pre>
<div class="paragraph"><p>Vgl. <a href="https://javaee.github.io/javaee-spec/javadocs/javax/ws/rs/core/Response.html" class="bare">https://javaee.github.io/javaee-spec/javadocs/javax/ws/rs/core/Response.html</a></p></div></section>
<section id="_rest_apis_exception_handling_explizit"><h2>REST-APIs: Exception Handling: Explizit</h2><pre class="CodeRay listingblock"><code class="java language-java">    <span class="annotation">@RequestScoped</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">users</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">class</span> <span class="class">UsersResource</span> {

        <span class="annotation">@Inject</span>
        UserRepository userRepository;

        <span class="annotation">@POST</span>
        <span class="directive">public</span> Response registerUser(User userRequest) {
            <span class="keyword">try</span> {
                User managedUser = userRepository.register(userRequest);
                <span class="keyword">return</span> Response.created(managedUser).build();
            } <span class="keyword">catch</span> (<span class="exception">Exception</span> ex) {
               <span class="keyword">return</span> Response.status(<span class="integer">405</span>).build();
            }

        }
    }</code></pre>
<div class="paragraph"><p><a href="https://jaxenter.de/wie-man-ein-zentralisiertes-rest-api-exception-handling-mit-beanvalidation-kombiniert-24427" class="bare">https://jaxenter.de/wie-man-ein-zentralisiertes-rest-api-exception-handling-mit-beanvalidation-kombiniert-24427</a></p></div></section>
<section id="_rest_apis_exception_handling_zentralisiert_aspekt"><h2>REST-APIs: Exception Handling: Zentralisiert (Aspekt)</h2><div class="paragraph"><p>Around Advice</p></div>
<pre class="CodeRay listingblock"><code class="java language-java">    <span class="directive">public</span> <span class="type">class</span> <span class="class">APIExceptionInterceptor</span> {
        <span class="annotation">@AroundInvoke</span>
        <span class="directive">public</span> <span class="predefined-type">Object</span> handleException(InvocationContext context) { <span class="predefined-type">Object</span> proceedResponse;
            <span class="keyword">try</span> {
                proceedResponse = context.proceed();
            } <span class="keyword">catch</span> (<span class="exception">Exception</span> ex) {
                <span class="keyword">return</span> Response.serverError().entity(ex.getMessage()).build();
            }
            <span class="keyword">return</span> proceedResponse;
        }
    }</code></pre>
<div class="paragraph"><p>Einbindung</p></div>
<pre class="CodeRay listingblock"><code class="java language-java">    <span class="annotation">@RequestScoped</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">users</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Interceptor</span>(APIExceptionInterceptor.class)
    <span class="directive">public</span> <span class="type">class</span> <span class="class">UsersResource</span> {
       <span class="comment">// ...</span>
    }</code></pre>
<div class="paragraph"><p><a href="https://jaxenter.de/wie-man-ein-zentralisiertes-rest-api-exception-handling-mit-beanvalidation-kombiniert-24427" class="bare">https://jaxenter.de/wie-man-ein-zentralisiertes-rest-api-exception-handling-mit-beanvalidation-kombiniert-24427</a></p></div></section>
<section id="_rest_apis_exception_handling_integration_test_automatisiert"><h2>REST-APIs: Exception Handling: Integration-Test (automatisiert)</h2><div class="ulist"><ul><li><p>Bisher: Postman, curl, &#8230;&#8203;</p></li><li><p>Vorteile:</p><div class="ulist"><ul><li><p>Vollständiger end-to-end Test</p></li><li><p>Verifiziert realistische Umgebung</p></li></ul></div></li><li><p>Nachteile:</p><div class="ulist"><ul><li><p>Laufzeit-Umgebung wird benötigt</p></li><li><p>Kaum Integration in IDE und CI/CD</p></li></ul></div></li><li><p>Alternativ Integrationstest mit <code>@QuarkusTest</code></p><div class="ulist"><ul><li><p>Start eines HTTP-Service zur Testausführung</p></li><li><p>Integration in Maven</p></li></ul></div></li></ul></div></section>
<section id="_beispiel_rest_apis_beispiel_quarkustest"><h2>Beispiel REST-APIs: Beispiel <code>@QuarkusTest</code></h2><pre class="CodeRay listingblock"><code class="java language-java">    <span class="annotation">@QuarkusTest</span>
    <span class="directive">public</span> <span class="type">class</span> <span class="class">StaticContentTest</span> {

        <span class="annotation">@TestHTTPEndpoint</span>(HelloResource.class)
        <span class="annotation">@TestHTTPResource</span>
        <span class="predefined-type">URL</span> url;

        <span class="annotation">@Test</span>
        <span class="directive">public</span> <span class="type">void</span> testIndexHtml() <span class="directive">throws</span> <span class="exception">Exception</span> {
            <span class="keyword">try</span> (<span class="predefined-type">InputStream</span> in = url.openStream()) {
                <span class="predefined-type">String</span> contents = readStream(in);
                Assertions.assertTrue(contents.equals(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>));
            }
        }

        <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> readStream(<span class="predefined-type">InputStream</span> in) <span class="directive">throws</span> <span class="exception">IOException</span> {
            <span class="comment">// ...</span>
        }
    }</code></pre>
<div class="paragraph"><p><code>@QuarkusTest</code>: Start eines HTTP-Service zur Testausführung, Integration in Maven (Surefire)</p></div>
<div class="paragraph"><p><code>@TestHTTPResource</code>, <code>@TestHTTPEndpoint:(GreetingResource.class)</code>: URL-Injection, Referenz</p></div>
<div class="paragraph"><p>Vgl. <a href="https://quarkus.io/guides/getting-started-testing" class="bare">https://quarkus.io/guides/getting-started-testing</a></p></div></section>
<section id="_rest_apis_exception_handling_integration_test_automatisiert_2"><h2>REST-APIs: Exception Handling: Integration-Test (automatisiert)</h2><div class="paragraph heading"><p>REST-assured</p></div>
<div class="paragraph"><p>Aufruf der Greeting-Resource aus dem Hello-Word-Beispiel:</p></div>
<pre class="CodeRay listingblock"><code class="java language-java">    <span class="keyword">import</span> <span class="include">static</span> <span class="include">io.restassured.RestAssured.given</span>;
    <span class="keyword">import</span> <span class="include">static</span> <span class="include">org.hamcrest.CoreMatchers.is</span>;

    <span class="annotation">@QuarkusTest</span>
    <span class="annotation">@TestHTTPEndpoint</span>(HelloResource.class)
    <span class="directive">public</span> <span class="type">class</span> <span class="class">HelloResourceTest</span> {

        <span class="annotation">@Test</span>
        <span class="directive">public</span> <span class="type">void</span> testHelloEndpoint() {
            given()
              .when().get()
              .then()
                 .statusCode(<span class="integer">200</span>)
                 .body(is(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>));
        }
    }</code></pre>
<div class="paragraph"><p>Vgl. <a href="https://github.com/rest-assured/rest-assured/wiki/Usage" class="bare">https://github.com/rest-assured/rest-assured/wiki/Usage</a></p></div></section>
<section id="_aufgabe_3_2_lesson03_test"><h2>Aufgabe 3.2: lesson03-test</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong>:</p></div>
<div class="ulist"><ul><li><p>Erweitern Sie die Pizza-Ressource um passende Status-Codes</p><div class="ulist"><ul><li><p>HTTP-201 (created), wenn eine Bestellung erstellt wurde</p></li><li><p>HTTP-204 (no content), wenn eine andere Operation ohne Rückgabe erfolgreich war</p></li><li><p>HTTP-404 (not found), falls eine Bestellung nicht gefunden wurde</p></li><li><p>HTTP-422 (unprocessable entity), falls bei <code>create</code> eine ID übermittelt wurde</p></li></ul></div></li><li><p>Verifizieren Sie die Funktionsweise beispielhaft mit einem Rest-assured Test je Status-Code.</p></li><li><p>Verifizieren Sie, dass die Bestellung 4711 korrekt aus der Datenbank geladen werden kann.</p></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong>:</p></div>
<div class="ulist"><ul><li><p>Im Ordner <code>lesson03_2-test/lesson03</code> befindet sich bereits ein Skelett. Es entspricht der Beispiellösung aus Aufgabe 3.1</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson03/lesson03_2-test</code></p></li></ul></div>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section></div></div><script src="reveal.js-3.9.2/lib/js/head.min.js"></script><script src="reveal.js-3.9.2/js/reveal.js"></script><script>// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display controls in the bottom right corner
  controls: true,
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: true,
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Enable slide navigation via mouse wheel
  mouseWheel: true,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  previewLinks: false,
  // Theme (e.g., beige, black, league, night, serif, simple, sky, solarized, white)
  // NOTE setting the theme in the config no longer works in reveal.js 3.x
  //theme: Reveal.getQueryHash().theme || 'anderscore',
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: Reveal.getQueryHash().transition || 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1728,
  height: 972,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js-3.9.2/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js-3.9.2/plugin/title-footer/title-footer.js', async: true, callback: function()
          {title_footer.initialize('Jakarta EE Microservices mit Quarkus & MicroProfile', 'MJohenneken, ALambertz', 'anderScore GmbH • Frankenwerft 35 • 50667 Köln');}},
      { src: 'reveal.js-3.9.2/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js-3.9.2/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      
      { src: 'reveal.js-3.9.2/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js-3.9.2/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
  ]
});</script></body></html>