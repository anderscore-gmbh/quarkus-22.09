<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Jakarta EE Microservices mit Quarkus &amp; MicroProfile</title><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport"><link href="reveal.js-3.9.2/css/reveal.css" rel="stylesheet"><link href="reveal.js-3.9.2/plugin/title-footer/title-footer.css" rel="stylesheet"><link rel="stylesheet" href="reveal.js-3.9.2/css/theme/anderscore.css" id="theme"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css"><style>/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}</style><link href="reveal.js-3.9.2/lib/css/zenburn.css" rel="stylesheet"><script>document.write( '<link rel="stylesheet" href="reveal.js-3.9.2/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script></head><body><div class="reveal"><div class="slides"><section id="_jakarta_ee_microservices_mit_quarkus_microprofile" data-state="no-title-footer"><h2>Jakarta EE Microservices mit Quarkus &amp; MicroProfile</h2><div class="paragraph center"><p>13.10. - 15.10.21<br></p></div>
<div class="paragraph center"><p>MJohenneken, ALambertz</p></div>
<div class="imageblock" style=""><img src="images/anderscore/GFU.svg" alt="GFU" height="300"></div></section>
<section id="_vorstellung" class="columns"><h2>Vorstellung</h2><div class="openblock two-col"><div class="content"><div class="paragraph heading"><p>André Lambertz (Softwareentwickler)</p></div>
<div class="ulist"><ul><li><p>Mathematisch-Technischer Softwareentwickler</p></li><li><p>Seit 2020 bei anderScore</p></li><li><p>Fokus auf Backend-Programmierung</p></li></ul></div></div></div>
<div class="imageblock" style=""><img src="images/alambertz.png" alt="alambertz" height="600][pdfwidth=7cm"></div></section>
<section id="_unternehmen"><h2>Unternehmen</h2><div class="paragraph"><p>
<head>
<style>
	span.r {
		color:#225c4d;
	}
	ul.bullet li::before{
  		content: "\25CF";
  		color: #225c4d;
  		display: inline-block;
  		margin-right: 20px;
	}
	ul.checkmark li::before{
  		content: "\2714";
  		color: #225c4d;
  		display: inline-block;
  		margin-right: 11px;
	}
	ul.arrow li::before{
  		content: "\2794";
  		color: #225c4d;
  		display: inline-block;
  		margin-right: 11px;
	}
</style>
</head>
<body>
<p>
	<div style="position:relative; top:280px;">
		Individuelle Anwendungsentwicklung - Java Enterprise, Web, Mobile
		<ul class="bullet" style="list-style:none;">
			<li>seit 2005 <span class="r">&#160;&#160;&#160;♦&#160;&#160;&#160;</span> in Köln <span class="r">&#160;&#160;&#160;♦&#160;&#160;&#160;</span> für alle Branchen <span class="r">&#160;&#160;&#160;♦&#160;&#160;&#160;</span> <img style="position:relative; top:17px" src="images/anderScore/goldschmiede.png" height="60"></li>
			<li>nach Aufwand & zum Festpreis</li>
		</ul>
		<div class="fragment">
			<ul class="checkmark" style="list-style:none;">
				<li>Digitalisierung / Prozesse / Integration</li>
				<li>Migration</li>
				<li>Neuentwicklung</li>
				<li>Notfall / kritische Situationen</li>
			</ul><br>
			<ul class="arrow" style="list-style:none;">
				<li>pragmatisch, zielgerichtet, zuverlässig</li>
			</ul>
		</div>
	</div>
</p>
<p class="fragment">
	<img style="overflow:hidden; position:relative; bottom:30px; left:830px;" src="images/anderScore/Bereiche.png" height="600">
</p>
<p>
	<div class="fragment">
		<div style="position:relative; bottom:270px;">
		Kompletter SW Life Cycle<br>
			<ul class="bullet" style="list-style:none;">
				<li>Projektmanagement / agile Methodik</li>
				<li>Anforderungsanalyse</li>
				<li>Architektur & SW-Design</li>
				<li>Implementierung & Testautomation</li>
				<li>Studien & Seminare</li>
			</ul>
		</div>
		<div style="position:relative; left:850px; bottom:330px; color:#225c4d; font-weight:bold">
			... und für Sie? Sprechen Sie uns an!
		</div>
	</div>
</p>
</body>
</p></div></section>
<section id="_inhalt_und_ziel"><h2>Inhalt und Ziel</h2><div class="dlist"><dl><dt class="hdlist1">Workshop</dt><dd><div class="ulist"><ul><li><p>Einführung in grundlegende Microservice (µService), Microprofile und Quarkus-Konzepte</p></li><li><p>Überwindung von Einstiegshürden</p></li><li><p>Funktionen und Features werden mit Aufgaben erarbeitet</p></li></ul></div></dd><dt class="hdlist1">Zielgruppe</dt><dd><div class="ulist"><ul><li><p>Software-Entwickler (d/m/w), die µServices mit Quarkus entwickeln möchte</p></li></ul></div></dd><dt class="hdlist1">Voraussetzungen</dt><dd><div class="ulist"><ul><li><p>Gute Java Kenntnisse</p></li><li><p>Sicherheit im Umgang mit einer IDE (hier: IntelliJ Community Edition)</p></li><li><p>Basiswissen zu HTTP, SQL, Transaktionen, JUnit</p></li><li><p>Erfahrung mit Maven</p></li></ul></div></dd></dl></div></section>
<section id="_zeitplan"><h2>Zeitplan</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Beginn</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">09:00 Uhr</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Kaffeepause</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">ca. 10:30 Uhr</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Mittagspause</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">12:00 bis 13:00 Uhr</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Ende</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">16:00 Uhr</p></td></tr></table></section>
<section><section id="_remote_training"><h2>Remote Training</h2><div class="ulist"><ul><li><p>Video-Konferenz über Zoom</p><div class="ulist"><ul><li><p>Bildschirmfreigabe für Folien</p></li><li><p>Breakout Rooms für Übungen</p></li><li><p>Lautsprecher + Mikrophon benötigt, Kamera empfehlenswert</p></li></ul></div></li><li><p>Entwicklung: Remote Desktop Protocol (RDP) zur GFU</p><div class="ulist"><ul><li><p>Praktische Übungen</p></li><li><p>Ubuntu VM (Docker, Kubernetes)</p></li><li><p>Aufschaltung über Zoom möglich</p></li></ul></div></li><li><p>Material auf GitHub</p></li></ul></div></section><section id="_vereinbarungen"><h2>Vereinbarungen</h2><div class="ulist"><ul><li><p>Pausen</p><div class="ulist"><ul><li><p>Gemeinsam zu vorgegebenen Zeiten</p></li><li><p>Individuell während der Übungen</p></li></ul></div></li><li><p>Erreichbarkeit Dozent</p><div class="ulist"><ul><li><p>Zoom (Chat, Mikrophon)</p></li><li><p>E-Mail</p></li><li><p>Handy</p></li><li><p>Kamera aus: gerade nicht anwesend bzw. ansprechbar</p></li></ul></div></li><li><p>Regeln</p><div class="ulist"><ul><li><p>Mikrophon möglichst aus (Hintergrundgeräusche)</p></li><li><p>Bei Fragen: "Hand heben" oder Chat</p></li><li><p>Wenn Übung fertig, selbst in Hauptsession zurückkehren</p></li></ul></div></li></ul></div></section></section>
<section id="_material"><h2>Material</h2><div class="ulist"><ul><li><p>Quarkus Guides<br>
<a href="https://quarkus.io/guides" class="bare">https://quarkus.io/guides</a></p></li><li><p>Quarkus Cheatsheet(s)<br>
<a href="https://lordofthejars.github.io/quarkus-cheat-sheet" class="bare">https://lordofthejars.github.io/quarkus-cheat-sheet</a></p></li><li><p>GitHub QuarkusIO<br>
<a href="https://github.com/quarkusio/quarkus" class="bare">https://github.com/quarkusio/quarkus</a></p></li></ul></div></section>
<section id="_vorstellung_2" class="columns"><h2>Vorstellung</h2><div class="openblock"><div class="content"><div class="paragraph heading"><p>Jetzt sind Sie dran!</p></div>
<div class="ulist"><ul><li><p>Name</p></li><li><p>Vorwissen</p></li><li><p>Erwartungen</p></li><li><p>Themenwünsche</p></li></ul></div></div></div>
<div class="imageblock" style="float: right"><img src="images/anybody.jpg" alt="anybody"></div></section>
<section id="_ihre_umgebung"><h2>Ihre Umgebung</h2><div class="ulist"><ul><li><p>OpenJDK 11</p></li><li><p>Apache Maven</p></li><li><p>Gradle</p></li><li><p>GraalVM Community Edition</p></li><li><p>NodeJS</p></li><li><p>IntelliJ Community Edition</p></li><li><p>Docker Community Edition</p></li><li><p>Minikube</p></li><li><p>Postman</p></li><li><p>Git</p></li></ul></div></section>
<section id="_aufgabe_0_1"><h2>Aufgabe 0.1</h2><div class="paragraph"><p>Aufgabenstellung:</p></div>
<div class="ulist"><ul><li><p>Verbinden Sie sich per RDP in Ihre Umgebung</p></li><li><p>Melden Sie sich an der Ubuntu VM an</p></li><li><p>Überprüfen Sie, dass OpenJDK 11 installiert ist: <code>java -version</code></p></li><li><p>Laden Sie die Unterlagen zum Kurs herunter</p></li><li><p>Blenden Sie die Index-Folie (index.html) auf</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="bash language-bash">    $ git clone git@github.com:anderscore-gmbh/quarkus-22.09.git
    Klone nach 'quarkus-22.09' ...
    remote: Enumerating objects: 831, done.
    remote: Counting objects: 100% (831/831), done.
    remote: Compressing objects: 100% (401/401), done.
    remote: Total 831 (delta 221), reused 828 (delta 218), pack-reused 0
    Empfange Objekte: 100% (831/831), 10.58 MiB | 2.41 MiB/s, fertig.
    Löse Unterschiede auf: 100% (221/221), fertig.</code></pre>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section>
<section id="_lektion_1_einführung" data-state="no-title-footer"><h2>Lektion 1 - Einführung</h2></section>
<section id="_was_ist_quarkus"><h2>Was ist Quarkus?</h2><div class="imageblock" style=""><img src="images/quarkus.jpg" alt="quarkus" width="400"></div>
<div class="openblock"><div class="content"><div class="ulist"><ul><li><p>Java/Kotlin/Scala App Framework</p></li><li><p>JakartaEE + MicroProfile</p></li><li><p>OpenJDK/HotSpot und GraalVM</p></li><li><p>Entwickelt von Red Hat</p></li><li><p>Nachfolger von Thorntail</p></li><li><p>Konkurrent von Spring Boot</p></li></ul></div></div></div></section>
<section id="_quarkus_releases"><h2>Quarkus Releases</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:4.5454%"><col style="width:4.5454%"><col style="width:90.9092%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Datum</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">Version</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Neuigkeit</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">12/2018</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">0.0.1</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erster Github Tag</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">11/2019</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">1.0</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erstes Release</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">06/2020</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">1.5</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">fast-jar packaging format, Picocli, gRPC, GraphQL</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">12/2020</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">1.10</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">JSON as default, Multiple reactive datasources, new Micrometer registries</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">01/2021</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">1.11</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy Reactive, Dev UI</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">02/2021</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">1.12</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Fast jar as default, Multipart support for RESTEasy</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">03/2021</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">1.13</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">DevService, Kubernetes Service Binding, OpenTelemetry</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">06/2021</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">2.0</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Vert.x 4, MicroProfile 4, Continuous Testing</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">05/2022</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">2.9</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">WebAuthn extension, Compression support for Reactive Routes and RESTEasy</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">06/2022</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">2.10</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Loom&#8217;s virtual threads, refinements</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">07/2022</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">2.11</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">new Redis Client API</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">08/2022</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">2.12</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">GraalVM/Mandrel22.2, Kotlin 1.7</p></td></tr></table></section>
<section id="_introducing_quarkus_a_next_generation_kubernetes_native_java_framework"><h2>Introducing Quarkus: A next-generation Kubernetes native Java framework</h2><div class="paragraph heading"><p>Philosophie</p></div>
<div class="ulist margin-bottom-wide"><ul><li><p>Cloud Native, Container First</p></li><li><p>Imperative und reaktive Programmierung</p></li><li><p>Erweiterbarkeit</p></li><li><p>"Freude für Entwickler"</p></li></ul></div>
<div class="paragraph"><p><a href="https://developers.redhat.com/blog/2019/03/07/quarkus-next-generation-kubernetes-native-java-framework" class="bare">https://developers.redhat.com/blog/2019/03/07/quarkus-next-generation-kubernetes-native-java-framework</a></p></div></section>
<section id="_extensions"><h2>Extensions</h2><div class="ulist"><ul><li><p>Integration von Libraries und Frameworks</p></li><li><p>Maven Dependencies</p></li><li><p>Versionen</p></li><li><p>Konfigurationen</p></li><li><p>Optimiert für Quarkus (HotSpot / SubstrateVM)</p></li><li><p>Vergleichbar mit Spring Boot Startern</p></li></ul></div>
<pre class="CodeRay listingblock"><code>mvn quarkus:list-extensions</code></pre></section>
<section id="_quarkus_extensions"><h2>Quarkus Extensions</h2><div class="imageblock" style=""><img src="images/quarkus_extensions.png" alt="quarkus extensions" width="800"></div></section>
<section id="_bootstrapping"><h2>Bootstrapping</h2><div class="paragraph"><p><a href="https://code.quarkus.io" class="bare">https://code.quarkus.io</a></p></div>
<div class="imageblock" style=""><img src="images/quarkus_starter.png" alt="quarkus starter" width="1400"></div></section>
<section id="_guide_getting_started"><h2>Guide: Getting started</h2><div class="paragraph heading"><p>System-Voraussetzungen</p></div>
<div class="olist arabic margin-bottom-wide"><ol class="arabic"><li><p>JDK  11+, Optional: GraalVM (JDK 8 ist deprecated)</p></li><li><p>Apache Maven, Alternativ: Gradle</p></li></ol></div>
<div class="paragraph heading"><p>IDE Unterstützung</p></div>
<div class="ulist"><ul><li><p>Eclipse: JBoss Tools (<a href="https://tools.jboss.org" class="bare">https://tools.jboss.org</a>) &amp; Code Ready Studio (Redhat Support)</p></li><li><p>IntelliJ</p><div class="ulist"><ul><li><p>Quarkus Tools: <a href="https://plugins.jetbrains.com/plugin/13234-quarkus-tools" class="bare">https://plugins.jetbrains.com/plugin/13234-quarkus-tools</a></p></li><li><p>Quarkus Run Configs: <a href="https://plugins.jetbrains.com/plugin/14242-quarkus-run-configs" class="bare">https://plugins.jetbrains.com/plugin/14242-quarkus-run-configs</a></p></li><li><p>Quarkus (Ultimate Edition): <a href="https://www.jetbrains.com/help/idea/quarkus.html" class="bare">https://www.jetbrains.com/help/idea/quarkus.html</a></p></li></ul></div></li><li><p>Microsoft Visual Studio Code: Quarkus Tools (<a href="https://marketplace.visualstudio.com/items?itemName=redhat.vscode-quarkus" class="bare">https://marketplace.visualstudio.com/items?itemName=redhat.vscode-quarkus</a>)</p></li></ul></div>
<div class="paragraph"><p><em>Die Beispiele verwenden IntelliJ + Quarkus Tools + Quarkus Run Configs. Sie sind jedoch frei in der Wahl Ihrer IDE.</em></p></div></section>
<section id="_guide_getting_started_2"><h2>Guide: Getting started</h2><div class="paragraph heading"><p>Hello Quarkus: "2. Architecture"</p></div>
<div class="imageblock" style=""><img src="images/getting-started-architecture.png" alt="getting started architecture" width="1400"></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/getting-started" class="bare">https://quarkus.io/guides/getting-started</a></p></div></section>
<section id="_guide_getting_started_3"><h2>Guide: Getting started</h2><div class="paragraph heading"><p>Hello Quarkus</p></div>
<div class="paragraph"><p>Projekt generieren</p></div>
<pre class="CodeRay listingblock"><code>$ mvn io.quarkus:quarkus-maven-plugin:2.12.1.Final:create \
  -DprojectGroupId=net.gfu.quarkus \
  -DprojectArtifactId=hello \
  -DclassName="net.gfu.quarkus.hello.HelloResource" \
  -Dpath="/hello"</code></pre>
<div class="paragraph"><p>&#160;
In Verzeichnis wechseln und Server starten</p></div>
<pre class="CodeRay listingblock"><code>$ cd hello
$ ./mvnw compile quarkus:dev</code></pre>
<div class="paragraph"><p>&#160;
Server testen</p></div>
<pre class="CodeRay listingblock"><code>$ curl -w "\n" http://localhost:8080/hello
hello</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/getting-started" class="bare">https://quarkus.io/guides/getting-started</a></p></div></section>
<section id="_guide_getting_started_4"><h2>Guide: Getting started</h2><div class="paragraph heading"><p>Artefakte</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>src/main/docker</p><div class="ulist"><ul><li><p><strong>Dockerfile.jvm</strong> - Container mit OpenJDK</p></li><li><p><strong>Dockerfile.fast-jar</strong> - <em>fast-jar</em>-Variante, Container mit OpenJDK</p></li><li><p><strong>Dockerfile.native</strong> - Container mit <em>ahead-of-time-compilation</em> native image (GraalVM)</p></li><li><p><strong>Dockerfile.native-micro</strong> - zusätzlich <em>micro base image</em>, kleineres Container Image.</p></li></ul></div></li><li><p>src/main/java/net.gfu.quarkus.hello.<strong>HelloResource.java</strong> - Java Implementation</p></li><li><p>src/main/resources/META-INF</p><div class="ulist"><ul><li><p><strong>application.properties</strong> - Zentrale Konfiguration</p></li><li><p>resources/<strong>index.html</strong> - Index-Seite</p></li></ul></div></li><li><p>src/test/java/net.gfu.quarkus.hello</p><div class="ulist"><ul><li><p><strong>HelloResourceTest</strong> - Einfacher Integrationstest (REST-assured)</p></li><li><p><strong>NativeHelloResourceIT</strong> - Integrationstest im <em>ahead-of-time-compilation</em> Setup</p></li></ul></div></li><li><p><strong>pom.xml</strong> - Maven Konfiguration - Quarkus Version z.T. abweichend vom ArcheType</p></li></ol></div></section>
<section id="_guide_getting_started_projekt_erweitern"><h2>Guide: Getting started - Projekt erweitern</h2><div class="paragraph heading"><p>Business Service definieren und injizieren (CDI)</p></div>
<div class="title">HelloService.java</div><pre class="CodeRay listingblock"><code class="java language-java"><span class="keyword">import</span> <span class="include">javax.enterprise.context.ApplicationScoped</span>;

<span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloService</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> greeting(<span class="predefined-type">String</span> name) {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello </span><span class="delimiter">&quot;</span></span> + name;
    }
}</code></pre>
<div class="title">HelloResource.java (ergänzen)</div><pre class="CodeRay listingblock"><code class="java language-java"><span class="comment">// Neue Imports</span>
<span class="keyword">import</span> <span class="include">javax.inject.Inject</span>;
<span class="keyword">import</span> <span class="include">javax.ws.rs.PathParam</span>;

<span class="comment">// Klasse um Attribut *service* und Methode *greeting* wie folgt ergänzen</span>
<span class="annotation">@Inject</span> HelloService service;

<span class="annotation">@GET</span> <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/hello/{name}</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
<span class="directive">public</span> <span class="predefined-type">String</span> greeting(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> name) {
   <span class="keyword">return</span> service.greeting(name);
}
<span class="comment">// HelloResource: Weitere Attribute und Methoden</span></code></pre></section>
<section id="_guide_getting_started_projekt_erweitern_2"><h2>Guide: Getting started - Projekt erweitern</h2><div class="paragraph heading"><p>Erweitertes Projekt testen</p></div>
<div class="title">Shell #1</div><pre class="CodeRay listingblock"><code class="bash language-bash">$ ./mvnw compile quarkus:dev
# ... Weitere Maven Ausgaben
Listening for transport dt_socket at address: 5005
__  ____  __  _____   ___  __ ____  ______
 --/ __ \/ / / / _ | / _ \/ //_/ / / / __/
 -/ /_/ / /_/ / __ |/ , _/ ,&lt; / /_/ /\ \
--\___\_\____/_/ |_/_/|_/_/|_|\____/___/
2022-09-08 09:44:08,163 INFO  [io.quarkus] (Quarkus Main Thread) hello 1.0.0-SNAPSHOT on JVM (powered by Quarkus 2.12.1.Final) started in 2.749s. Listening on: http://localhost:8080

2022-09-08 09:44:08,187 INFO  [io.quarkus] (Quarkus Main Thread) Profile dev activated. Live Coding activated.
2022-09-08 09:44:08,189 INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [cdi, resteasy-reactive, smallrye-context-propagation, vertx]</code></pre>
<div class="title">Shell #2</div><pre class="CodeRay listingblock"><code>$ curl -w "\n" http://localhost:8080/hello/GfU
hello GfU</code></pre></section>
<section id="_aufgabe_1_1_quarkus_echo"><h2>Aufgabe 1.1 - Quarkus Echo</h2><div class="paragraph heading"><p>Aufgabe 1.1 - Quarkus Echo</p></div>
<div class="paragraph"><p>Erzeugen Sie neues Quarkus Projekt und definieren Sie eine Resource echo mit folgender Ausgabe:</p></div>
<pre class="CodeRay listingblock"><code>$ curl -w "\n" http://localhost:8080/hello/Quarkus4711
Quarkus4711</code></pre>
<div class="paragraph"><p>&#160;<br></p></div>
<div class="paragraph"><p>Hinweise:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Neben dem Maven-Archetype können Sie auch <a href="https://code.quarkus.io" class="bare">https://code.quarkus.io</a> zum Erzeugen eines Projekts verwenden</p></li><li><p>Nutzen Sie erneut einen Business-Service und CDI</p></li><li><p>Eine Beispiellösung finden Sie unter solutions/lesson01-intro</p></li><li><p>Auf <a href="https://quarkus.io/guides/getting-started" class="bare">https://quarkus.io/guides/getting-started</a> gibt es eine weitere Anleitung für ein reaktives Projekt. Was sind die Unterschiede?</p></li></ol></div>
<div class="paragraph"><p><a href="lesson02-microservices.html">&#8594; Weiter zu µServices</a></p></div></section>
<section id="_lektion_2_µservices" data-state="no-title-footer"><h2>Lektion 2 - µServices</h2><div class="paragraph text-center"><p>Wofür ist Quarkus gedacht?<br>
Was sind die Anforderung an das Quarkus Framework?<br>
"Top-down" Ansatz</p></div></section>
<section id="_formen_der_modularisierung"><h2>Formen der Modularisierung</h2><div class="openblock columns"><div class="content"><div class="ulist"><ul><li><p><strong>Technisch</strong></p><div class="ulist"><ul><li><p>Klasse, Package</p></li><li><p>Modul/Library</p></li><li><p>Deployment Unit</p></li></ul></div></li></ul></div></div></div>
<div class="openblock"><div class="content"><div class="ulist"><ul><li><p><strong>Fachlich</strong></p><div class="ulist"><ul><li><p>Konzept</p></li><li><p>Produkt</p></li></ul></div></li></ul></div></div></div>
<div class="openblock"><div class="content"><div class="ulist"><ul><li><p><strong>Organisatorisch</strong></p><div class="ulist"><ul><li><p>Team</p></li><li><p>Abteilung</p></li></ul></div></li></ul></div></div></div></section>
<section id="_modularisierung"><h2>Modularisierung</h2><div class="paragraph heading"><p>Warum modularisieren wir?</p></div>
<div class="ulist"><ul><li><p>Beherrschung der Komplexität</p></li><li><p>Parallelisierung der Entwicklung</p></li><li><p>Auffindbarkeit von Code</p></li><li><p>Erleichterung der Wartung</p></li></ul></div></section>
<section id="_monolith" class="columns"><h2>Monolith</h2><div class="openblock"><div class="content"><div class="ulist"><ul><li><p>Schwergewichtiges Software-Artefakt</p></li><li><p>Hohe Anzahl fachlicher Komponenten</p></li><li><p>Einheitliche technische Basis</p></li><li><p>Eine Deployment Unit</p></li><li><p>Ein Prozess zur Laufzeit (teilweise)</p></li><li><p><strong>Nicht</strong> grundsätzlich ein Anti-Pattern!</p></li></ul></div></div></div>
<div class="imageblock" style=""><img src="images/lesson02/Monolith1.jpg" alt="Monolith1" height="400"></div></section>
<section id="_probleme_eines_monolithen" class="columns"><h2>Probleme eines Monolithen</h2><div class="openblock"><div class="content"><div class="ulist"><ul><li><p>Hohe (technische) Kopplung zwischen Komponenten</p></li><li><p>Lange Build Cycles</p></li><li><p>Einzelne Bestandteile nicht unabhängig skalierbar</p></li><li><p>Verzögerte Auslieferung neuer Features</p></li><li><p>Hoher Wartungsaufwand</p></li><li><p>Mangel an Agilität und Innovation</p></li></ul></div></div></div>
<div class="imageblock" style=""><img src="images/lesson02/Monolith2.png" alt="Monolith2" height="600"></div></section>
<section id="_conways_law"><h2>Conway&#8217;s Law</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Organizations which design systems […] are constrained to produce designs which are <strong>copies of the communication structures</strong> of these organizations.</p></div></blockquote><div class="attribution"><cite>How do committees invent?</cite><br>&#8212; Melvin Edward Conway, 1968</div></div>
<div class="paragraph"><p>&#160;<br></p></div>
<div class="paragraph"><p><em>Hinweis: Beobachtung, nicht soziologisch fundiert; mil. Hintergund</em></p></div></section>
<section id="_conways_law_2"><h2>Conway&#8217;s Law</h2><div class="ulist"><ul><li><p>Barrieren in der Kommunikation &#8594; Brüche in der Software</p></li><li><p>Klassische Aufteilung</p><div class="ulist"><ul><li><p>Fachseite</p></li><li><p>Entwickler</p></li><li><p>Datenbankspezialisten</p></li><li><p>Ops</p></li></ul></div></li><li><p>Konsequenzen</p><div class="ulist"><ul><li><p>Unrealistische Anforderungen</p></li><li><p>Keine Kontrolle über Daten</p></li><li><p>Wenig Details zu Fehlern</p></li></ul></div></li></ul></div></section>
<section id="_wohin_geht_die_reise"><h2>Wohin geht die Reise?</h2><div class="imageblock" style=""><img src="images/lesson02/Microservices1.png" alt="Microservices1" height="800"></div></section>
<section id="_microservices"><h2>Microservices</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Microservices sind ein <strong>Architekturmuster</strong> der Informationstechnik, bei dem komplexe Anwendungssoftware aus
<strong>unabhängigen Prozessen</strong> komponiert wird, die untereinander mit <strong>sprachunabhängigen Programmierschnittstellen</strong> kommunizieren.
Die Dienste sind weitgehend <strong>entkoppelt</strong> und erledigen eine <strong>kleine Aufgabe</strong>. So ermöglichen sie einen <strong>modularen Aufbau</strong> von
Anwendungssoftware.</p></div></blockquote><div class="attribution">&#8212; wikipedia.de</div></div></section>
<section id="_microservices_2"><h2>Microservices</h2><div class="imageblock" style=""><img src="images/lesson02/Microservices2.png" alt="Microservices2" height="600"></div></section>
<section id="_merkmale"><h2>Merkmale</h2><div class="paragraph"><p><strong>Ein Microservice&#8230;&#8203;</strong></p></div>
<div class="ulist"><ul><li><p>&#8230;&#8203;läuft in einem <strong>eigenen Prozess</strong> (ggf. mehrere Instanzen).</p></li><li><p>&#8230;&#8203;wird über das <strong>Netzwerk</strong> angesprochen.</p></li><li><p>&#8230;&#8203;kann <strong>unabhängig</strong> deployed, erweitert oder skaliert werden.</p></li><li><p>&#8230;&#8203;repräsentiert einen <strong>Bounded Context</strong> der Fachdomäne,
alternativ einen <strong>Business-Process</strong></p></li><li><p>&#8230;&#8203;ist nicht an die <strong>Technologie</strong> anderer Services gebunden.</p></li><li><p>&#8230;&#8203;wird nur von <strong>einem Team</strong> entwickelt.</p></li><li><p>&#8230;&#8203;hat ein <strong>unabhängiges Datenmodell</strong>.</p></li></ul></div></section>
<section id="_aufbau"><h2>Aufbau</h2><div class="imageblock" style=""><img src="images/lesson02/microservice_anatomy.png" alt="microservice anatomy" height="800"></div></section>
<section id="_kommunikation"><h2>Kommunikation</h2><div class="imageblock" style=""><img src="images/lesson02/kommunikation_right.png" alt="kommunikation right" height="600"></div></section>
<section id="_kommunikation_2"><h2>Kommunikation</h2><div class="imageblock" style=""><img src="images/lesson02/kommunikation_false.png" alt="kommunikation false" height="600"></div></section>
<section id="_herausforderungen"><h2>Herausforderungen</h2><div class="ulist"><ul><li><p>Verteiltes System</p><div class="ulist"><ul><li><p>Orchestrierung</p></li><li><p>Resilienz</p></li><li><p>Konsistenz</p></li><li><p>Debugging</p></li><li><p>Monitoring und Logging</p></li></ul></div></li><li><p>Netzwerk</p><div class="ulist"><ul><li><p>Performance</p></li><li><p>Zuverlässigkeit</p></li></ul></div></li><li><p>Potentieller "Technologiezoo"</p></li></ul></div></section>
<section id="_self_contained_system" class="columns columns"><h2>Self Contained System</h2><div class="openblock"><div class="content"><div class="ulist"><ul><li><p>Eigenständige Anwendung</p><div class="ulist"><ul><li><p>GUI</p></li><li><p>Datenmodell</p></li><li><p>Logik</p></li><li><p>Persistenz</p></li></ul></div></li><li><p>Lose Kopplung an andere Systeme</p><div class="ulist"><ul><li><p>Integration bevorzugt über UI</p></li><li><p>Datenaustausch nur über APIs</p></li><li><p>Möglichst asynchrone Kommunikation</p></li></ul></div></li><li><p>Entwicklung durch <strong>ein</strong> Team</p></li><li><p>Single Responsibility Prinzip</p></li><li><p>Kann aus Microservices bestehen</p></li></ul></div></div></div>
<div class="imageblock" style=""><img src="images/lesson02/SCS.png" alt="SCS" height="500"></div></section>
<section id="_architektur"><h2>Architektur</h2><div class="paragraph heading"><p>Makro-Architektur</p></div>
<div class="ulist"><ul><li><p><em>Welche Services brauchen wir?</em></p></li><li><p><em>Wie sollen die Schnittstellen aussehen?</em></p></li><li><p>Welche Technologiestacks erlauben wir?</p></li><li><p>Wie setzen wir Authentifikation, Monitoring und Logging um?</p></li></ul></div>
<div class="paragraph"><p>Ansatz: <em>Fachlicher Schnitt</em></p></div></section>
<section id="_domain_driven_design"><h2>Domain Driven Design</h2><div class="paragraph heading"><p>Wie klein (oder groß) soll ein µService sein?</p></div>
<div class="ulist checklist"><ul class="checklist"><li><p><i class="icon-check"></i>Wie schneiden wir die Services?</p></li><li><p><i class="icon-check"></i>Wie sollte ein Service aufgebaut sein?</p></li><li><p><i class="icon-check"></i>Wie groß sollte ein Service sein?</p></li><li><p><i class="icon-check"></i>Wie viele Services brauchen wir?</p></li><li><p><i class="icon-check"></i>Wie sollen die Schnittstellen aussehen?</p></li></ul></div></section>
<section id="_domain_driven_design_2" class="columns"><h2>Domain Driven Design</h2><div class="openblock"><div class="content"><div class="ulist"><ul><li><p>Herangehensweise zur <strong>fachlichen</strong> Strukturierung einer Anwendung</p></li><li><p>Domänenmodell</p><div class="ulist"><ul><li><p>Ubiquitous Language</p></li><li><p>Ausgangsbasis der Entwicklung</p></li><li><p>Klassifizierung enthaltener Elemente</p></li></ul></div></li></ul></div></div></div>
<div class="imageblock" style=""><img src="images/lesson02/DDD.jpg" alt="DDD" height="500"></div>
<div class="paragraph"><p>Siehe auch:</p></div>
<div class="ulist"><ul><li><p><a href="https://www.heise.de/developer/artikel/Der-perfekte-Microservice-3091905.html" class="bare">https://www.heise.de/developer/artikel/Der-perfekte-Microservice-3091905.html</a></p></li><li><p><a href="https://www.heise.de/developer/artikel/Microservices-Warum-ein-Domain-Model-in-die-verkehrte-Richtung-fuehren-kann-4142695.html" class="bare">https://www.heise.de/developer/artikel/Microservices-Warum-ein-Domain-Model-in-die-verkehrte-Richtung-fuehren-kann-4142695.html</a></p></li></ul></div></section>
<section id="_domain_driven_design_elemente"><h2>Domain Driven Design: Elemente</h2><div class="imageblock" style=""><img src="images/lesson02/DDDElemente.png" alt="DDDElemente" height="600"></div></section>
<section id="_domain_driven_design_bounded_context"><h2>Domain Driven Design: Bounded Context</h2><div class="ulist"><ul><li><p>Grenze innerhalb einer Domäne</p><div class="ulist"><ul><li><p>Fachlichkeit</p></li><li><p>Datenmodell</p></li><li><p>Konsistenz</p></li><li><p>Organisation</p></li></ul></div></li><li><p>Identifizierung</p><div class="ulist"><ul><li><p>Clustering von Anforderungen (z.B. Use Cases)</p></li><li><p>Bestimmung von Abhängigkeiten</p></li></ul></div></li></ul></div></section>
<section id="_domain_driven_design_stategic_design"><h2>Domain Driven Design: Stategic Design</h2><div class="paragraph heading"><p>Kommunikationsbeziehungen und Machtverhältnisse zwischen Bounded Contexts</p></div>
<div class="ulist"><ul><li><p><strong>Separate Ways:</strong> Keine Integration</p></li><li><p><strong>Open Host Service:</strong> Einseitige Bereitstellung von Schnittstellen</p></li><li><p><strong>Conformist:</strong> Übernahme des fremden Modells</p></li><li><p><strong>Anti-Corruption Layer:</strong> Adapter zu fremdem Modell</p></li><li><p><strong>Customer-Supplier:</strong> Gleichberechtigte Aushandlung der Schnittstellen</p></li><li><p><strong>Shared Kernel:</strong> Gemeinsame Verwendung eines Teilmodells</p></li></ul></div></section>
<section id="_domain_driven_design_context_map"><h2>Domain Driven Design: Context Map</h2><div class="paragraph heading"><p>Visualisierung der Beziehungen</p></div>
<div class="imageblock" style=""><img src="images/lesson02/ContextMap.png" alt="ContextMap" height="400"></div></section>
<section id="_domain_driven_design_übung"><h2>Domain Driven Design: Übung</h2><div class="paragraph"><p>Für den großen Parkhausbetreiber „JustParkIt“ soll ein System zur Ausgabe, Nutzung, Abrechnung und Rücknahme von Tickets und Dauerparkausweisen umgesetzt werden.
Im Rahmen der Anforderungserhebung wurden bereits einige User Stories ermittelt.</p></div>
<div class="paragraph"><p><strong>Aufgaben:</strong></p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Gruppieren Sie die User Stories nach fachlichen Domänen und benennen Sie die so entstandenen Bounded Contexts.</p></li><li><p>Identifizieren Sie die jeweils beteiligten Akteure sowie Abhängigkeiten zwischen den Kontexten.</p></li><li><p>Modellieren Sie einen Dauerparkausweis in den einzelnen Kontexten. Wo gibt es Gemeinsamkeiten, wo zeigen sich Unterschiede?</p></li><li><p>Entwickeln Sie eine Context Map und benennen Sie die Beziehungen (&#8594; Patterns) zwischen den Kontexten.</p></li></ol></div></section>
<section id="_domain_driven_design_übung_2"><h2>Domain Driven Design: Übung</h2><div class="ulist"><ul><li><p><strong>US-01</strong>: Als Kunde möchte ich mir an der Schranke ein Ticket ziehen, um ins Parkhaus einfahren zu können.</p></li><li><p><strong>US-02</strong>: Als Kunde möchte ich an der Schranke meinen gültigen Dauerparkausweis nutzen, um ins Parkhaus einfahren zu können.</p></li><li><p><strong>US-03</strong>: Als Parkhausbetreiber möchte ich eine Übersicht aller aktuell gültigen Dauerparkausweise pro Parkhaus online erhalten, um bei Bedarf weitere Ausweise nachbestellen zu können.</p></li><li><p><strong>US-04</strong>: Als Kunde möchte ich mein bezahltes Ticket an der Schranke zurückgeben, um aus dem Parkhaus herausfahren zu können.</p></li><li><p><strong>US-05</strong>: Als Kunde möchte ich an der Schranke meinen Dauerparkausweis nutzen, um aus dem Parkhaus herausfahren zu können.</p></li></ul></div></section>
<section id="_domain_driven_design_übung_3"><h2>Domain Driven Design: Übung</h2><div class="ulist"><ul><li><p><strong>US-06</strong>: Als Parkhausbetreiber möchte ich einen Dauerparkausweis sperren können, um säumigen Zahlern den Zugang zu den Parkhäusern zu verwehren.</p></li><li><p><strong>US-07</strong>: Als Kunde mit Dauerparkausweis möchte ich die im aktuellen Monat angefallenen Kosten online einsehen, um eine Übersicht über meine Ausgaben zu erhalten.</p></li><li><p><strong>US-08</strong>: Als Parkhausbetreiber möchte ich elektronische Zahlungen am Automaten an einen Zahlungsdienstleister weiterleiten, damit sich dieser um die Abwicklung kümmert.</p></li><li><p><strong>US-09</strong>: Als Pförtner möchte ich die Schranke mit einem auf dem Dauerparkausweis aufgedruckten Code öffnen können, falls der Chip auf dem Ausweis selbst nicht mehr lesbar ist.</p></li><li><p><strong>US-10</strong>: Als Kunde möchte ich einen Dauerparkausweis online für ein weiteres Parkhaus des Betreibers freischalten, um dort künftig mein Auto abstellen zu können.</p></li></ul></div></section>
<section id="_aufgabe_2_domain_driven_design"><h2>Aufgabe 2 - Domain Driven Design</h2><div class="ulist"><ul><li><p><strong>US-11</strong>: Als Parkhausbetreiber möchte ich online eine Statistik über die durchschnittliche Parkdauer an einem Standort erhalten, um meine Angebote besser zuschneiden zu können.</p></li><li><p><strong>US-12</strong>: Als Kunde möchte ich ein Ticket am Automaten bar bezahlen können, um anschließend aus dem Parkhaus herausfahren zu können.</p></li><li><p><strong>US-13</strong>: Als Kunde möchte ich ein Ticket am Automaten mit Kreditkarte bezahlen können, um anschließend aus dem Parkhaus herausfahren zu können.</p></li><li><p><strong>US-14</strong>: Als Kunde möchte ich die verschlossene Eingangstür zum Parkhaus mit meinem Ticket oder Dauerparkausweis öffnen können.</p></li><li><p><strong>US-15</strong>: Als Kunde möchte ich meinen Dauerparkausweis monatlich per Kreditkarte bezahlen, um nicht in Verzug zu geraten.</p></li><li><p><strong>US-16</strong>: Als Kunde möchte ich die hinterlegte eMail-Adresse zu meinem Dauerparkausweis ändern, um zeitnah über neue AGB benachrichtigt zu werden.</p></li></ul></div></section>
<section id="_architektur_2"><h2>Architektur</h2><div class="paragraph heading"><p>Mikro-Architektur</p></div>
<div class="ulist"><ul><li><p>Wie sollte ein Service aufgebaut sein?</p></li><li><p>Welche Technologien nutzen wir im Detail?</p></li><li><p>Wie setzen wir Autorisierung um?</p></li></ul></div></section>
<section id="_api_design"><h2>API Design</h2><div class="ulist checklist"><ul class="checklist"><li><p><i class="icon-check"></i>Wie sollen die Schnittstellen aussehen?</p></li></ul></div></section>
<section id="_api_design_einflussfaktoren" class="columns"><h2>API Design: Einflussfaktoren</h2><div class="openblock"><div class="content"><div class="ulist"><ul><li><p><strong>Öffentlich vs. intern</strong></p><div class="ulist"><ul><li><p>Änderbarkeit</p></li><li><p>Technologien</p></li></ul></div></li><li><p><strong>Generisch vs. client-spezifisch</strong></p><div class="ulist"><ul><li><p>Wartungsaufwand</p></li><li><p>Verständlichkeit</p></li><li><p>Information Hiding</p></li></ul></div></li></ul></div></div></div>
<div class="openblock"><div class="content"><div class="ulist"><ul><li><p><strong>Fein- vs. grobgranular</strong></p><div class="ulist"><ul><li><p>Datenmenge</p></li><li><p>Anzahl Calls</p></li><li><p>Kaskadierung</p></li></ul></div></li><li><p><strong>Blocking vs. non-blocking</strong></p><div class="ulist"><ul><li><p>Technologien</p></li><li><p>Prozessablauf</p></li></ul></div></li></ul></div></div></div></section>
<section id="_api_design_prinzipien"><h2>API Design: Prinzipien</h2><div class="ulist"><ul><li><p>Domänenorientierung</p></li><li><p>Lose Kopplung</p></li><li><p>Idempotenz</p></li><li><p>Abwärtskompatibilität oder Versionierung</p></li></ul></div></section>
<section id="_api_design_technologien" class="columns"><h2>API Design: Technologien</h2><div class="openblock"><div class="content"><div class="ulist"><ul><li><p><strong>REST</strong></p><div class="ulist"><ul><li><p>Representational State Transfer</p></li><li><p>Architekturstil</p></li><li><p>Ressourcenorientiert</p></li><li><p>Hypermedia</p></li><li><p>OpenAPI</p></li></ul></div></li></ul></div></div></div>
<div class="openblock"><div class="content"><div class="ulist"><ul><li><p><strong>SOAP</strong></p><div class="ulist"><ul><li><p>Ursprünglich: Simple Object Access Protocol</p></li><li><p>Nachrichtenformat (XML)</p></li><li><p>Dokumenten- und funktionsorientiert</p></li><li><p>WS-* Erweiterungen</p></li><li><p>WSDL</p></li></ul></div></li></ul></div></div></div></section>
<section id="_api_design_technologien_2" class="columns"><h2>API Design: Technologien</h2><div class="openblock"><div class="content"><div class="ulist"><ul><li><p><strong>Binäres RPC</strong></p><div class="ulist"><ul><li><p>Funktionsorientiert</p></li><li><p>Hohe Performance</p></li><li><p>Technologien: gRPC, Apache Thrift</p></li></ul></div></li></ul></div></div></div>
<div class="openblock"><div class="content"><div class="ulist"><ul><li><p><strong>Messaging</strong></p><div class="ulist"><ul><li><p>Austausch von Nachrichten über Broker</p></li><li><p>Lose Kopplung</p></li><li><p>Technologien: Apache ActiveMQ, Apache Kafka</p></li></ul></div></li></ul></div></div></div></section>
<section id="_api_design_microservice_api_patterns"><h2>API Design: Microservice API Patterns</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Our Microservice API Patterns (MAP) distill <strong>proven solutions</strong> to <strong>recurring service interface design and specification problems</strong>
such as finding well-fitting service granularities, promoting independence among services, or managing the evolution of a microservice API.</p></div></blockquote><div class="attribution">&#8212; microservice-api-patterns.org</div></div></section>
<section id="_api_design_microservice_api_patterns_2"><h2>API Design: Microservice API Patterns</h2><div class="ulist"><ul><li><p><a href="https://microservice-api-patterns.org" class="bare">https://microservice-api-patterns.org</a></p></li><li><p>Aktuell in Entwicklung befindlich</p></li><li><p>Fragestellungen</p><div class="ulist"><ul><li><p>Wie viele Schnittstellen sollten als API verfügbar sein?</p></li><li><p>Wie kann eine möglichst lose Kopplung erreicht werden?</p></li><li><p>Welche Daten sollten ausgetauscht werden und wie oft?</p></li><li><p>Wie sollten Nachrichten aussehen?</p></li></ul></div></li></ul></div></section>
<section id="_api_design_microservice_api_patterns_3"><h2>API Design: Microservice API Patterns</h2><div class="imageblock" style=""><img src="images/lesson02/MAP.png" alt="MAP" height="900"></div></section>
<section id="_api_design_api_description_foundation"><h2>API Design: API Description (Foundation)</h2><div class="ulist"><ul><li><p>Kontext</p><div class="ulist"><ul><li><p>Bereitstellung einer neuen API</p></li><li><p>Verwendung nicht allgemein bekannt</p></li></ul></div></li><li><p>Problem</p><div class="ulist"><ul><li><p>Wie kann die Nutzung der API explizit dokumentiert werden?</p></li><li><p>Wie kann die Dokumentation mit anderen Spezifikationen verbunden werden?</p></li></ul></div></li><li><p>Lösung</p><div class="ulist"><ul><li><p>Bereitstellung einer strukturierten API Beschreibung</p></li><li><p>Umsetzung: OpenAPI (REST), JSON API (REST), WSDL (SOAP)</p></li></ul></div></li></ul></div></section>
<section id="_api_design_pagination_structure"><h2>API Design: Pagination (Structure)</h2><div class="ulist"><ul><li><p>Kontext</p><div class="ulist"><ul><li><p>Bei Abruf eines Service werden viele Daten übermittelt</p></li><li><p>Client benötigt nur einen Teil davon</p></li></ul></div></li><li><p>Problem</p><div class="ulist"><ul><li><p>Wie kann der Abruf so eingeschränkt werden, dass der Client nur einen Teil der Daten erhält?</p></li></ul></div></li><li><p>Lösung</p><div class="ulist"><ul><li><p>Auslieferung der Daten in Chunks</p></li><li><p>Übermittlung eines Links zu weiteren Daten</p></li><li><p>Umsetzung: Hypermedia (REST)</p></li></ul></div></li></ul></div></section>
<section id="_api_design_api_key_quality"><h2>API Design: API Key (Quality)</h2><div class="ulist"><ul><li><p>Kontext</p><div class="ulist"><ul><li><p>Service wird per Aufruf bezahlt</p></li><li><p>Verwendung eines Service muss einem Benutzer zugeordnet werden können</p></li><li><p>Einsatz eines Auth Frameworks zu umständlich</p></li></ul></div></li><li><p>Problem</p><div class="ulist"><ul><li><p>Wie kann ein Service Benutzer erkennen?</p></li></ul></div></li><li><p>Lösung</p><div class="ulist"><ul><li><p>Übermittlung eines API Keys (Token) durch den Benutzer</p></li><li><p>Umsetzung: HTTP Header, Cookie, Query Parameter</p></li></ul></div></li></ul></div></section>
<section id="_api_design_version_identifier_evolution"><h2>API Design: Version Identifier (Evolution)</h2><div class="ulist"><ul><li><p>Kontext</p><div class="ulist"><ul><li><p>API erfährt Breaking Changes</p></li><li><p>Alte Clients müssen weiterhin unterstützt werden</p></li></ul></div></li><li><p>Problem</p><div class="ulist"><ul><li><p>Wie können alte und neue API zeitgleich existieren?</p></li></ul></div></li><li><p>Lösung</p><div class="ulist"><ul><li><p>Versionierung der API</p></li><li><p>Umsetzung: URI, Payload</p></li></ul></div></li></ul></div></section>
<section id="_api_design_openapi"><h2>API Design: OpenAPI</h2><div class="ulist"><ul><li><p>Spezifikation zur Beschreibung von REST APIs</p></li><li><p>Vorläufer: Swagger</p></li><li><p>Contract First vs. Code First</p></li><li><p>YAML oder JSON</p></li><li><p>Java Annotations</p></li></ul></div></section>
<section id="_api_design_openapi_2"><h2>API Design: OpenAPI</h2><div class="paragraph heading"><p>YAML</p></div>
<pre class="CodeRay listingblock"><code class="yaml language-yaml">    <span class="key">openapi</span>: <span class="string"><span class="content">3.0.0</span></span>
    <span class="key">info</span>:
      <span class="key">title</span>: <span class="string"><span class="content">Sample Resource</span></span>
      <span class="key">description</span>: <span class="string"><span class="content">Sample API to demonstrate OpenAPI annotations.</span></span>
      <span class="key">version</span>: <span class="string"><span class="content">1.0</span></span>
    <span class="key">servers</span>:
      - <span class="string"><span class="content">url: http://api.anderscore.com.com/v1</span></span>
        <span class="key">description</span>: <span class="string"><span class="content">anderScore public API</span></span>
      - <span class="string"><span class="content">url: http://staging-api.anderscore.com</span></span>
        <span class="key">description</span>: <span class="string"><span class="content">anderScore staging environment</span></span>
    <span class="key">paths</span>:
      <span class="key">/users</span>:
        <span class="key">get</span>:
          <span class="key">summary</span>: <span class="string"><span class="content">Get all users.</span></span>
          <span class="key">description</span>: <span class="string"><span class="content">Get all persisted anderScore users.</span></span>
          <span class="key">responses</span>:
            <span class="key"><span class="delimiter">'</span><span class="content">200</span><span class="delimiter">'</span></span>:    <span class="comment"># status code</span>
              <span class="key">description</span>: <span class="string"><span class="content">A JSON array of user names</span></span>
              <span class="key">content</span>:
                <span class="key">application/json</span>:
                  <span class="key">schema</span>:
                    <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
                    <span class="key">items</span>:
                      <span class="key">type</span>: <span class="string"><span class="content">string</span></span></code></pre></section>
<section id="_api_design_openapi_3"><h2>API Design: OpenAPI</h2><div class="paragraph heading"><p>Annotations</p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@OpenAPIDefinition</span> (info =
    <span class="annotation">@Info</span>(
              title = <span class="string"><span class="delimiter">&quot;</span><span class="content">Sample Resource</span><span class="delimiter">&quot;</span></span>,
              version = <span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>,
              description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Sample API to demonstrate OpenAPI annotations</span><span class="delimiter">&quot;</span></span>,
              license = <span class="annotation">@License</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">Apache 2.0</span><span class="delimiter">&quot;</span></span>, url = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://foo.bar</span><span class="delimiter">&quot;</span></span>),
              contact = <span class="annotation">@Contact</span>(url = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.anderscore.com</span><span class="delimiter">&quot;</span></span>, name = <span class="string"><span class="delimiter">&quot;</span><span class="content">Daniel Krämer</span><span class="delimiter">&quot;</span></span>, email = <span class="string"><span class="delimiter">&quot;</span><span class="content">daniel.kraemer@anderscore.com</span><span class="delimiter">&quot;</span></span>)
      )
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">SampleResource</span> {

    <span class="annotation">@GET</span>
    <span class="annotation">@Operation</span>(summary = <span class="string"><span class="delimiter">&quot;</span><span class="content">Get all users</span><span class="delimiter">&quot;</span></span>, description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Get all persisted anderScore users</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Response getUsers() {
        <span class="comment">// ...</span>
    }
}</code></pre></section>
<section id="_der_weg_zur_makro_architektur"><h2>Der Weg zur Makro-Architektur</h2><div class="olist arabic"><ol class="arabic"><li><p>Fachlicher Schnitt der Microservices nach Domain Driven Design</p><div class="ulist"><ul><li><p>Ermittlung der Bounded Contexts</p></li><li><p>Ableiten der Context Map</p></li></ul></div></li><li><p>Bestimmung der Qualitätsanforderungen und Einflussfaktoren</p></li><li><p>Auswahl geeigneter Technologien</p></li><li><p>Definition der APIs</p><div class="ulist"><ul><li><p>Orientierung an Use Cases und DDD Services</p></li><li><p>Verwendung von Patterns</p></li></ul></div></li><li><p>Dokumentation</p></li></ol></div></section>
<section id="_microservices_im_unternehmenseinsatz_gesamtarchitektur"><h2>Microservices im Unternehmenseinsatz: Gesamtarchitektur</h2><div class="ulist"><ul><li><p>Stack</p><div class="ulist"><ul><li><p>MicroProfile (z.B. Quarkus) Spring Boot</p></li><li><p>REST + OAuth oder Apache Kafka</p></li></ul></div></li><li><p>Resilienz</p><div class="ulist"><ul><li><p>Circuit Breaker</p></li><li><p>Client-side Load Balancing</p></li></ul></div></li><li><p>Paketierung und Deployment</p><div class="ulist"><ul><li><p>Executable jar</p></li><li><p>Docker</p></li><li><p>Kubernetes oder Docker Swarm</p></li></ul></div></li><li><p>Zentrales Monitoring und Logging</p><div class="ulist"><ul><li><p>Prometheus, Grafana, Instana</p></li><li><p>ElasticSearch, LogStash, Kibana</p></li></ul></div></li></ul></div></section>
<section id="_rahmenbedingungen_für_quarkus_the_twelve_factor_app"><h2>Rahmenbedingungen für Quarkus: The Twelve-Factor App</h2><div class="olist arabic"><ol class="arabic"><li><p><strong>Codebase</strong>: Eine im Versionsmanagementsystem verwaltete Codebase, viele Deployments</p></li><li><p><strong>Dependencies</strong>: Abhängigkeiten explizit deklarieren und isolieren</p></li><li><p><strong>Config</strong>: Die Konfiguration in Umgebungsvariablen ablegen</p></li><li><p><strong>Backing services</strong>:  Unterstützende Dienste als angehängte Ressourcen behandeln</p></li><li><p><strong>Build, release, run</strong>: Build- und Run-Phase strikt trennen</p></li><li><p><strong>Processes</strong>: Die App als einen oder mehrere Prozesse ausführen</p></li><li><p><strong>Port binding</strong>: Dienste durch das Binden von Ports exportieren</p></li><li><p><strong>Concurrency</strong>:  Mit dem Prozess-Modell skalieren</p></li><li><p><strong>Disposability</strong>: Robuster mit schnellem Start und problemlosen Stopp</p></li><li><p><strong>Dev/prod parity</strong>:  Entwicklung, Staging und Produktion so ähnlich wie möglich halten</p></li><li><p><strong>Logs</strong>:  Logs als Strom von Ereignissen behandeln</p></li><li><p><strong>Admin processes</strong>: Admin/Management-Aufgaben als einmalige Vorgänge behandeln</p></li></ol></div>
<div class="paragraph"><p>Siehe auch: <a href="https://12factor.net" class="bare">https://12factor.net</a></p></div></section>
<section id="_zusammenfassung_microservices"><h2>Zusammenfassung Microservices</h2><div class="ulist"><ul><li><p>Form der Modularisierung</p></li><li><p>Herausforderungen eines verteilten Systems!</p></li><li><p>Schnitt mittels Domain Driven Design</p></li><li><p>Abgrenzung mittels Bounded Contexts und Context Map</p></li><li><p>Vielseitige Integrationsmöglichkeiten</p></li><li><p>Microservice API Patterns</p></li><li><p>Cloud: Twelve-Factor Apps</p></li></ul></div>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section>
<section id="_cdi" data-state="no-title-footer"><h2>CDI</h2><div class="paragraph center"><p>Was hat es damit auf sich?</p></div></section>
<section><section id="_dependency_injection"><h2>Dependency Injection</h2><div class="paragraph heading"><p>Herausforderung</p></div><div class="imageblock" style="text-align: center"><img src="images/di-context.svg" alt="di context" width="1200" height="600"></div></section><section id="_dependency_injection_di"><h2>Dependency Injection (DI)</h2><div class="imageblock" style="text-align: center"><img src="images/di.svg" alt="di" width="600" height="200"></div></section><section id="_inversion_of_control"><h2>Inversion of Control</h2><div class="imageblock" style="text-align: center"><img src="images/ioc.svg" alt="ioc" width="1200" height="600"></div></section></section>
<section><section id="_hypothetisches_anwendungsbeispiel"><h2>Hypothetisches Anwendungsbeispiel</h2><div class="paragraph"><p>Wiederverwendbare Bibliothek zum Speichern von
benutzerspezifischen Voreinstellungen:</p></div><div class="title">PreferencesService.java</div><pre class="CodeRay listingblock"><code class="java language-java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">PreferencesService</span> {
    <span class="type">void</span> savePreference(<span class="predefined-type">String</span> key, <span class="predefined-type">String</span> value);
    <span class="predefined-type">String</span> loadPreference(<span class="predefined-type">String</span> key);
}</code></pre></section><section id="_präzisierung_der_anforderungen"><h2>Präzisierung der Anforderungen</h2><div class="ulist"><ul><li><p>Anwendungen müssen eine Referenz auf den PreferencesService bekommen</p></li><li><p>PreferencesService benötigt ID des aktuellen Users</p></li><li><p>Persistenzschicht muss zum Anwendungskontext passen</p></li></ul></div></section><section id="_entwurf"><h2>Entwurf</h2><div class="imageblock" style="text-align: center"><img src="images/draft.svg" alt="draft" width="1600" height="350"></div>
<div class="olist arabic"><div class="title">Problemstellungen:</div><ol class="arabic"><li><p>Wie kommt die Anwendung an den PreferencesService?</p></li><li><p>Wie kommt der PreferencesService an UserProvider und PreferencesRepository?</p></li></ol></div></section><section id="_lösung_dependency_injection"><h2>Lösung: Dependency Injection</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="directive">private</span> FxUserProvider userProvider;
<span class="directive">private</span> JdbcPreferencesRepository preferencesRepository;
<span class="directive">private</span> PreferencesServiceImpl preferencesService;

<span class="directive">private</span> <span class="type">void</span> plumb() {
    userProvider = <span class="keyword">new</span> FxUserProvider();
    preferencesRepository = <span class="keyword">new</span> JdbcPreferencesRepository();
    preferencesService = <span class="keyword">new</span> PreferencesServiceImpl();
    preferencesService.setUserProvider(userProvider);
    preferencesService.setPreferencesRepository(preferencesRepository);
}</code></pre></section><section id="_cdi_2"><h2>CDI</h2><div class="ulist"><ul><li><p>Contexts and Dependency Injection</p></li><li><p>Seit 2009 Teil von JEE</p></li><li><p>Dependency Injection über Annotationen</p></li><li><p>Decorators, Interceptors</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyService</span> {

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> UsedService usedService;
}</code></pre></section><section id="_scopes"><h2>Scopes</h2><div class="ulist"><ul><li><p>@ApplicationScoped</p></li><li><p>@SessionScoped</p></li><li><p>@ConversationScoped</p></li><li><p>@RequestScoped</p></li></ul></div></section></section>
<section id="_dependency_injection_2"><h2>Dependency Injection</h2><div class="paragraph heading"><p>Fragen?</p></div>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section>
<section id="_jpa_und_quarkus" data-state="no-title-footer"><h2>JPA und Quarkus</h2><div class="paragraph center"><p>Wie funktioniert das?</p></div></section>
<section id="_java_persistence_api_jpa_in_stichworten"><h2>Java Persistence API (JPA) in Stichworten</h2><div class="ulist"><ul><li><p>Anbindung relationaler Datenbanken (OR-Mapping)</p></li><li><p>Maßgeblicher Einfluss: <strong>Hibernate</strong></p></li><li><p>Als <a href="https://jcp.org/en/jsr/detail?id=220">&#8594; JSR 220</a> im Jahr 2006 erstmalis veröffentlicht</p></li><li><p>Aktuelle Version 2.2 (<a href="https://jcp.org/en/jsr/detail?id=338">&#8594; JSR 338</a>) ist 2017 mit <strong>Java EE 8</strong>
offiziell erschienen</p></li><li><p>Inzwischen unter der Obhut der Eclipse Foundation:
<a href="https://projects.eclipse.org/proposals/eclipse-project-jpa">
    &#8594; Eclipse Project for JPA</a></p></li><li><p>Heute: "Jakarta Persistence"</p></li></ul></div></section>
<section id="_java_persistence_api_jpa_in_stichworten_2"><h2>Java Persistence API (JPA) in Stichworten</h2><div class="ulist"><ul><li><p>Persistence Provider: Hibernate, EclipseLink, TopLink, OpenJPA</p></li><li><p>Referenzimplementierung: EclipseLink (früher: Hibernate)</p></li><li><p>Datenbankunabhängig</p></li><li><p>Mapping-Metadaten über Java-Annotationen (oder XML)</p></li><li><p>Abfragen über Java Persistence Query Language (JPQL) oder Criteria API</p></li></ul></div></section>
<section id="_wichtige_jpa_annotationen"><h2>Wichtige JPA Annotationen</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">@Entity</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Markiert Klasse als JPA-Entity</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">@Table(name="CUST")</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Ordnet Datenbanktabelle zu</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">@Column(name="CUST_ID")</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Ordnet Spaltenname zu</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">@Id</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Markiert Spalte als Primärschlüssel</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">@GeneratedValue</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Generiert IDs</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">@Enumerated(EnumType.STRING)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Enum-Namen als String speichern</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">@OneToOne, @OneToMany, @ManyToOne, @ManyToMany</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Beziehungen</p></td></tr></table>
<div class="paragraph"><p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/package-summary.html">
&#8594; Java EE 8 API: javax.persistence</a></p></div></section>
<section id="_deklaration_einer_entity"><h2>Deklaration einer Entity</h2><div class="paragraph heading"><p>Besipiel: TaskEntity.java</p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Entity</span> <span class="comment">// Objekt in eigener Datenbanktabelle speichern</span>
<span class="annotation">@Table</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">TASK</span><span class="delimiter">&quot;</span></span>) <span class="comment">// Tabellename</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TaskEntity</span> {
    <span class="directive">public</span> <span class="type">enum</span> State {
        OPEN, STARTED, DONE
    }

    <span class="annotation">@Id</span> <span class="comment">// Primärschlüssel</span>
    <span class="annotation">@GeneratedValue</span> <span class="comment">// wird automatisch generiert</span>
    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">TASK_ID</span><span class="delimiter">&quot;</span></span>) <span class="comment">// expliziter Spaltenname</span>
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;

    <span class="directive">private</span> <span class="predefined-type">String</span> description;

    <span class="directive">private</span> Instant dateDue;

    <span class="annotation">@Enumerated</span>(EnumType.STRING) <span class="comment">// als String speichern</span>
    <span class="directive">private</span> State state;

    <span class="comment">// Getter, Setter, etc.</span>
}</code></pre></section>
<section><section id="_datenbankzugriff_mit_plain_jpa"><h2>Datenbankzugriff mit Plain-JPA</h2><div class="paragraph heading"><p>JPA Begriffe</p></div><div class="dlist"><dl><dt class="hdlist1">Persistence Context</dt><dd><div class="ulist"><ul><li><p>Menge persistenter (eindeutiger) Entity-Objekte (in Memory)</p></li><li><p>Managed Lebenszyklus der Entities</p></li><li><p>Ist mit einer Transaktion verknüpft</p></li></ul></div></dd><dt class="hdlist1"><code>EntityManager</code> Interface</dt><dd><div class="ulist"><ul><li><p>Schnittstelle zur Interaktion mit <em>Persistence Context</em> (CRUD)</p></li><li><p>"Generisches DAO"</p></li></ul></div></dd><dt class="hdlist1">Persistence Unit</dt><dd><div class="ulist"><ul><li><p>Menge der Entities, die vom EntityManager verwaltet werden können</p></li><li><p>Wird durch <code>EntityManagerFactory</code> repräsentiert</p></li></ul></div></dd><dt class="hdlist1">Detached Entites</dt><dd><p>Entity-Objekt, das nicht mit einem <em>Persistence Context</em> verbunden ist (nach Commit)</p></dd></dl></div></section><section id="_wie_kommt_man_an_den_entitymanager_ran"><h2>Wie kommt man an den EntityManager ran?</h2><h level="3">Java EE Umgebung (Container-managed Entity Manager)</h><pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@PersistenceUnit</span>
EntityManagerFactory emf;

<span class="annotation">@PersistenceContext</span>
ContextEntityManager em;</code></pre>
<h level="3">Quarkus</h><pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Inject</span>
EntityManager em;</code></pre>
<div class="paragraph"><p><a href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/package-summary.html">
&#8594; javax.persistence Javadocs</a></p></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/hibernate-orm">
&#8594; Guide: Quarkus - Using Hibernate ORM and JPA</a></p></div></section></section>
<section id="_entity_manager_in_quarkus_13_dependencies"><h2>Entity-Manager in Quarkus 1/3: Dependencies</h2><div class="paragraph"><p>pom.xml</p></div>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>quarkus-hibernate-orm<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>

<span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>quarkus-jdbc-h2<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>

<span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>quarkus-agroal<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre></section>
<section id="_entity_manager_in_quarkus_23_properties"><h2>Entity-Manager in Quarkus 2/3: Properties</h2><div class="paragraph"><p>application.properties</p></div>
<pre class="CodeRay listingblock"><code class="properties language-properties"># Configuration file
# key = value
# datasource configuration
quarkus.datasource.db-kind=h2
quarkus.datasource.username=schulung
quarkus.datasource.password=schulung
quarkus.datasource.jdbc.url=jdbc:h2:mem:myDB

# drop and create the database at startup (use `update` to only update the schema)
quarkus.hibernate-orm.database.generation=drop-and-create

# Log SQL - not to be used in production
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.log.bind-param=true

# Optional: Pre-populate database
# quarkus.hibernate-orm.sqlo-load-script=import.sql</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/datasource#h2">
&#8594; Guide: Quarkus - Datasources</a></p></div></section>
<section id="_entity_manager_in_quarkus_33_repository"><h2>Entity-Manager in Quarkus 3/3: Repository</h2><div class="paragraph heading"><p>Plain JPA (klassisch)</p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">OrderRepository</span> {
    <span class="predefined-type">Logger</span> logger = LoggerFactory.getLogger(OrderRepository.class);

    <span class="annotation">@Inject</span>
    EntityManager em;

    <span class="comment">// Aktualisieren oder anlegen - wichtig: Transactional</span>
    <span class="annotation">@Transactional</span>
    <span class="directive">public</span> <span class="type">void</span> save(Order o){
        logger.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">Order: </span><span class="delimiter">&quot;</span></span>+ o.toString());
        em.merge(o);
    }
    <span class="comment">// ...</span>
}</code></pre></section>
<section id="_aufgabe_3_3_lesson03_jpa"><h2>Aufgabe 3.3: lesson03-jpa</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong>:</p></div>
<div class="ulist"><ul><li><p>Persistieren die Pizza-Bestellungen in einer H2 in-memory Datenbank</p><div class="ulist"><ul><li><p>Nutzen Sie JPA-Annotationen</p></li><li><p>Injizieren und verwenden Sie einen Entity-Manager im Repository</p></li><li><p>Testen Sie mit Postman</p></li></ul></div></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong>:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p><code>ORDER</code> ist ein ungeschickter Name für eine Tabelle.</p></li><li><p>IDs in H2 erzeugen: <code>@GeneratedValue(strategy = GenerationType.IDENTITY)</code></p></li><li><p>Lazy-Loading über hibernate-Proxies ist nur innerhalb der Session möglich.
<code>@OneToMany(cascade=CascadeType.ALL, fetch=FetchType.EAGER)</code></p></li><li><p>Im Ordner <code>lesson03_3-jpa/lesson03</code> befindet sich bereits ein Skelett. Es entspricht der Beispiellösung aus Aufgabe 3.2.</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson03/lesson03_3-jpa</code></p></li></ol></div></section>
<section id="_hibernate_panache"><h2>Hibernate Panache</h2><div class="ulist"><ul><li><p>Plain-JPA: Repository händisch implementieren</p></li><li><p>Idee: Framework generiert Operationen</p><div class="ulist"><ul><li><p>Ruby On Rails Active Record / Grails ORM: Active Record Pattern</p></li><li><p>Spring Data: Repository Interface vom Framework verwaltet: Repository Pattern</p></li><li><p>Quarkus + Hibernate Panache: Repository oder Active Record Pattern</p></li></ul></div></li><li><p>Zusätzliche Features</p><div class="ulist"><ul><li><p>Vereinfachung der Abfrage-Sprache</p></li><li><p>Paging</p></li><li><p>Konventionen &amp; diverse Hilfsmethoden</p></li></ul></div></li></ul></div>
<div class="paragraph"><p><a href="https://www.martinfowler.com/eaaCatalog/activeRecord.html">
&#8594; Martin Fowler: Active Record</a></p></div>
<div class="paragraph"><p><a href="https://martinfowler.com/eaaCatalog/repository.html">
&#8594; Martin Fowler: Repository</a></p></div></section>
<section id="_verwendung_von_hibernate_panache"><h2>Verwendung von Hibernate Panache</h2><div class="paragraph heading"><p>Umstellung Plain-JPA auf Panache Repository</p></div>
<div class="paragraph"><p>Dependency einbinden</p></div>
<pre class="CodeRay listingblock"><code class="xml language-xml">    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>quarkus-hibernate-orm-panache<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>2.12.0.Final<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span></code></pre>
<div class="paragraph"><p>Repository umstellen</p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PersonRepository</span> <span class="directive">implements</span> PanacheRepository&lt;Person&gt; {
    <span class="comment">// Hinweis: Generierte Methoden sind nicht @Transactional</span>

    <span class="comment">// Beispiel: Hilfsmethode</span>
    <span class="directive">public</span> Person findByName(<span class="predefined-type">String</span> name){
       <span class="keyword">return</span> find(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, name).firstResult();
    }

}</code></pre>
<div class="paragraph"><p><a href="https://javadoc.io/doc/io.quarkus/quarkus-hibernate-orm-panache/latest/io/quarkus/hibernate/orm/panache/PanacheRepository.html">
&#8594; API Doc: io.quarkus.hibernate.orm.panache.PanacheRepository&lt;Entity&gt;
</a></p></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/hibernate-orm-panache">
&#8594; Guide: Quarkus - Simplified Hibernate ORM with Panache</a></p></div></section>
<section id="_verwendung_von_hibernate_panache_2"><h2>Verwendung von Hibernate Panache</h2><div class="paragraph heading"><p>Alternative: Active Record Pattern</p></div>
<div class="paragraph"><p>Definition</p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Entity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Person</span> <span class="directive">extends</span> PanacheEntity {
    <span class="comment">// Auto-generated ID field</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> name;
    <span class="directive">public</span> LocalDate birth;
    <span class="directive">public</span> Status status;
}</code></pre>
<div class="paragraph"><p>Verwendung</p></div>
<pre class="CodeRay listingblock"><code class="java language-java">Person person = <span class="keyword">new</span> Person();
person.name = <span class="string"><span class="delimiter">&quot;</span><span class="content">Stef</span><span class="delimiter">&quot;</span></span>;

person.persist();</code></pre>
<div class="paragraph"><p><a href="https://javadoc.io/doc/io.quarkus/quarkus-hibernate-orm-panache/latest/io/quarkus/hibernate/orm/panache/PanacheEntity.html">
&#8594; API Doc: io.quarkus.hibernate.orm.panache.PanacheEntity
</a></p></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/hibernate-orm-panache">
&#8594; Guide: Quarkus - Simplified Hibernate ORM with Panache</a></p></div></section>
<section><section id="_aufgabe_3_4_lesson03_panache"><h2>Aufgabe 3.4: lesson03-panache</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong>:</p></div><div class="ulist"><ul><li><p>Persistieren die Pizza-Bestellungen in einer H2 in-memory Datenbank und einem <strong>Panache-Repository</strong></p><div class="ulist"><ul><li><p>Bauen Sie auf der vorherigen Aufgabe auf</p></li><li><p>Testen Sie die Methoden mit Postman</p></li></ul></div></li></ul></div><div class="paragraph"><p><strong>Hinweise</strong>:</p></div><div class="olist arabic"><ol class="arabic"><li><p>Im Ordner <code>lesson03_4-panache/lesson03</code> befindet sich bereits ein Skelett. Es entspricht der Beispiellösung aus Aufgabe 3.3.</p></li><li><p>Achten sie auf die Annotation <code>@Transactional</code></p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson03_4-panache</code></p></li><li><p>Alternativ können Sie das Active Record Pattern verwenden</p></li></ol></div><div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a>
== REST Grundlagen</p></div><div class="ulist"><ul><li><p>Steht für <strong>Representational State Transfer</strong></p></li><li><p>Begriff: Doktorarbeit von Roy Fielding aus dem Jahr 2000</p></li><li><p>Technologie für Maschine zu Maschine Kommunikation</p></li><li><p>Fußt auf den Prinzipien des Web (Web für Maschinen)</p></li><li><p>Eine REST-API muss 5 Bedingungen erfüllen</p></li></ul></div></section><section id="_1_client_server"><h2>1. Client-Server</h2><div class="ulist"><ul><li><p>Strikte Trennung der Systeme</p></li><li><p>Verbindung kann unterbrochen sein</p></li></ul></div></section><section id="_2_zustandslos"><h2>2. Zustandslos</h2><div class="ulist"><ul><li><p>Keine Sitzungsinformation auf dem Server<br>
(Andernfalls nur REST-artig)</p></li><li><p>Zustand (Sitzung) wird auf Client vorgehalten</p></li><li><p>Nachrichten sind selbstbeschreibend</p></li><li><p>Jede Anfrage muss alle notwendigen Informationen enthalten,
damit der Server diese verarbeiten kann (inkl. Sitzungsinformationen)</p></li><li><p>Jede Antwort muss alle Informationen enthalten, die der Client
benötigt, um die Sitzung zu aktualisieren</p></li></ul></div></section><section id="_3_cachbar"><h2>3. Cachbar</h2><div class="ulist"><ul><li><p>Antworten müssen Informationen enthalten,
ob und wie lange gecached werden kann</p></li><li><p>Client kann nicht davon Ausgehen, dass Antwort direkt vom Server kommt</p></li></ul></div></section><section id="_4_schichtenarchitektur"><h2>4. Schichtenarchitektur</h2><div class="ulist"><ul><li><p>Zwischen Client und Server kann diverse Middleware liegen</p></li><li><p>&#8658; Erhöht Skalierbarkeit und Ausfallsicherheit</p></li></ul></div></section><section id="_5_einheitliche_schnittstelle"><h2>5. Einheitliche Schnittstelle</h2><div class="ulist"><ul><li><p>Einhaltung der HTTP-Spezifikation</p></li><li><p>Ein Vertrag für alle Belange</p></li></ul></div>
<div class="paragraph"><p><br></p></div>
<div class="paragraph"><p>Richtlinien der einheitlichen Schnittstelle:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Ressourcen basiert (URIs zur Identifizierung, repräsentationsunabhängig)</p></li><li><p>Bearbeitung der Ressourcen über deren Repräsentation</p></li><li><p>Selbstbeschreibende Nachrichten (jede Nachricht enthält explizt alles, was zu
deren Verarbeitung notwendig ist, z. B. Typ, Cachbarkeit)</p></li><li><p><em>Hypermedia as the Engine of Application State</em> (HATEOS)</p></li></ol></div></section><section id="_hateoas"><h2>HATEOAS</h2><div class="ulist"><ul><li><p>Client-Request enthält alle notwendigen Zustandsinformationen, die der Server benötigt,
um den Request zu bearbeiten. Der Server weiß (speichert) nichts zu dem Client.</p></li><li><p>Der Server muss in seiner Antwort jeglichen Zustand an den Client übertragen, der
für den nächsten Schritt notwendig ist.</p></li><li><p>Der Client übertägt die Zustandsinformation in Form von URLs, Request-Parametern,
Request-Headern und dem Request-Inhalt (Body). Der Server überträgt Zustand mittels
dem Inhalt der Antwort (Body), den Headern und dem Response-Code.</p></li><li><p>Daneben versteht man unter HATEOAS auch, dass Antworten im Inhalt oder im Header (<em>Location</em>, <em>Link</em>)
die Links zu den zurückgegeben Objekten und ggf. zu weiterführenden Objekten enthalten.</p></li></ul></div></section><section id="_6_ausführbarer_code_auf_anforderung_optional"><h2>6. Ausführbarer Code auf Anforderung (optional)</h2><div class="paragraph"><p>Server kann Funktionalität auf den Client übertragen (z. B. JavaScript-Code)</p></div></section><section id="_resourcen_basiert"><h2>Resourcen basiert</h2><div class="ulist"><ul><li><p>Resourcen (Dinge) werden über URIs identifiziert<br>
(es kann mehrere URIs geben, die auf die gleiche Ressource zeigen)</p></li><li><p>Resourcen sind unabhängig von deren Repräsenation (verschiedene Repräsenationen möglich)</p></li><li><p>Aktionen werden über HTTP-Verben (GET, POST, PUT, DELETE) angegeben</p></li><li><p>Repräsenationen (JSON, XML, HTML, PDF, etc.) werden über den Content-Type (MIME) angegeben</p></li><li><p>&#8658; URLs werden zum Adressieren von Ressourcen verwendet</p></li></ul></div>
<div class="paragraph"><p><br></p></div>
<table class="tableblock frame-all grid-all" style="width:50%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">REST URLs</th><th class="tableblock halign-left valign-top">SOAP-RPC URLs</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Dinge</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Aktionen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Substantive</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Verben</p></td></tr></table></section><section id="_repräsentationen"><h2>Repräsentationen</h2><div class="ulist"><ul><li><p>Die Repräsentationen sind das, was tatsächlich zwischen Client und Server übertragen wird</p></li><li><p>Sie geben den Ressourcen Zustand (oder einen Teil davon) wieder</p></li><li><p>Umfassen neben Nutzdaten auch Metadaten (Typinformationen)</p></li><li><p>Typischerweise JSON oder XML, kann aber beliebiges Format sein (z. B. PDF, HTML, &#8230;&#8203;)</p></li></ul></div></section><section id="_vorteile"><h2>Vorteile</h2><div class="ulist"><ul><li><p>Skalierbarkeit</p></li><li><p>Einfachheit</p></li><li><p>Wartbarkeit</p></li><li><p>Sichtbarkeit</p></li><li><p>Portierbarkeit</p></li><li><p>Zuverlässigkeit</p></li></ul></div>
<div class="paragraph"><p><a href="https://www.restapitutorial.com/lessons/whatisrest.html">
&#8594; www.restapitutorial.com: What is REST?</a></p></div></section><section id="_http_verben"><h2>HTTP Verben</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:14.2857%"><col style="width:28.5714%"><col style="width:57.1429%"></colgroup><tbody><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">GET</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">idempotent und sicher</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Eine (Menge von) Ressource(n) über ihre URI abrufen</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">POST</p></th><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erstellt eine Ressource</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">PUT</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">idempotent</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Eine (Menge von) Ressource(n) anhand ihrer URI ändern (vollständig ersetzen)</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">PATCH</p></th><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class="tableblock">Eine Ressource ändern (nur einzelne Attribute)</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">DELETE</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">idempotent</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Entfernt eine Ressource anhand ihrer URI</p></td></tr></table>
<div class="paragraph"><p><a href="https://www.restapitutorial.com/lessons/httpmethods.html">
&#8594; HTTP-Methods für REST</a><br>
<a href="https://www.tutorialspoint.com/http/http_methods.htm">
&#8594; HTTP-Methods allgemein</a></p></div>
<aside class="notes"><div class="ulist"><ul><li><p><strong>Sicher</strong> heißt: Die Operation ändert nichts.</p></li><li><p><strong>GET</strong> Parameter können für Filter verwendet werden.</p></li><li><p><strong>PUT</strong> kann auch zum Anlegen verwendet werden, wenn der Identifier (die URI) bereits vorher bekannt ist.
Die URI muss die zu ändernde(n) Resource(n) eindeutig identifizieren (nicht der Nachrichteninhalt).</p></li><li><p><strong>POST</strong> kann für alle anderen Operationen verwendet werden, die zu keiner der genannten Kategorieen passt.</p></li><li><p><strong>DELETE</strong> ist zwar idempotnent, kann aber dennoch verschiedene Resposes liefern: 204 (wurde gelöscht)
und 404 (nicht mehr vorhanden)</p></li></ul></div></aside></section><section id="_richtlinien_für_rest_uris"><h2>Richtlinien für REST-URIs</h2><div class="ulist"><ul><li><p>IDs sind immer Bestandteil der URL (Parameter nur zum Filtern)</p></li><li><p>Nur Substantive (Verben sind ein <em>Bad Smell</em>)</p></li><li><p>Plural</p></li><li><p>Nur Kleinbuchstaben und '-' zur Trennung</p></li><li><p><em>/users</em> für eine Menge und <em>/users/123</em> für einzelne Ressource</p></li></ul></div>
<div class="paragraph"><p>Beispiel: <code>account/payment</code> statt <code>account/pay</code></p></div></section><section id="_wichtigste_http_antwortcodes"><h2>Wichtigste HTTP Antwortcodes</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:33.3333%"><col style="width:66.6667%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">200 OK</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erfolg (normale Antwort)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">201 CREATED</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erfolgreich erstellt (Antwort auf POST)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">204 NO CONTENT</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erfolg, aber kein Inhalt (Antwort auf DELETE)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">400 BAD REQUEST</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Anfrage kann nicht verarbeitet werden (Validierungsfehler)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">401 UNAUTHORIZED</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Notwendige Authentifizerung fehlt (z.B. kein Token vorhanden)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">403 FORBIDDEN</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Berechtigung nicht ausreichend</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">404 NOT FOUND</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Ressource existiert nicht</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">405 METHOD NOT ALLOWED</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">HTTP-Methode für die entsprechende URI nicht anwendbar</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">409 CONFLICT</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Bearbeitung der Anfrage würde zu Inkonsistenzen führen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">410 GONE</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Die Ressource wurde gelöscht (wenn das bekannt ist, sonst 404)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">415 UNSUPPORTED MEDIA TYPE</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Format der übertragenen Daten nicht untersützt</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">500 INTERNAL SERVER ERROR</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Unerwarteter Fehler auf Server</p></td></tr></table>
<div class="paragraph"><p><a href="https://www.restapitutorial.com/lessons/httpstatuscodes.html">
&#8594; HTTP Status Codes</a><br></p></div>
<aside class="notes"><div class="dlist"><dl><dt class="hdlist1">405 METHOD NOT ALLOWED</dt><dd><p>Beispielsweise bei einem POST auf <em>/users/123</em> statt auf <em>/users</em>. Die Antwort muss einen <em>Allow</em> Header mit den
unterstützten Methoden enthalten, z. B. <code>Allow: GET, PUT</code></p></dd><dt class="hdlist1">409 CONFLICT</dt><dd><p>Beispielsweise doppelte Einträge</p></dd></dl></div></aside></section><section id="_fragen"><h2>Fragen?</h2><div class="ulist"><div class="title">Auch interessant:</div><ul><li><p>JSON-API</p></li></ul></div></section></section>
<section id="_rest_mit_jsr_370_jax_rs_2_1"><h2>REST mit JSR 370 / JAX-RS 2.1</h2><div class="paragraph heading"><p>JSR 370: Java API for RESTful Web Services (JAX-RS 2.1)</p></div>
<div class="ulist"><ul><li><p>Vormals JSR-339, JSR-311</p></li><li><p>Paket <code>java.ws.rs</code></p></li><li><p>Implementierungen:</p><div class="ulist"><ul><li><p>Project Jersey (<a href="http://jersey.java.net" class="bare">http://jersey.java.net</a>), <em>Referenz</em></p></li><li><p>RESTEasy (<a href="https://resteasy.github.io/" class="bare">https://resteasy.github.io/</a>), <em>In Quarkus verwendet</em></p></li></ul></div></li><li><p>Pfade, HTTP-Verben, etc. als Annotationen</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/echo</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">EchoResource</span> {
    <span class="comment">// ...</span>
    <span class="annotation">@GET</span> <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{spell}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
    <span class="directive">public</span> <span class="predefined-type">String</span> echo(<span class="annotation">@PathParam</span> <span class="predefined-type">String</span> spell) {
        <span class="keyword">return</span> service.echo(spell);
    }
}</code></pre></section>
<section id="_rest_apis_testen_http_client"><h2>REST-APIs testen: HTTP-Client</h2><div class="paragraph heading"><p><strong>curl</strong> (über <strong>Git Bash</strong> aufrufbar)</p></div>
<div class="paragraph"><p>Liste aller Tasks:</p></div>
<div class="literalblock"><div class="content"><pre>curl http://localhost:8080/tasks</pre></div></div>
<div class="paragraph"><p>Einen Task hinzufügen:</p></div>
<div class="literalblock"><div class="content"><pre>curl -d '{"description": "curl lernen", "state":"STARTED", "dateDue":"2019-05-25T10:15:00Z"}' \
     -H "Content-Type: application/json" -X POST http://localhost:8080/tasks</pre></div></div>
<div class="paragraph"><p>Task löschen (mit <code>-v</code> werden u. a. Status-Code und Header ausgegeben):</p></div>
<div class="literalblock"><div class="content"><pre>curl -v -X DELETE http://localhost:8080/tasks/2</pre></div></div>
<div class="paragraph heading"><p>Alternativen:</p></div>
<div class="ulist"><ul><li><p><a href="https://www.getpostman.com/">&#8594; Postman</a></p></li><li><p><a href="https://addons.mozilla.org/de/firefox/addon/restclient/">&#8594; RESTClient (Browser-Plugin)</a></p></li></ul></div></section>
<section id="_aufgabe_3_1_lesson03_rest"><h2>Aufgabe 3.1: lesson03-rest</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong>:</p></div>
<div class="ulist"><ul><li><p>Implementieren Sie eine REST-API für die Verwaltung von Pizza-Bestellungen.</p></li><li><p>Die Resource soll Create-, Read-, Update- und Delete-Operationen erlauben.</p></li><li><p>Zusätzlich sollen alle Bestellungen als Liste abrufbar sein (index).</p></li><li><p>Testen Sie die API mit postman</p></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong>:</p></div>
<div class="ulist"><ul><li><p>Im Ordner <code>lesson03_1-rest/lesson03</code> befindet sich bereits ein Skelett samt Repository und Model</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson03/lesson03_1-rest</code></p></li><li><p>Es sollen erstmal nur die Positivfälle behandelt und noch kein HTTP Status Code zurück gegeben werden</p></li><li><p><a href="https://quarkus.io/guides/rest-json">&#8594; Quarkus Guide</a></p></li></ul></div></section>
<section id="_rest_apis_response_builder"><h2>REST-APIs: Response Builder</h2><div class="paragraph heading"><p>HTTP-Semantik</p></div>
<div class="ulist"><ul><li><p>Bisher: Direkte Rückgabe (JSON-Encoding)</p></li><li><p>Alternativ: Response-Builder (z.B. HTTP-Status-Codes)</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="java language-java">    <span class="annotation">@POST</span>
    <span class="directive">public</span> Response create(Customer customer) {
        customerRepository.createCustomer(customer);
        <span class="keyword">return</span> Response.status(<span class="integer">201</span>).build();
    }</code></pre>
<div class="paragraph"><p>Vgl. <a href="https://javaee.github.io/javaee-spec/javadocs/javax/ws/rs/core/Response.html" class="bare">https://javaee.github.io/javaee-spec/javadocs/javax/ws/rs/core/Response.html</a></p></div></section>
<section id="_rest_apis_exception_handling_explizit"><h2>REST-APIs: Exception Handling: Explizit</h2><pre class="CodeRay listingblock"><code class="java language-java">    <span class="annotation">@RequestScoped</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">users</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">class</span> <span class="class">UsersResource</span> {

        <span class="annotation">@Inject</span>
        UserRepository userRepository;

        <span class="annotation">@POST</span>
        <span class="directive">public</span> Response registerUser(User userRequest) {
            <span class="keyword">try</span> {
                User managedUser = userRepository.register(userRequest);
                <span class="keyword">return</span> Response.created(managedUser).build();
            } <span class="keyword">catch</span> (<span class="exception">Exception</span> ex) {
               <span class="keyword">return</span> Response.status(<span class="integer">405</span>).build();
            }

        }
    }</code></pre>
<div class="paragraph"><p><a href="https://jaxenter.de/wie-man-ein-zentralisiertes-rest-api-exception-handling-mit-beanvalidation-kombiniert-24427" class="bare">https://jaxenter.de/wie-man-ein-zentralisiertes-rest-api-exception-handling-mit-beanvalidation-kombiniert-24427</a></p></div></section>
<section id="_rest_apis_exception_handling_zentralisiert_aspekt"><h2>REST-APIs: Exception Handling: Zentralisiert (Aspekt)</h2><div class="paragraph"><p>Around Advice</p></div>
<pre class="CodeRay listingblock"><code class="java language-java">    <span class="directive">public</span> <span class="type">class</span> <span class="class">APIExceptionInterceptor</span> {
        <span class="annotation">@AroundInvoke</span>
        <span class="directive">public</span> <span class="predefined-type">Object</span> handleException(InvocationContext context) { <span class="predefined-type">Object</span> proceedResponse;
            <span class="keyword">try</span> {
                proceedResponse = context.proceed();
            } <span class="keyword">catch</span> (<span class="exception">Exception</span> ex) {
                <span class="keyword">return</span> Response.serverError().entity(ex.getMessage()).build();
            }
            <span class="keyword">return</span> proceedResponse;
        }
    }</code></pre>
<div class="paragraph"><p>Einbindung</p></div>
<pre class="CodeRay listingblock"><code class="java language-java">    <span class="annotation">@RequestScoped</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">users</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Interceptor</span>(APIExceptionInterceptor.class)
    <span class="directive">public</span> <span class="type">class</span> <span class="class">UsersResource</span> {
       <span class="comment">// ...</span>
    }</code></pre>
<div class="paragraph"><p><a href="https://jaxenter.de/wie-man-ein-zentralisiertes-rest-api-exception-handling-mit-beanvalidation-kombiniert-24427" class="bare">https://jaxenter.de/wie-man-ein-zentralisiertes-rest-api-exception-handling-mit-beanvalidation-kombiniert-24427</a></p></div></section>
<section id="_rest_apis_exception_handling_integration_test_automatisiert"><h2>REST-APIs: Exception Handling: Integration-Test (automatisiert)</h2><div class="ulist"><ul><li><p>Bisher: Postman, curl, &#8230;&#8203;</p></li><li><p>Vorteile:</p><div class="ulist"><ul><li><p>Vollständiger end-to-end Test</p></li><li><p>Verifiziert realistische Umgebung</p></li></ul></div></li><li><p>Nachteile:</p><div class="ulist"><ul><li><p>Laufzeit-Umgebung wird benötigt</p></li><li><p>Kaum Integration in IDE und CI/CD</p></li></ul></div></li><li><p>Alternativ Integrationstest mit <code>@QuarkusTest</code></p><div class="ulist"><ul><li><p>Start eines HTTP-Service zur Testausführung</p></li><li><p>Integration in Maven</p></li></ul></div></li></ul></div></section>
<section id="_beispiel_rest_apis_beispiel_quarkustest"><h2>Beispiel REST-APIs: Beispiel <code>@QuarkusTest</code></h2><pre class="CodeRay listingblock"><code class="java language-java">    <span class="annotation">@QuarkusTest</span>
    <span class="directive">public</span> <span class="type">class</span> <span class="class">StaticContentTest</span> {

        <span class="annotation">@TestHTTPEndpoint</span>(HelloResource.class)
        <span class="annotation">@TestHTTPResource</span>
        <span class="predefined-type">URL</span> url;

        <span class="annotation">@Test</span>
        <span class="directive">public</span> <span class="type">void</span> testIndexHtml() <span class="directive">throws</span> <span class="exception">Exception</span> {
            <span class="keyword">try</span> (<span class="predefined-type">InputStream</span> in = url.openStream()) {
                <span class="predefined-type">String</span> contents = readStream(in);
                Assertions.assertTrue(contents.equals(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>));
            }
        }

        <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> readStream(<span class="predefined-type">InputStream</span> in) <span class="directive">throws</span> <span class="exception">IOException</span> {
            <span class="comment">// ...</span>
        }
    }</code></pre>
<div class="paragraph"><p><code>@QuarkusTest</code>: Start eines HTTP-Service zur Testausführung, Integration in Maven (Surefire)</p></div>
<div class="paragraph"><p><code>@TestHTTPResource</code>, <code>@TestHTTPEndpoint:(GreetingResource.class)</code>: URL-Injection, Referenz</p></div>
<div class="paragraph"><p>Vgl. <a href="https://quarkus.io/guides/getting-started-testing" class="bare">https://quarkus.io/guides/getting-started-testing</a></p></div></section>
<section id="_rest_apis_exception_handling_integration_test_automatisiert_2"><h2>REST-APIs: Exception Handling: Integration-Test (automatisiert)</h2><div class="paragraph heading"><p>REST-assured</p></div>
<div class="paragraph"><p>Aufruf der Greeting-Resource aus dem Hello-Word-Beispiel:</p></div>
<pre class="CodeRay listingblock"><code class="java language-java">    <span class="keyword">import</span> <span class="include">static</span> <span class="include">io.restassured.RestAssured.given</span>;
    <span class="keyword">import</span> <span class="include">static</span> <span class="include">org.hamcrest.CoreMatchers.is</span>;

    <span class="annotation">@QuarkusTest</span>
    <span class="annotation">@TestHTTPEndpoint</span>(HelloResource.class)
    <span class="directive">public</span> <span class="type">class</span> <span class="class">HelloResourceTest</span> {

        <span class="annotation">@Test</span>
        <span class="directive">public</span> <span class="type">void</span> testHelloEndpoint() {
            given()
              .when().get()
              .then()
                 .statusCode(<span class="integer">200</span>)
                 .body(is(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>));
        }
    }</code></pre>
<div class="paragraph"><p>Vgl. <a href="https://github.com/rest-assured/rest-assured/wiki/Usage" class="bare">https://github.com/rest-assured/rest-assured/wiki/Usage</a></p></div></section>
<section id="_aufgabe_3_2_lesson03_test"><h2>Aufgabe 3.2: lesson03-test</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong>:</p></div>
<div class="ulist"><ul><li><p>Erweitern Sie die Pizza-Ressource um passende Status-Codes</p><div class="ulist"><ul><li><p>HTTP-201 (created), wenn eine Bestellung erstellt wurde</p></li><li><p>HTTP-204 (no content), wenn eine andere Operation ohne Rückgabe erfolgreich war</p></li><li><p>HTTP-404 (not found), falls eine Bestellung nicht gefunden wurde</p></li><li><p>HTTP-422 (unprocessable entity), falls bei <code>create</code> eine ID übermittelt wurde</p></li></ul></div></li><li><p>Verifizieren Sie die Funktionsweise beispielhaft mit einem Rest-assured Test je Status-Code.</p></li><li><p>Verifizieren Sie, dass die Bestellung 4711 korrekt aus der Datenbank geladen werden kann.</p></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong>:</p></div>
<div class="ulist"><ul><li><p>Im Ordner <code>lesson03_2-test/lesson03</code> befindet sich bereits ein Skelett. Es entspricht der Beispiellösung aus Aufgabe 3.1</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson03/lesson03_2-test</code></p></li></ul></div>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section>
<section id="_die_microprofile_api" data-state="no-title-footer"><h2>Die MicroProfile API</h2><div class="paragraph center"><p>Ein Standard für Microservices</p></div></section>
<section id="_microprofile_api"><h2>MicroProfile API</h2><div class="openblock"><div class="content"><div class="imageblock" style=""><img src="images/microprofile.png" alt="microprofile" width="700"></div>
<div class="ulist"><ul><li><p>Sammlung von Spezifikationen</p></li><li><p>Fokus auf Microservices</p></li></ul></div></div></div>
<div class="openblock"><div class="content"><div class="imageblock" style=""><img src="images/MicroProfile5.0.png" alt="MicroProfile5.0" width="700"></div></div></div></section>
<section id="_microprofile_api_2" class="columns text-center"><h2>MicroProfile API</h2><div class="openblock"><div class="content"><div class="imageblock margin-bottom-wide" style=""><img src="images/quarkus.jpg" alt="quarkus" width="200"></div>
<div class="imageblock margin-bottom-wide" style=""><img src="images/thorntail.png" alt="thorntail" width="250"></div>
<div class="imageblock margin-bottom-wide" style=""><img src="images/openliberty.png" alt="openliberty" width="250"></div></div></div>
<div class="openblock"><div class="content"><div class="imageblock margin-bottom-wide" style=""><img src="images/payara.jpeg" alt="payara" width="250"></div>
<div class="imageblock margin-bottom-wide" style=""><img src="images/helidon.png" alt="helidon" width="250"></div>
<div class="imageblock margin-bottom-wide" style=""><img src="images/kumuluz.png" alt="kumuluz" width="250"></div></div></div></section>
<section id="_microprofile_api_relevante_bestandteile"><h2>MicroProfile API: Relevante Bestandteile</h2><div class="olist arabic"><ol class="arabic"><li><p><a href="lesson04-microprofile.html#/_1_configuration"><strong>Configuration</strong></a>:
Einheitlicher Ansatz zur Konfiguration</p></li><li><p><a href="lesson04-microprofile.html#/_2_health"><strong>Health</strong></a>:
Endpunkte für Health, Liveness und Readiness Checks</p></li><li><p><a href="lesson04-microprofile.html#/_3_fault_tolerance_api"><strong>Fault Tolerance</strong></a>:
Ausfall-Strategie (z.B. Timeouts, Retry Policy, Fallback, Circuit Breaker)</p></li><li><p><a href="lesson04-microprofile.html#/_4_metrics_api_monitoring_auf_anwendungs_und_fachebene"><strong>Metrics</strong></a>:
Metriken, Benchmarks auf Fach- und Anwendungsebene</p></li><li><p><a href="lesson04-microprofile.html#/_5_openapi_swagger_ui"><strong>OpenAPI</strong></a>:
Beschreibung der REST-Schnittstelle</p></li><li><p><a href="lesson04-microprofile.html#/_6_rest_client"><strong>Rest Client</strong></a>:
Aufbauend auf JAX-RS, client-Funktionalität</p></li><li><p><a href="lesson04-microprofile.html#/_7_opentracing_api"><strong>OpenTracing</strong></a>:
Intrumentation für JAX-RS und CDI</p></li></ol></div></section>
<section><section id="_1_configuration"><h2>1. Configuration</h2><div class="paragraph heading"><p>Einheitliche Konfiguration</p></div><div class="paragraph"><p><strong>Worum geht es?</strong></p></div><div class="ulist"><ul><li><p>Quarkus-Komponenten konfigurieren - Tipp: <code>./mvnw quarkus:generate-config</code></p></li><li><p>Eigene Optionen definieren und verwenden</p></li><li><p>Optionen überschreiben (Deployment)</p></li><li><p><code>application.properties</code> je nach Umgebung auswerten</p></li></ul></div><div class="paragraph"><p>Beispiel: Undertow Konfiguration</p></div><pre class="CodeRay listingblock"><code class="properties language-properties">quarkus.http.ssl.certificate.file=/path/to/certificate
quarkus.http.ssl.certificate.key-file=/path/to/key</code></pre></section><section id="_eigene_optionen_definieren"><h2>Eigene Optionen definieren</h2><div class="paragraph"><p><strong>Zugriff</strong></p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@ConfigProperty</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">order.instanceName</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">String</span> instanceName;

<span class="annotation">@ConfigProperty</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">order.currencySymbol</span><span class="delimiter">&quot;</span></span>, defaultValue=<span class="string"><span class="delimiter">&quot;</span><span class="content">€</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">String</span> currencySymbol;

<span class="annotation">@ConfigProperty</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">order.envNotice</span><span class="delimiter">&quot;</span></span>)
Optional&lt;<span class="predefined-type">String</span>&gt; notice;</code></pre>
<div class="paragraph"><p><strong>Werte in <code>application.properties</code></strong></p></div>
<pre class="CodeRay listingblock"><code class="properties language-properties">order.instanceName=dev01
order.currencySymbol=NOK
order.envNotice=Sie arbeiten in der Entwicklung</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/config">Guide: Quarkus - Configuring your application </a></p></div></section><section id="_strukturierte_optionen_definieren"><h2>Strukturierte Optionen definieren</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@ConfigProperties</span>(prefix = <span class="string"><span class="delimiter">&quot;</span><span class="content">order</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">OrderConfiguration</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> instanceName;
    <span class="directive">private</span> <span class="predefined-type">String</span> currencySymbol = <span class="string"><span class="delimiter">&quot;</span><span class="content">€</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">private</span> Optional&lt;<span class="predefined-type">String</span>&gt; notice;

    <span class="comment">// Getter, Setter - Alternative: public statt private</span>
    <span class="comment">// Bean-Validation wird unterstützt.</span>
}</code></pre>
<div class="paragraph"><p><strong>Verwendung</strong></p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Inject</span>
OrderConfiguration orderConfiguration;

<span class="annotation">@ConfigPrefix</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">andererPrefixInApplicationProperties</span><span class="delimiter">&quot;</span></span>)
OrderConfiguration orderConfiguration;</code></pre>
<div class="paragraph"><p><strong>Werte in <code>application.properties</code></strong></p></div>
<pre class="CodeRay listingblock"><code class="properties language-properties">order.instanceName=dev01
order.currencySymbol=NOK
order.envNotice=Sie arbeiten in der Entwicklung</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/config">Guide: Quarkus - Configuring your application</a></p></div></section><section id="_hierarchie_verschiedene_quellen"><h2>Hierarchie verschiedene Quellen</h2><div class="imageblock" style=""><img src="images/config-sources.png" alt="config sources" height="300"></div>
<div class="olist arabic"><ol class="arabic" start="1"><li><p>System-Properties</p><div class="ulist"><ul><li><p><code>java -Dorder.currencySymbol=NOK -jar target/myapp-runner.jar</code></p></li><li><p><code>./target/myapp-runner -Dorder.currencySymbol=NOK</code></p></li></ul></div></li></ol></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/config-reference">Guide: Quarkus - Configuring Reference Guide</a></p></div></section><section id="_hierarchie_verschiedene_quellen_2"><h2>Hierarchie verschiedene Quellen</h2><div class="imageblock" style=""><img src="images/config-sources.png" alt="config sources" height="300"></div>
<div class="olist arabic"><ol class="arabic" start="2"><li><p>Umgebungs-Variablen - <a href="https://github.com/eclipse/microprofile-config/blob/master/spec/src/main/asciidoc/configsources.asciidoc#default-configsources">&#8594; Eclipse Microprofile Konventionen</a></p><div class="ulist"><ul><li><p><code>export ORDER_CURRENCYSYMBOL=NOK ; java -jar target/myapp-runner.jar</code>**</p></li><li><p><code>export ORDER_CURRENCYSYMBOL=NOK  ; ./target/myapp-runner</code></p></li></ul></div></li></ol></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/config-reference">Guide: Quarkus - Configuring Reference Guide</a></p></div></section><section id="_hierarchie_verschiedene_quellen_3"><h2>Hierarchie verschiedene Quellen</h2><div class="imageblock" style=""><img src="images/config-sources.png" alt="config sources" height="300"></div>
<div class="olist arabic"><ol class="arabic" start="3"><li><p><code>.env</code> im Working-Directory (Format wie Umgebungs-Variablen)</p></li></ol></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/config-reference">Guide: Quarkus - Configuring Reference Guide</a></p></div></section><section id="_hierarchie_verschiedene_quellen_4"><h2>Hierarchie verschiedene Quellen</h2><div class="imageblock" style=""><img src="images/config-sources.png" alt="config sources" height="300"></div>
<div class="olist arabic"><ol class="arabic" start="4"><li><p>application.properties im Working-Directory <code>config/application.properties</code></p></li></ol></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/config-reference">Guide: Quarkus - Configuring Reference Guide</a></p></div></section><section id="_hierarchie_verschiedene_quellen_5"><h2>Hierarchie verschiedene Quellen</h2><div class="imageblock" style=""><img src="images/config-sources.png" alt="config sources" height="300"></div>
<div class="olist arabic"><ol class="arabic" start="5"><li><p><code>src/main/resorces/application.properties</code></p></li></ol></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/config-reference">Guide: Quarkus - Configuring Reference Guide</a></p></div></section><section id="_hierarchie_verschiedene_quellen_6"><h2>Hierarchie verschiedene Quellen</h2><div class="imageblock" style=""><img src="images/config-sources.png" alt="config sources" height="300"></div>
<div class="olist arabic"><ol class="arabic" start="6"><li><p>microprofile.properties in den application dependencies, default-Werte der microservices</p></li></ol></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/config-reference">Guide: Quarkus - Configuring Reference Guide</a></p></div></section><section id="_konfiguration_nach_profilen"><h2>Konfiguration nach Profilen</h2><div class="ulist"><ul><li><p>dev - <code>quarkus:dev</code></p></li><li><p>test - Automatisierte Tests</p></li><li><p>prod - Default</p></li></ul></div>
<div class="paragraph"><p><strong>Eigene Profile Definieren: quarkus.profile</strong></p></div>
<div class="ulist"><ul><li><p>System Property: <code>-Dquarkus.profile</code></p></li><li><p>Umgebungs-Variable: <code>QUARKUS_PROFILE</code></p></li></ul></div>
<div class="paragraph"><p>Property-Syntax:</p></div>
<pre class="CodeRay listingblock"><code class="properties language-properties">quarkus.http.port=9090
%dev.quarkus.http.port=8181</code></pre>
<div class="paragraph"><p>ENV-Syntax:</p></div>
<pre class="CodeRay listingblock"><code class="shell script language-shell script">QUARKUS_HTTP_PORT=9090
_DEV_QUARKUS_HTTP_PORT=8181</code></pre>
<div class="paragraph"><p>Alternative: `application<strong>-profile</strong>.properties für jedes Profil</p></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/config">Guide: Quarkus - Configuring your application</a></p></div></section></section>
<section id="_2_health"><h2>2. Health</h2><div class="paragraph"><p>Motivation</p></div>
<div class="ulist"><ul><li><p>Monitoring ermöglichen (icinga, nagios, &#8230;&#8203;)</p></li><li><p>Monitoring durch Application-Server (kubernetes, &#8230;&#8203;)</p></li><li><p>Steuerung durch Application-Server</p></li></ul></div>
<div class="paragraph"><p>Dependency:</p></div>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-smallrye-health<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre></section>
<section id="_2_health_liveness_and_readiness_checks"><h2>2. Health: Liveness and Readiness checks</h2><div class="paragraph"><p>Konzept:</p></div>
<div class="ulist"><ul><li><p><strong>Readiness</strong>: Der Service kann aktuell (temporär) Daten verarbeiten / nicht verarbeiten.</p></li><li><p><strong>Liveness</strong>: Der Service is grundsätzlich aktiv oder dauerhaft nicht erreichbar.</p></li></ul></div>
<div class="paragraph"><p>Eigenschaften:</p></div>
<div class="ulist"><ul><li><p>Feinere Granularität</p></li><li><p>Aufruf:</p><div class="ulist"><ul><li><p><code>curl <a href="http://127.0.0.1:8080/q/health" class="bare">http://127.0.0.1:8080/q/health</a></code> (kombiniert)</p></li><li><p><code>curl <a href="http://127.0.0.1:8080/q/health/live" class="bare">http://127.0.0.1:8080/q/health/live</a></code></p></li><li><p><code>curl <a href="http://127.0.0.1:8080/q/health/ready" class="bare">http://127.0.0.1:8080/q/health/ready</a></code></p></li><li><p><code>curl <a href="http://127.0.0.1:8080/q/health/started" class="bare">http://127.0.0.1:8080/q/health/started</a></code></p></li><li><p><code>browser <a href="http://127.0.0.1:8080/q/health-ui" class="bare">http://127.0.0.1:8080/q/health-ui</a></code> (Health UI von Quarkus)</p></li></ul></div></li></ul></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/microprofile-health">&#8594; Quarkus Microprofile Health</a></p></div>
<div class="paragraph"><p><a href="https://download.eclipse.org/microprofile/microprofile-health-2.1/microprofile-health-spec.html">&#8594; MicroProfile Health Specification</a></p></div></section>
<section id="_2_health_liveness_and_readiness_checks_2"><h2>2. Health: Liveness and Readiness checks</h2><div class="paragraph"><p><strong>Liveness: <code>@Liveness</code></strong></p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Liveness</span>
<span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyLivenessCheck</span> <span class="directive">implements</span> HealthCheck {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> HealthCheckResponse call() {
        <span class="comment">// Inhalt</span>
    }
}</code></pre>
<div class="paragraph"><p><strong>Readiness: <code>@Readiness</code></strong></p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Readiness</span>
<span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyReadinessCheck</span> <span class="directive">implements</span> HealthCheck {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> HealthCheckResponse call() {
        <span class="comment">// Inhalt</span>
    }
}</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/microprofile-health">&#8594; Guide: Quarkus Microprofile Health</a></p></div></section>
<section id="_aufgabe_4_1_lesson04_1_health"><h2>Aufgabe 4.1: lesson04_1-health</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong>:</p></div>
<div class="ulist"><ul><li><p>Implementieren Sie Readiness und Liveness für den Order-Service</p><div class="ulist"><ul><li><p>Readiness: Weniger als 42 Bestellungen Status: <code>IN_PROGRESS</code></p></li><li><p>Liveness: Keine Bestellung Status: <code>LOST</code></p></li></ul></div></li><li><p>Testen Sie mit Postman oder Curl</p></li><li><p>Überprüfen Sie die Ausgabe in der Health-UI</p></li><li><p>Optional: Implementieren Sie einen klassischen Health-Check <strong><code>dice</code></strong>, der würfelt.</p></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong>:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Im Ordner <code>lesson04_1-health/lesson04</code> befindet sich bereits ein Skelett. Es entspricht der Beispiellösung aus Aufgabe 3.4.</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson04_1-health/lesson04</code></p></li></ol></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/microprofile-health">&#8594; Guide: Quarkus Microprofile Health</a></p></div></section>
<section id="_3_fault_tolerance_api"><h2>3. Fault Tolerance API</h2><div class="paragraph heading"><p>Fault Tolerance API: Strategien bei Nicht-Erreichbarkeit</p></div>
<div class="ulist"><ul><li><p><strong>Timeout</strong>: Wenn die Antwort ausbleibt</p></li><li><p><strong>Fallback</strong>: Wenn ein Fehler auftritt</p></li><li><p><strong>Retry</strong>: Wie soll ein Aufruf wiederholt werden?</p></li><li><p><strong>Bulkhead</strong>: Isolation lokaler Fehler</p></li><li><p><strong>Circuit Breaker</strong>: fast-fail: Überlast vermeiden</p></li><li><p>(<strong>Asynchronous</strong>): Verhalten bei asynchronen Aufrufen</p></li></ul></div>
<div class="paragraph"><p>Dependency:</p></div>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-smallrye-fault-tolerance<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/microprofile-fault-tolerance">&#8594; Guide: Quarkus Fault Tolerance</a> |
<a href="https://download.eclipse.org/microprofile/microprofile-fault-tolerance-2.0.4/microprofile-fault-tolerance-spec.html">&#8594; Microprofile Fault Tolerance Specification</a></p></div></section>
<section id="_3_fault_tolerance_timeout_fallback_retries"><h2>3. Fault Tolerance: Timeout, Fallback, Retries</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@GET</span>
<span class="annotation">@Transactional</span>
<span class="annotation">@Timeout</span>(<span class="integer">250</span>)
<span class="annotation">@Fallback</span>(fallbackMethod = <span class="string"><span class="delimiter">&quot;</span><span class="content">sorry</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Retry</span>(maxRetries = <span class="integer">5</span>)
<span class="directive">public</span> <span class="predefined-type">List</span> index(){
    <span class="keyword">return</span> <span class="local-variable">this</span>.repository.listAll();
}
<span class="comment">// Fallback, index times out</span>
<span class="directive">private</span> <span class="predefined-type">List</span> sorry(){
    <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();
}</code></pre>
<div class="paragraph"><p>Konsequenzen</p></div>
<div class="ulist"><ul><li><p>Nach 250ms wird ein Request abgebrochen</p></li><li><p>Es werden bis zu 5 Requests durchgeführt</p></li><li><p>Danach wird die Methode <code>sorry()</code> aufgerufen &#8594; leere Liste als Rückgabe</p></li></ul></div>
<div class="paragraph"><p><a href="https://download.eclipse.org/microprofile/microprofile-fault-tolerance-2.0.4/microprofile-fault-tolerance-spec.html">&#8594; Microprofile Fault Tolerance Specification</a></p></div>
<div class="paragraph"><p><a href="https://download.eclipse.org/microprofile/microprofile-fault-tolerance-2.0.2/apidocs/index.html?org/eclipse/microprofile/faulttolerance/Retry.html">&#8594;
API Documentation</a></p></div></section>
<section id="_3_fault_tolerance_circuit_breaker"><h2>3. Fault Tolerance: Circuit Breaker</h2><div class="paragraph"><p><strong>Ziel: Überlast in Fehler-Situationen verhindern</strong></p></div>
<div class="paragraph"><p>Der Circuit-Breaker definiert Zustände:</p></div>
<div class="ulist"><ul><li><p><strong>Closed State</strong>: Der Stromkreis ist geschlossen, Requests werden bearbeitet.</p></li><li><p><strong>Open State</strong>: Requests werden nicht mehr beantwortet &#8594; Anfragen werden zurückgewiesen.</p></li><li><p><strong>Half-open State</strong>: Anfragen werden teilweise wieder durchgelassen, Requests werden in der Mehrzahl bearbeitet.</p></li></ul></div></section>
<section id="_3_fault_tolerance_circuit_breaker_verwendung"><h2>3. Fault Tolerance: Circuit Breaker: Verwendung</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@POST</span>
<span class="annotation">@Transactional</span>
<span class="annotation">@CircuitBreaker</span>(successThreshold = <span class="integer">5</span>, requestVolumeThreshold = <span class="integer">4</span>,
        failureRatio = <span class="float">0.75</span>, delay = <span class="integer">1000</span>)
<span class="directive">public</span> Response create(<span class="comment">/* ... */</span>)){
    <span class="comment">// ...</span>
}</code></pre>
<div class="paragraph"><p><strong>Open state</strong></p></div>
<div class="ulist"><ul><li><p>Für <code>delay = 1000 ms</code>, falls</p></li><li><p>Von den letzten <code>requestVolumeThreshold = 4</code></p></li><li><p>75% (d.h. <code>failureRatio = 0.75</code>) fehlerhaft sind.</p></li><li><p>Danach: Half-open</p></li></ul></div>
<div class="paragraph"><p><strong>Half-open</strong> - so lange bis:</p></div>
<div class="ulist"><ul><li><p><code>successThreshold = 5</code> Requests hintereinander erfolgreich waren (&#8594; Closed state)</p></li><li><p>Alternativ: Open state auslöst</p></li></ul></div>
<div class="paragraph"><p><a href="https://download.eclipse.org/microprofile/microprofile-fault-tolerance-2.0.2/apidocs/index.html?org/eclipse/microprofile/faulttolerance/CircuitBreaker.html">&#8594; org.eclipse.microprofile.faulttolerance.CircuitBreaker</a></p></div></section>
<section id="_3_fault_tolerance_bulkhead"><h2>3. Fault Tolerance: Bulkhead</h2><div class="paragraph"><p>Ziel: Überlast im Normalfall verhindern</p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Asynchronous</span>
<span class="annotation">@Bulkhead</span>(value = <span class="integer">5</span>)
<span class="directive">private</span> <span class="predefined-type">Future</span> doSomething(Order o) {
    <span class="comment">// ...</span>
}</code></pre>
<div class="paragraph"><p>Ziel: Gleichzeitige Ausführung einschränken (semaphore)</p></div>
<div class="ulist"><ul><li><p><strong>Mit</strong> <code>@Asynchronous</code>: <strong>Thread-Isolation</strong>, d.h. <code>value = 5</code> Threads in Pool</p></li><li><p><strong>Sonst</strong>: Zählende Semaphore, kein eigener Thread-Pool</p></li></ul></div>
<div class="paragraph"><p>API Dokumentation</p></div>
<div class="ulist"><ul><li><p><a href="https://download.eclipse.org/microprofile/microprofile-fault-tolerance-2.0.2/apidocs/index.html?org/eclipse/microprofile/faulttolerance/Asynchronous.html">org.eclipse.microprofile.faulttolerance.Asynchronous</a></p></li><li><p><a href="https://download.eclipse.org/microprofile/microprofile-fault-tolerance-2.0.2/apidocs/index.html?org/eclipse/microprofile/faulttolerance/Bulkhead.html">org.eclipse.microprofile.faulttolerance.Bulkhead</a></p></li></ul></div>
<div class="paragraph"><p><a href="https://de.wikipedia.org/wiki/Semaphor_(Informatik)">&#8594; Wikipedia: Semaphor (Informatik)</a></p></div></section>
<section id="_aufgabe_4_2_lesson04_2_fault_tolerance"><h2>Aufgabe 4.2: lesson04_2-fault-tolerance</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="paragraph"><p>Implementieren Sie verschiedene Fault Tolerance Strategien für die <code>Order Resource</code></p></div>
<div class="ulist"><ul><li><p>Index: Nach einem Timeout von 250ms werden Anfragen abgebrochen. Eine Anfrage wird bis zu 5 mal wiederholt.
Falls die Anfrage fehl schlägt, wird eine leere Liste zurück gegeben.</p></li><li><p>Create: Falls die Annahme von 3 der 4 letzten Bestellung fehlschlägt: Keine Annahme für 1s - nach 5
erfolgreichen Annahmen, steht die Annahme wieder voll zur Verfügung.</p></li><li><p>Update: Es gibt 5 Lieferfahrzeuge, d.h. 5 Pizzas im Status <code>IN_DELIVERY</code>. Beschränken Sie die Auslieferung.</p></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong>:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Im Ordner <code>lesson04_2-fault-tolerance/lesson04</code> befindet sich bereits ein Skelett. Es entspricht der Beispiellösung aus Aufgabe 4.1.</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson04_2-fault-tolerance/lesson04</code></p></li></ol></div></section>
<section><section id="_4_metrics_api_monitoring_auf_anwendungs_und_fachebene"><h2>4. Metrics API: Monitoring auf Anwendungs- und Fachebene</h2><div class="paragraph"><p><strong>Funktion</strong></p></div><div class="ulist"><ul><li><p>Fachereignisse als Benchmark exportieren</p></li><li><p>Optionen</p><div class="ulist"><ul><li><p><strong>Counter</strong> / <strong>Meter</strong> - Aufrufe zählen</p></li><li><p><strong>Gauge</strong> - "Wasserstands-Anzeiger"; beliebiges Feld</p></li><li><p><strong>Timer</strong> - Ausführungsdauer messen</p></li></ul></div></li></ul></div><div class="paragraph"><p><strong>Dependency</strong></p></div><pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>quarkus-smallrye-metrics<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre><div class="paragraph"><p><strong>Abfrage</strong></p></div><div class="ulist"><ul><li><p><code>curl -H"Accept: application/json" <a href="http://localhost:8080/q/metrics/application" class="bare">http://localhost:8080/q/metrics/application</a></code></p></li><li><p><code>curl -H"Accept: application/json" <a href="http://localhost:8080/q/metrics" class="bare">http://localhost:8080/q/metrics</a></code> (auch System-Metrics)</p></li></ul></div><div class="paragraph"><p><a href="https://quarkus.io/guides/microprofile-metrics">
&#8594; Quarkus Metrics</a></p></div></section><section id="_4_metrics_api_monitoring_auf_anwendungs_und_fachebene_2"><h2>4. Metrics API: Monitoring auf Anwendungs- und Fachebene</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@GET</span>
<span class="annotation">@Timed</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">listenAufruf</span><span class="delimiter">&quot;</span></span>, description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Ladezeit Startseite</span><span class="delimiter">&quot;</span></span>, unit = MetricUnits.MILLISECONDS)
<span class="directive">public</span> <span class="predefined-type">List</span> get(){
    <span class="comment">// ....</span>
}
<span class="annotation">@Counted</span>(description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Anzahl</span><span class="delimiter">&quot;</span></span>, absolute = <span class="predefined-constant">true</span>)
<span class="directive">public</span> Response create(<span class="comment">/* ..*/</span>){ {
    <span class="comment">// ...</span>
}</code></pre>
<div class="paragraph"><p>Ergebnis:</p></div>
<pre class="CodeRay listingblock"><code class="json language-json">    <span class="key"><span class="delimiter">&quot;</span><span class="content">application</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">net.gfu.quarkus.endpoints.OrderResource.listenAufruf</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">p99</span><span class="delimiter">&quot;</span></span>: <span class="float">0.0</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">min</span><span class="delimiter">&quot;</span></span>: <span class="float">0.0</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">max</span><span class="delimiter">&quot;</span></span>: <span class="float">0.0</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">mean</span><span class="delimiter">&quot;</span></span>: <span class="float">0.0</span>,
<span class="error">/</span><span class="error">/</span> <span class="error">W</span><span class="error">e</span><span class="error">i</span><span class="error">t</span><span class="error">e</span><span class="error">r</span><span class="error">e</span> <span class="error">s</span><span class="error">t</span><span class="error">a</span><span class="error">t</span><span class="error">i</span><span class="error">s</span><span class="error">t</span><span class="error">i</span><span class="error">s</span><span class="error">c</span><span class="error">h</span><span class="error">e</span> <span class="error">K</span><span class="error">e</span><span class="error">n</span><span class="error">n</span><span class="error">z</span><span class="error">a</span><span class="error">h</span><span class="error">l</span><span class="error">e</span><span class="error">n</span>
            <span class="key"><span class="delimiter">&quot;</span><span class="content">meanRate</span><span class="delimiter">&quot;</span></span>: <span class="float">0.0</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">count</span><span class="delimiter">&quot;</span></span>: <span class="integer">0</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">oneMinRate</span><span class="delimiter">&quot;</span></span>: <span class="float">0.0</span>
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">create</span><span class="delimiter">&quot;</span></span>: <span class="integer">0</span>
    }</code></pre></section></section>
<section><section id="_4_metrics_api_alternative_micrometer"><h2>4. Metrics API Alternative: Micrometer</h2><div class="imageblock" style=""><img src="images/micrometer.png" alt="micrometer" width="1200"></div><div class="paragraph"><p>Dependency (plattformabhängig)</p></div><pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-micrometer<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.micrometer<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>micrometer-registry-prometheus<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre></section><section id="_verwendung_micrometer"><h2>Verwendung Micrometer</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="directive">public</span> MyResource(MeterRegistry registry) {
    <span class="local-variable">this</span>.registry = registry;
    registry.gauge(<span class="string"><span class="delimiter">&quot;</span><span class="content">wasserstand</span><span class="delimiter">&quot;</span></span>, <span class="local-variable">this</span>, MyResource::getWasserstand);
}

<span class="directive">public</span> <span class="type">void</span> doSth() {
    Supplier&lt;<span class="predefined-type">String</span>&gt; supplier = () -&gt; { <span class="comment">// Macht etwas };</span>
    <span class="keyword">return</span> registry.timer(<span class="string"><span class="delimiter">&quot;</span><span class="content">MyResource.doSth</span><span class="delimiter">&quot;</span></span>).wrap(supplier).get();
}</code></pre>
<div class="ulist"><ul><li><p>"Recommended" im Quarkus-Guide, aber nicht Teil von MicroProfile</p></li></ul></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/micrometer">&#8594; Guide: Quarkus Micrometer</a></p></div></section></section>
<section id="_aufgabe_4_3_lesson04_3_metrics"><h2>Aufgabe 4.3: lesson04_3-metrics</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="paragraph"><p>Implementieren Sie verschiedene Metriken für die <code>Order Resource</code></p></div>
<div class="ulist"><ul><li><p>Index:</p><div class="ulist"><ul><li><p>Messung der Ladezeit - wie schnell kann die Seite geladen werden (UX)</p></li></ul></div></li><li><p>Create</p><div class="ulist"><ul><li><p>Umsatz - wie viele Bestellungen gehen ein?</p></li></ul></div></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong></p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Im Ordner <code>lesson04_3-metrics/lesson04</code> befindet sich bereits ein Skelett. Es entspricht der Beispiellösung aus Aufgabe 4.1.</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson04_3-metrics/lesson04</code></p></li></ol></div></section>
<section id="_5_openapi_swagger_ui"><h2>5. OpenAPI / Swagger UI</h2><div class="paragraph center"><p><span class="image"><img src="images/swagger.png" alt="swagger" width="1200"></span></p></div>
<div class="paragraph"><p><strong>OpenAPI</strong>:</p></div>
<div class="ulist"><ul><li><p>YAML-basiert</p></li><li><p>Dokumentenformat zur Beschreibung einer öffentlichen API</p></li></ul></div>
<div class="paragraph"><p><strong>Swagger</strong></p></div>
<div class="ulist"><ul><li><p>Tool-Sammlung</p></li><li><p>Auf OpenAPI aufbauend</p></li></ul></div></section>
<section><section id="_openapi_swagger_ui_verwendung"><h2>OpenAPI / Swagger UI: Verwendung</h2><div class="paragraph"><p><strong>Dependency</strong></p></div><pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-smallrye-openapi<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre><div class="paragraph"><p><strong>Aufruf</strong></p></div><div class="ulist"><ul><li><p><code>chrome <a href="http://localhost:8080/q/swagger-ui" class="bare">http://localhost:8080/q/swagger-ui</a></code> (GUI)</p></li><li><p><code>curl <a href="http://localhost:8080/q/openapi" class="bare">http://localhost:8080/q/openapi</a></code> (Abruf)</p></li></ul></div><div class="paragraph"><p><strong>Ergebnis</strong></p></div><pre class="CodeRay listingblock"><code class="yaml language-yaml"><span class="key">openapi</span>: <span class="string"><span class="content">3.0.3</span></span>
<span class="key">info</span>:
  <span class="key">title</span>: <span class="string"><span class="content">Generated API</span></span>
  <span class="key">version</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>
<span class="key">paths</span>:
  <span class="key">/myRessource</span>:
    <span class="key">get</span>:
      <span class="key">responses</span>:
        <span class="key"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span>:
          <span class="key">description</span>: <span class="string"><span class="content">OK</span></span>
          <span class="key">content</span>:
            <span class="key">application/json</span>:
<span class="comment"># ...</span></code></pre></section><section id="_dokumentation_ausweisen"><h2>Dokumentation ausweisen</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Tag</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">OpenAPI Beispiel</span><span class="delimiter">&quot;</span></span>, description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Quarkus CRUD Endpunkt</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyResource</span> {

    <span class="annotation">@Operation</span>(operationId = <span class="string"><span class="delimiter">&quot;</span><span class="content">all</span><span class="delimiter">&quot;</span></span>, description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Alle Ressourcen abrufen</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@APIResponse</span>(responseCode = <span class="string"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span>, description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Erfolgreich</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">List</span> getAll() { <span class="comment">/* ..*/</span>  }

    <span class="annotation">@POST</span>
    <span class="directive">public</span> Response create(
            <span class="annotation">@Parameter</span>(description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Das Dokument</span><span class="delimiter">&quot;</span></span>, required = <span class="predefined-constant">true</span>) MyDoc doc) { <span class="comment">/* .. */</span>}
}</code></pre>
<div class="ulist"><ul><li><p>Weitere Tags, z.B. <code>@OpenAPIDefinition</code> enthalten</p></li><li><p>Export des OpenAPI-YAML nach adoc, pdf, etc. möglich</p></li></ul></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/openapi-swaggerui">&#8594; Guide: Quarkus Using OpenAPI and Swagger UI</a></p></div></section></section>
<section id="_aufgabe_4_4_lesson04_4_openapi"><h2>Aufgabe 4.4: lesson04_4-openapi</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="ulist"><ul><li><p>Erstellen Sie ein aussagekräftige Dokumentation für die OrderResource</p></li><li><p>Überprüfen Sie das Ergebnis in der Swagger UI</p></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong></p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Im Ordner <code>lesson04_4-openapi/lesson04</code> befindet sich bereits ein Skelett. Es entspricht der Beispiellösung aus Aufgabe 4.1.</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson04_4-openapi/lesson04</code></p></li></ol></div></section>
<section><section id="_6_rest_client"><h2>6. REST Client</h2><div class="paragraph heading"><p>Der Quarkus Rest-Client</p></div><div class="ulist"><ul><li><p>Umsetzung des Microprofile REST client</p></li><li><p>Alternative zum JAX-RS Client</p></li><li><p>Integration in Quarkus</p></li><li><p>Vorteile: Konfiguration, einfache Integration</p></li><li><p>Asynchrone Aufrufe</p></li><li><p>Mock-Server</p></li></ul></div><div class="paragraph"><p>&#160;<br></p></div></section><section id="_maven_dependencies"><h2>Maven Dependencies</h2><pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-rest-client-reactive-jsonb<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>

<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-resteasy-reactive-jsonb<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/rest-client">&#8594; Guide: Quarkus Rest Client</a> (deprecated)</p></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/rest-client-reactive">&#8594; Guide: Quarkus Rest Client Reactive</a></p></div></section></section>
<section id="_rest_client_verwendung"><h2>Rest Client: Verwendung</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="keyword">package</span> <span class="namespace">net.gfu.quarkus.client</span>;

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/hw</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RegisterRestClient</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">HelloWordService</span> {

    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{name}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>)
    GreetingMsg getByName(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> name);

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">GreetingMsg</span> {
        <span class="directive">public</span> <span class="predefined-type">String</span> message;
    }
}</code></pre>
<pre class="CodeRay listingblock"><code class="properties language-properties"># Your configuration properties
net.gfu.quarkus.client.HelloWordService/mp-rest/url=http://localhost:8081
net.gfu.quarkus.client.HelloWordService/mp-rest/scope=javax.inject.Singleton</code></pre>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/myRes</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyResource</span> {
    <span class="annotation">@RestClient</span>
    <span class="annotation">@Inject</span>
    HelloWordService service;

    <span class="annotation">@GET</span> <span class="directive">public</span> <span class="predefined-type">String</span> index() {
        <span class="keyword">return</span> service.getByName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MyResource</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre></section>
<section id="_aufgabe_4_5_lesson04_5_restclient"><h2>Aufgabe 4.5: lesson04_5-restclient</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="ulist"><ul><li><p>Erstellen Sie einen seperaten Franchise-Service, der auch Pizza-Bestellungen anzeigt.</p><div class="ulist"><ul><li><p>Erstellen Sie ein weiteres Quarkus-Projekt <code>franchise</code>.</p></li><li><p>Der Service hat die Operation <code>index()</code>. Die Rückgabe ist wie folgt:</p></li></ul></div></li></ul></div>
<pre class="CodeRay listingblock"><code class="json language-json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">pizzaOrders</span><span class="delimiter">&quot;</span></span> : [] <span class="error">/</span><span class="error">*</span> <span class="error">D</span><span class="error">i</span><span class="error">e</span> <span class="error">L</span><span class="error">i</span><span class="error">s</span><span class="error">t</span><span class="error">e</span> <span class="error">d</span><span class="error">e</span><span class="error">s</span> <span class="error">O</span><span class="error">r</span><span class="error">d</span><span class="error">e</span><span class="error">r</span><span class="error">-</span><span class="error">S</span><span class="error">e</span><span class="error">r</span><span class="error">v</span><span class="error">i</span><span class="error">c</span><span class="error">e</span><span class="error">s</span> <span class="error">*</span><span class="error">/</span>
}</code></pre>
<div class="paragraph"><p><strong>Hinweise</strong></p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Der Eintrag <strong><code>quarkus.http.port=8080</code></strong> in der Datei <code>application.properties</code> bestimmt den HTTP-Port ‒
<strong><code>mvn compile quarkus:dev -Ddebug=5006</code></strong> den Debug-Port.</p></li><li><p>Im Ordner <code>lesson04_5-restclient/lesson04</code> befindet sich bereits ein Skelett, jedoch nur für einen Service</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson04_5-restclient/</code>. Das Beispiel enthält beide Projekte</p></li></ol></div></section>
<section id="_7_opentracing_api"><h2>7. OpenTracing API</h2><div class="paragraph heading"><p>Warum Tracing?</p></div>
<div class="paragraph"><p><strong>Herausforderung Verteiltes System</strong></p></div>
<div class="ulist"><ul><li><p>Requests durchlaufen verschiedene Services</p></li><li><p>Jeder Service führt individuelles Protokoll / Log</p></li><li><p>Welche Protokoll-Einträge gehören zusammen? Was gehört alles zu einem Request?</p></li></ul></div>
<div class="paragraph"><p><strong>Ansatz: Request correlation</strong></p></div>
<div class="ulist"><ul><li><p>ID an Requests initial vergeben</p></li><li><p>ID beim Aufruf anderer Services weiterreichen</p></li><li><p>ID loggen</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-smallrye-opentracing<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/opentracing">&#8594; Quarkus - Using OpenTracing</a></p></div></section>
<section id="_7_opentracing_api_verwendung"><h2>7. OpenTracing API: Verwendung</h2><div class="paragraph"><p><strong>Konfiguration - <code>application.properties</code></strong></p></div>
<pre class="CodeRay listingblock"><code class="properties language-properties">quarkus.jaeger.service-name=franchise
quarkus.jaeger.sampler-type=const
quarkus.jaeger.sampler-param=1
quarkus.log.console.format=%d{HH:mm:ss} %-5p traceId=%X{traceId}, parentId=%X{parentId}, spanId=%X{spanId}, sampled=%X{sampled} [%c{2.}] (%t) %s%e%n</code></pre>
<div class="paragraph"><p><strong>Logger mit Trace-Ausgabe</strong></p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="keyword">import</span> <span class="include">org.jboss.logging.Logger</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">FranchiseResource</span> {

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">Logger</span> LOG = <span class="predefined-type">Logger</span>.getLogger(FranchiseResource.class);

    <span class="directive">public</span> <span class="predefined-type">String</span> index() {
        LOG.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">Index called</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
<div class="paragraph"><p><strong>Beispiel</strong> (Korrelation während der Auswertung)</p></div>
<pre class="CodeRay listingblock"><code>13:20:11 INFO  traceId=1336b2b0a76a96a3, parentId=0, spanId=1336b2b0a76a96a3, sampled=true [or.ac.qu.TracedResource] (executor-thread-63) Index called</code></pre></section>
<section id="_7_opentracing_api_jaeger_ui"><h2>7. OpenTracing API: Jaeger UI</h2><div class="paragraph center"><p><span class="image"><img src="images/jaeger.png" alt="jaeger"></span></p></div>
<div class="paragraph"><p><strong>Installation</strong></p></div>
<pre class="CodeRay listingblock"><code>docker run \
-p 5775:5775/udp -p 6831:6831/udp -p 6832:6832/udp -p 5778:5778 -p 16686:16686 -p 14268:14268 \
jaegertracing/all-in-one:latest</code></pre>
<div class="paragraph"><p><a href="http://localhost:16686/">&#8594; Jaeger UI http://localhost:16686/</a></p></div>
<div class="paragraph"><p><a href="https://www.jaegertracing.io/">&#8594; Jaeger: open source, end-to-end distributed tracing</a></p></div></section>
<section id="_aufgabe_4_6_lesson04_6_tracing"><h2>Aufgabe 4.6: lesson04_6-tracing</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="paragraph"><p>Verfolgen Sie requests zwischen Franchise und Order-Service aus der letzten Ausgabe.</p></div>
<div class="ulist"><ul><li><p>Erweitern Sie beide Projekte und nutzen Sie die OpenTracing API</p></li><li><p>Loggen Sie, wenn die index-Methode aufgerufen wird. Beobachten Sie die IDs</p></li><li><p>Verfolgen Sie den Franchise-Request in Jaeger</p></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong></p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Der Eintrag <strong><code>quarkus.http.port=8080</code></strong> in der Datei <code>application.properties</code> bestimmt den HTTP-Port ‒
<strong><code>mvn compile quarkus:dev -Ddebug=5006</code></strong> den Debug-Port.</p></li><li><p>Im Ordner <code>lesson04_6-tracing/lesson04</code> befindet sich bereits ein Skelett, basierend auf der vorherigen Aufgabe.
Es enthält den Franchise- und den Order-Service.</p></li><li><p>Eine Beispiellösung finden Sie im Ordner <code>solutions/lesson04_6-tracing/</code>.</p></li><li><p>Integration von Jaeger in Elastic-Search: <a href="https://logz.io/blog/jaeger-and-the-elk-stack/" class="bare">https://logz.io/blog/jaeger-and-the-elk-stack/</a></p></li></ol></div>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section>
<section id="_lektion_5_quarkus_security" data-state="no-title-footer"><h2>Lektion 5 - Quarkus Security</h2><div class="paragraph center"><p>Was fällt Ihnen zum Thema Security ein?</p></div>
<div class="paragraph center"><p>Welche Unterstützung erwarten Sie von Quarkus?</p></div></section>
<section id="_quarkus_security"><h2>Quarkus-Security</h2><div class="paragraph heading"><p>Themen</p></div>
<div class="ulist"><ul><li><p>Grundlagen zu IT-Sicherheit</p></li><li><p>Authentifzierung mit Quarkus</p></li><li><p>Authentifzierung bei einer Webanwendung</p></li><li><p>Autorisierung</p></li></ul></div></section>
<section><section id="_grundlagen_zu_it_sicherheit"><h2>Grundlagen zu IT-Sicherheit</h2><div class="paragraph heading"><p>IT-Sicherheit</p></div><div class="paragraph"><p>Es gibt drei Grundwerte  der Informationssicherheit:</p></div><div class="ulist"><ul><li><p>Vertraulichkeit,</p></li><li><p>Verfügbarkeit und</p></li><li><p>Integrität.</p></li></ul></div><div class="paragraph"><p>Quelle: <a href="https://www.bsi.bund.de/DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/IT-Grundschutz/BSI-Standards/BSI-Standard-200-2-IT-Grundschutz-Methodik/Leitfaden-Basis-Absicherung/leitfaden-basis-absicherung_node.html">Leitfaden Informationssicherheit</a>,<br>
<a href="https://www.bsi.bund.de/">Bundesamt für Sicherheit in der Informationstechnik – BSI</a></p></div></section><section id="_it_sicherheit_mit_quarkus_security"><h2>IT-Sicherheit mit Quarkus-Security</h2><div class="paragraph"><p>Es gibt drei Grundwerte der Informationssicherheit:</p></div>
<div class="ulist"><ul><li><p>Vertraulichkeit, &#8658; Quarkus Security:</p><div class="ulist"><ul><li><p>Authentifizierung &#8658; Anwender identifizieren</p></li><li><p>Autorisierung &#8658; Berechtigung prüfen</p></li></ul></div></li><li><p>Verfügbarkeit und</p></li><li><p>Integrität.</p></li></ul></div></section><section id="_security_bei_quarkus_webanwendungen"><h2>Security bei Quarkus Webanwendungen</h2><div class="ulist"><ul><li><p>Security ist ein Querschnittsthema</p></li><li><p>Erste Berechtigungsprüfung anhand der URL</p></li><li><p>Securitybelange über Filterkette realisiert</p></li></ul></div></section><section id="_security_bei_quarkus_webanwendungen_ablauf"><h2>Security bei Quarkus Webanwendungen: Ablauf</h2><div class="olist arabic"><ol class="arabic"><li><p>Anwender besucht Startseite und klickt auf einen Link</p></li><li><p>Anfrage geht an Server, dieser stellt fest: Seite ist geschützt</p></li><li><p>Server antwortet: Authentifizierung erforderlich (401 oder redirect)</p></li><li><p>Anwender gibt Username und Passwort im Browser ein</p></li><li><p>Browser schickt Daten an Server</p></li><li><p>Server prüft Anmeldedaten</p></li><li><p>Server löst Weiterleitung auf geschützte Seite aus</p></li></ol></div>
<div class="paragraph"><p><em>Hinweis: In einer µService-Architektur: IdR dedizierter Service (AAA / SSO) für Authentication</em></p></div></section><section id="_begriffe_rechte_rollen_benutzer_und_gruppen"><h2>Begriffe: Rechte, Rollen, Benutzer und Gruppen</h2><div class="ulist"><ul><li><p>Authentication (Authentifizierung)</p><div class="ulist"><ul><li><p>User: Login, Kennung, Kennwort</p></li><li><p>Group: Zusammenfassung von Benutzern</p></li></ul></div></li><li><p>Authorization (Autorisierung)</p><div class="ulist"><ul><li><p>Permission: Eine Operation darf ausgeführt werden</p></li><li><p>Role: Zusammenfassung von Rechten</p></li></ul></div></li></ul></div>
<div class="paragraph"><p><em>Beliebige Zuordnung User, Group &#8592; &#8594; Permission, Role denkbar.</em></p></div>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section></section>
<section><section id="_rechte_und_rollen_in_quarkus"><h2>Rechte und Rollen in Quarkus</h2><div class="paragraph"><p>Möglichkeiten zur Zuordnung</p></div><div class="olist arabic"><ol class="arabic"><li><p>Programmatisch</p></li><li><p>.properties und Pattern Matching</p></li><li><p>Extern</p></li></ol></div></section><section id="_programmatisch"><h2>Programmatisch</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="keyword">import</span> <span class="include">javax.ws.rs.core.SecurityContext</span>; <span class="comment">// Vorsicht: Es gibt verschiedene</span>

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/users</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">UsersController</span>{
    <span class="annotation">@RolesAllowed</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">admin</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Get</span> <span class="directive">public</span> Response index(){ <span class="comment">/* ... */</span> }

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">myDetails</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@RolesAllowed</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Get</span> <span class="directive">public</span> UserDetails ownDetails(<span class="annotation">@Context</span> SecurityContext sec){
        <span class="predefined-type">Principal</span> user = sec.getUserPrincipal();
        <span class="keyword">return</span> <span class="local-variable">this</span>.userRepository.findByLogin(user.getName());
    }
}</code></pre>
<div class="paragraph"><p><strong>(Relevante) JEE-Annotationen für Klassen oder Methoden</strong>:</p></div>
<div class="ulist"><ul><li><p><a href="https://javaee.github.io/javaee-spec/javadocs/index.html?javax/annotation/security/RolesAllowed.html">@RolesAllowed</a>,
<a href="https://javaee.github.io/javaee-spec/javadocs/index.html?javax/annotation/security/RunAs.html">@RunAs</a>,
<a href="https://javaee.github.io/javaee-spec/javadocs/index.html?javax/annotation/security/PermitAll.html">@PermitAll</a>,
<a href="https://javaee.github.io/javaee-spec/javadocs/index.html?javax/annotation/security/DenyAll.html">@DenyAll</a></p></li></ul></div>
<div class="paragraph"><p><strong>Zuordnung</strong></p></div>
<div class="ulist"><ul><li><p>Recht: <code>/url</code> &#8592;&#8594; Rolle: <code>admin</code> als Methode (übliche Konvention)</p></li><li><p>Alternativ: <a href="https://jakarta.ee/specifications/platform/8/apidocs/javax/ws/rs/core/SecurityContext.html">javax.ws.rs.core.SecurityContext</a></p></li></ul></div></section><section id="_via_properties_pattern_matching"><h2>Via .properties / Pattern matching</h2><pre class="CodeRay listingblock"><code class="properties language-properties">quarkus.http.auth.policy.role-policy1.roles-allowed=user,admin

quarkus.http.auth.permission.roles1.paths=/roles-secured/*,/other/*,/api/*
quarkus.http.auth.permission.roles1.policy=role-policy1

quarkus.http.auth.permission.permit1.paths=/public/*
quarkus.http.auth.permission.permit1.policy=permit
quarkus.http.auth.permission.permit1.methods=GET

quarkus.http.auth.permission.deny1.paths=/forbidden
quarkus.http.auth.permission.deny1.policy=deny</code></pre>
<div class="paragraph"><p><strong>Trennung von Roles und Permission</strong></p></div>
<div class="ulist"><ul><li><p><code>quarkus.http.auth.policy.</code></p></li><li><p><code>quarkus.http.auth.permission.</code></p></li></ul></div>
<div class="paragraph"><p><strong>Konflikt:</strong></p></div>
<div class="ulist"><ul><li><p>Spezifische Regeln (langer Pfad) vor kurzen</p></li><li><p>Alle Regeln mit gleichem Pfad müssen erlauben</p></li></ul></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/security-authorization">&#8594; Guide: Quarkus - Authorization of Web Endpoints</a></p></div></section><section id="_externe_zuordnung"><h2>Externe Zuordnung</h2><pre class="CodeRay listingblock"><code class="properties language-properties"># OIDC Configuration
quarkus.oidc.auth-server-url=https://localhost:8543/auth/realms/quarkus
quarkus.oidc.client-id=backend-service
quarkus.oidc.credentials.secret=secret
quarkus.oidc.tls.verification=none
# Enable Policy Enforcement
quarkus.keycloak.policy-enforcer.enable=true</code></pre>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/api/admin</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">AdminResource</span> {
    <span class="annotation">@Inject</span> SecurityIdentity identity;

    <span class="annotation">@Authenticated</span>
    <span class="annotation">@GET</span> <span class="directive">public</span> <span class="predefined-type">String</span> admin() { <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">granted</span><span class="delimiter">&quot;</span></span>; }

    <span class="annotation">@GET</span> <span class="directive">public</span> CompletionStage&lt;<span class="predefined-type">List</span>&lt;<span class="predefined-type">Permission</span>&gt;&gt; get() {
        <span class="keyword">return</span> identity.checkPermission(<span class="keyword">new</span> <span class="predefined-type">AuthPermission</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{resource_name}</span><span class="delimiter">&quot;</span></span>))
                .thenCompose(granted -&gt; {
                    <span class="keyword">if</span> (granted) {
                        <span class="keyword">return</span> CompletableFuture.completedFuture(doGetState());
                    }
                    <span class="keyword">throw</span> <span class="keyword">new</span> ForbiddenException();
                });
    }
}</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/security-keycloak-authorization">&#8594; Guide: Using OpenID Connect and Keycloak to centralize authorization</a></p></div></section></section>
<section><section id="_authentication_verwendung"><h2>Authentication - Verwendung</h2><div class="paragraph"><p>Was kann Quarkus?</p></div><div class="ulist"><ul><li><p>Basic und formular-basiert (auch LDAP)</p></li><li><p>OpenID Connect (auch OAuth2; d.h. Authorization)</p></li><li><p>JSON Web Token (JWT) ohne OpenID Connect Workflow</p></li><li><p>TLS Zertifikate (X.509)</p></li></ul></div><div class="paragraph"><p><a href="https://quarkus.io/guides/security">&#8594; Quarkus Security Architecture and Guides</a></p></div></section><section id="_basic_authentication"><h2>Basic Authentication</h2><div class="paragraph"><p>Redhat Elytron</p></div>
<div class="ulist"><ul><li><p>Kennwörter in Datenbank oder .properties speichern</p></li><li><p>Hilfreich in der Entwicklung</p></li></ul></div>
<div class="paragraph"><p><em>Hinweis: Produktive Benutzer-Kennwörter dürfen nie im Klartext gespeichert werden</em></p></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/security-properties">Guide: Quarkus - Using Security with .properties file</a></p></div></section><section id="_elytron"><h2>Elytron</h2><pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-elytron-security-properties-file<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
<div class="paragraph"><p>application.properties</p></div>
<pre class="CodeRay listingblock"><code class="properties language-properties">quarkus.security.users.file.enabled=true
quarkus.security.users.file.users=test-users.properties
quarkus.security.users.file.roles=test-roles.properties
quarkus.security.users.file.realm-name=MyRealm
quarkus.security.users.file.plain-text=true</code></pre>
<div class="paragraph"><p>test-users.properties</p></div>
<pre class="CodeRay listingblock"><code class="properties language-properties">scott=jb0ss
jdoe=p4ssw0rd</code></pre>
<div class="paragraph"><p>test-roles.properties</p></div>
<pre class="CodeRay listingblock"><code class="properties language-properties">scott=Admin,admin,Tester,user
jdoe=NoRolesUser</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/security-properties">Guide: Quarkus - Using Security with .properties file</a></p></div></section><section id="_keycloak"><h2>Keycloak</h2><div class="paragraph center"><p><span class="image"><img src="images/keycloak.png" alt="keycloak"></span></p></div></section><section id="_openid_connect_keycloak_sso"><h2>OpenID Connect / Keycloak (SSO)</h2><pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
 <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
 <span class="tag">&lt;artifactId&gt;</span>quarkus-oidc<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
<pre class="CodeRay listingblock"><code class="properties language-properties">quarkus.oidc.auth-server-url=http://localhost:8180/auth/realms/quarkus
quarkus.oidc.client-id=frontend
quarkus.oidc.credentials.client-secret=geheim
quarkus.oidc.application-type=web-app
quarkus.http.auth.permission.authenticated.paths=/*
quarkus.http.auth.permission.authenticated.policy=authenticated</code></pre>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/api/users</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">UsersResource</span> {
    <span class="annotation">@Inject</span>
    SecurityIdentity securityIdentity;

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/me</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@RolesAllowed</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@GET</span> <span class="directive">public</span> User me() {
        <span class="keyword">return</span> <span class="keyword">new</span> User(securityIdentity);
    }}</code></pre></section><section id="_plain_jwt"><h2>Plain-JWT</h2><div class="ulist"><ul><li><p>JSON Web Token (JWT) als Ersatz für ein Kennwort</p></li><li><p>Token intern validierbar</p></li><li><p>Auch: Validierung über Keycloak möglich</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-smallrye-jwt<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre></section><section id="_plain_jwt_einbindung"><h2>Plain-JWT: Einbindung</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/secured</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RequestScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TokenSecuredResource</span> {
    <span class="annotation">@Inject</span>
    JsonWebToken jwt;

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">roles-allowed</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@RolesAllowed</span>({ <span class="string"><span class="delimiter">&quot;</span><span class="content">User</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Admin</span><span class="delimiter">&quot;</span></span> })
    <span class="annotation">@GET</span> <span class="directive">public</span> <span class="predefined-type">String</span> helloRolesAllowed(<span class="annotation">@Context</span> SecurityContext ctx) {
        <span class="keyword">return</span> getResponseString(ctx) + <span class="string"><span class="delimiter">&quot;</span><span class="content">, birthdate: </span><span class="delimiter">&quot;</span></span> + jwt.getClaim(<span class="string"><span class="delimiter">&quot;</span><span class="content">birthdate</span><span class="delimiter">&quot;</span></span>).toString();
    }
}</code></pre>
<pre class="CodeRay listingblock"><code class="properties language-properties">mp.jwt.verify.publickey.location=META-INF/resources/publicKey.pem
mp.jwt.verify.issuer=https://example.com/issuer</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/security-jwt">&#8594; Guide: Quarkus - Using JWT RBAC</a></p></div>
<div class="paragraph"><p><a href="https://github.com/AnthonyDeroche/mod_authnz_jwt">&#8594; AnthonyDeroche / mod_authnz_jwt</a></p></div></section></section>
<section><section id="_transport_layer_security_tls"><h2>Transport Layer Security (TLS)</h2><div class="paragraph heading"><p>Warum Transport Layer Security (TLS) / HTTPS?</p></div><div class="ulist"><ul><li><p>Credentials werden im Klartext abgefragt.</p></li><li><p>Clustering über Wide Area Networks (WAN)</p></li></ul></div><div class="paragraph"><p><strong>Wer terminiert TLS?</strong></p></div><div class="olist arabic"><ol class="arabic"><li><p>Quarkus</p></li><li><p>Das API-Gateway (z.B. nginx)</p></li></ol></div></section><section id="_tls_mit_quarkus_terminieren"><h2>TLS mit Quarkus terminieren</h2><pre class="CodeRay listingblock"><code class="properties language-properties">quarkus.http.ssl.certificate.file=/path/to/certificate
quarkus.http.ssl.certificate.key-file=/path/to/key
quarkus.http.ssl-port=8443

#Alternativen enabled, disabled
quarkus.http.insecure-requests=redirect</code></pre>
<div class="paragraph"><p>Alternativ: Keystore einbinden</p></div>
<div class="paragraph"><p><em>Keine Maven Dependency nötig :-)</em></p></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/http-reference">&#8594; Guide: Quarkus - HTTP Reference</a></p></div></section></section>
<section id="_aufgabe_5_lesson05_security"><h2>Aufgabe 5 lesson05-security</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="paragraph"><p>Beschränken Sie Aufrufe auf den Order-Service:</p></div>
<div class="ulist"><ul><li><p>Benutzer mit Rolle <code>user</code> dürfen Bestellungen erstellen; sonst ist die Rolle <code>admin</code> erforderlich.</p></li><li><p>Nutzen Sie Elytron. Legen Sie Kennwörter in der <code>.properties</code>-Datei ab.</p></li><li><p>Verschlüsseln Sie Zugriffe mit TLS.</p></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong></p></div>
<div class="ulist"><ul><li><p>Im Ordner <code>lesson05-security</code> ist ein Skelett. Es basiert auf der Beispiellösung von Aufgabe 3.1</p></li><li><p>Das Archiv <code>certs.zip</code> in <code>lesson05-security</code> enthält ein TLS-Zertifikat. Es gilt für:</p><div class="ulist"><ul><li><p><code>localhost.k.anderscore.com</code></p></li><li><p><code>order.k.anderscore.com</code></p></li><li><p><code>franchise.k.anderscore.com</code></p></li></ul></div></li><li><p>Im Ordner <code>solutions/lesson05-security</code> ist eine Beispiellösung. Zum Start muss das Archiv
mit den Zertifikaten entpackt werden.</p></li></ul></div>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section>
<section id="_lektion_6_application_building_graalvm" data-state="no-title-footer"><h2>Lektion 6 - Application Building: GraalVM</h2><div class="paragraph text-center"><p>Was ist die GraalVM?<br>
Wie kann sie zusammen mit Quarkus genutzt werden?</p></div></section>
<section id="_einführung"><h2>Einführung</h2><div class="imageblock" style=""><img src="images/lesson06/graalvm.svg" alt="graalvm" width="800"></div>
<div class="ulist"><ul><li><p>Alternative zu OpenJDK/HotSpot</p></li><li><p>Truffle Framework: Unterstützung anderer Sprachen über AST (Abstract-Syntax-Tree)</p></li><li><p>Native Image: Erweiterung für ahead-of-time Compilation</p></li><li><p>Graal Compiler, SubstrateVM</p></li><li><p>Entwickelt in Java</p></li><li><p>Produktiv seit 2019</p></li><li><p>Community Edition vs. Enterprise Edition</p></li></ul></div></section>
<section id="_einführung_2"><h2>Einführung</h2><div class="imageblock" style=""><img src="images/lesson06/graalvm_architecture.jpg" alt="graalvm architecture" width="1400"></div></section>
<section id="_vorteile_2"><h2>Vorteile</h2><div class="ulist"><ul><li><p>Reduzierte Startup Time</p></li><li><p>Geringerer Speicherverbrauch</p></li><li><p>Polyglotte Anwendungen</p></li></ul></div></section>
<section id="_installation_und_verwendung"><h2>Installation und Verwendung</h2><div class="paragraph"><p><strong>Installation</strong></p></div>
<div class="olist arabic"><ol class="arabic"><li><p>GraalVM CE herunterladen:</p><div class="paragraph"><p><a href="https://github.com/graalvm/graalvm-ce-builds/releases" class="bare">https://github.com/graalvm/graalvm-ce-builds/releases</a></p></div></li><li><p>GraalVM CE installieren (Linux):</p><pre class="CodeRay listingblock"><code class="bash language-bash">tar -xzf &lt;graalvm-archive&gt;.tar.gz
export PATH=&lt;graalvm&gt;/bin:$PATH
export JAVA_HOME=&lt;graalvm&gt;</code></pre></li><li><p>Native Image installieren (Linux):</p><pre class="CodeRay listingblock"><code class="bash language-bash">sudo apt-get install build-essential libz-dev zlib1g-dev
gu install native-image</code></pre></li></ol></div>
<hr>
<div class="paragraph"><p><strong>Native Executable erzeugen</strong></p></div>
<pre class="CodeRay listingblock"><code class="bash language-bash">native-image -jar my-app.jar
./my-app</code></pre></section>
<section id="_aufgabe_6_1_erste_schritte_mit_graalvm"><h2>Aufgabe 6.1: Erste Schritte mit GraalVM</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Erstellen Sie ein leeres Maven-Projekt und legen Sie darin eine Klasse an, die "Hello GraalVM!" ausgibt.</p></li><li><p>Binden Sie das maven-jar-plugin ein und erzeugen Sie mittels <code>mvn package</code> ein Executable Jar.</p></li><li><p>Starten Sie das Jar über <code>java -jar &lt;executable-jar&gt;.jar</code>.</p></li><li><p>Installieren Sie GraalVM CE und die Erweiterung Native Image auf Ihrem Rechner, falls noch nicht geschehen.</p></li><li><p>Erzeugen Sie über <code>native-image -jar &lt;executable-jar&gt;.jar</code> ein Native Executable aus Ihrem Jar und starten Sie dieses.
Was fällt Ihnen auf?</p></li></ol></div>
<div class="paragraph"><p><strong>Hinweise</strong></p></div>
<div class="ulist"><ul><li><p>Zu dieser Aufgabe gibt es kein Skelett. Verwenden Sie ein neues Projekt.</p></li><li><p>Eine Beispiellösung finden sie im Ordner <code>solutions/lesson06_1-graalvm</code></p></li></ul></div></section>
<section id="_native_executables"><h2>Native Executables</h2><div class="imageblock" style=""><img src="images/lesson06/native-executable-process.png" alt="native executable process" width="1200"></div></section>
<section id="_native_executables_und_startup"><h2>Native Executables und Startup</h2><div class="paragraph"><p><strong>Native Executable</strong></p></div>
<div class="ulist"><ul><li><p>App + Quarkus Runtime + SubstrateVM</p></li><li><p>Deutliche Reduktion der Startup Time</p></li><li><p>Erstellung auch ohne lokale GraalVM</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="bash language-bash">./mvnw package -Pnative -Dquarkus.native.container-build=true -Dquarkus.container-image.build=true</code></pre>
<hr>
<div class="paragraph"><p><strong>Startup</strong></p></div>
<pre class="CodeRay listingblock"><code class="bash language-bash">./quarkus-demo-1.0-SNAPSHOT-runner</code></pre>
<pre class="CodeRay listingblock"><code>[io.quarkus] (main) Installed features: [agroal, cdi, hibernate-orm,
jdbc-h2,mutiny, narayana-jta,resteasy, resteasy-jsonb, smallrye-context-propagation,
smallrye-health, smallrye-metrics, smallrye-openapi]</code></pre></section>
<section id="_einschränkungen"><h2>Einschränkungen</h2><div class="paragraph"><p><strong>Einschränkungen</strong></p></div>
<div class="ulist"><ul><li><p>Reflection (@RegisterForReflection)</p></li><li><p>JDK DynamicProxy</p></li><li><p>Resources</p></li><li><p>JNI</p></li><li><p>Statische Initialisierung (durch Heap Snapshots)</p></li></ul></div>
<hr>
<div class="paragraph"><p><strong>Nicht unterstützt</strong></p></div>
<div class="ulist"><ul><li><p>Dynamisches Class Loading (z.B. JRebel)</p></li><li><p>Manipulationen des Bytecodes (z.B. Lombok, Profiler)</p></li><li><p>Java Debugger (nur GDB)</p></li><li><p>InvokeDynamic, MethodHandles</p></li></ul></div></section>
<section id="_quarkus_arc"><h2>Quarkus ArC</h2><div class="ulist"><ul><li><p>Problem: CDI 2.0 (Weld) nutzt Reflection</p></li><li><p>ArC: Built Time CDI</p></li><li><p>Statische Verwendungsanalyse</p></li><li><p>"Hardcoding" der Metadaten</p></li><li><p>Eingeschränkungen bei BeanManager</p></li></ul></div>
<hr>
<div class="paragraph"><p><strong>Nicht unterstützt</strong>:</p></div>
<div class="ulist"><ul><li><p>@Interceptor</p></li><li><p>@Decorator</p></li><li><p>@ConversationScoped</p></li><li><p>Passivation</p></li><li><p>Portable Extensions</p></li><li><p>beans.xml</p></li></ul></div></section>
<section id="_aufgabe_2_native_executables"><h2>Aufgabe 2: Native Executables</h2><div class="olist arabic"><ol class="arabic"><li><p>Öffnen Sie das Projekt <code>lesson06_2-native</code>.</p></li><li><p>Erzeugen Sie mittels <code>./mvnw clean package</code> ein Executable Jar und starten Sie es über <code>java -jar &lt;executable-jar&gt;.jar -Dquarkus.http.port=8181</code>.</p></li><li><p>Erzeugen Sie mittels <code>./mvnw clean package -Pnative</code> ein Native Executable und starten Sie es über <code>./target/&lt;native-executable&gt;</code>. Wie erklären Sie sich die Ausgabe?</p></li><li><p>Optional: Welche technischen Anpassungen müssen Sie an dem Service und seiner Konfiguration vornehmen, damit dieser nativ ausgeführt werden kann? Tip: Schauen Sie sich hierzu auch einmal
den Server Mode und die Console von H2 an.</p></li><li><p>Optional: Vergleichen Sie Startup Time und Speicherverbrauch des Native Executables mit jenen des Executable Jars.</p></li></ol></div></section>
<section id="_quarkus_native_tests"><h2>Quarkus Native Tests</h2><div class="ulist"><ul><li><p>@NativeImageTest</p></li><li><p>Integration Test für Native Executable</p></li><li><p>Black Box Test gegen öffentliche API</p></li><li><p>Test selbst läuft auf JVM</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@NativeImageTest</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">NativeOrderResourceIT</span> <span class="directive">extends</span> OrderResourceTest {

    <span class="comment">// Execute the same tests but in native mode.</span>
}</code></pre></section>
<section id="_aufgabe_6_3_native_tests"><h2>Aufgabe 6.3: Native Tests:</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Bauen Sie ein Native Executable und starten Sie den PostgreSQL (alternativ: H2 Server), sofern noch nicht geschehen.</p></li><li><p>Lassen Sie den NativeOrderResourceIT laufen und vollziehen Sie die Ausgabe nach.</p></li></ol></div>
<div class="paragraph"><p><strong>Hinweise</strong></p></div>
<div class="ulist"><ul><li><p>Einen Postgres-Server können Sie wie folgt starten<br>
<code>docker run --name some-postgres -e POSTGRES_PASSWORD=mysecretpassword -d postgres</code></p><div class="ulist"><ul><li><p>User: <code>postgres</code>, Datenbank <code>postgres</code>, Kennwort: <code>mysecretpassword</code><br></p></li></ul></div></li><li><p>Das Skelett zur Aufgabe befindet sich im Ordner <code>lesson06_2-native</code></p></li><li><p>Eine Beispiellösung liegt im Ordner `solutions/lesson06_3-native</p></li></ul></div>
<div class="paragraph"><p><a href="https://quarkus.io/guides/building-native-image">Guide: Quarkus - Building Native Image </a></p></div></section>
<section id="_zusammenfassung_application_building"><h2>Zusammenfassung Application Building</h2><div class="ulist"><ul><li><p>GraalVM ermöglicht Native Executables</p></li><li><p>Sehr gute Unterstützung durch Quarkus</p></li><li><p>Reduktion von Startup Time und Speicherverbrauch</p></li><li><p>Einschränkungen (z.B. Reflection)</p></li><li><p>Native Integration Tests</p></li></ul></div>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section>
<section id="_lektion_7_container" data-state="no-title-footer"><h2>Lektion 7 - Container</h2><div class="paragraph center"><p>Was fällt Ihnen zu Containern ein?</p></div></section>
<section id="_kennen_sie"><h2>Kennen Sie?</h2><div class="ulist"><ul><li><p>Docker</p><div class="ulist"><ul><li><p>Container</p></li><li><p>Dockerfiles</p></li><li><p>Images</p></li><li><p>Docker Compose</p></li></ul></div></li><li><p>Kubernetes</p><div class="ulist"><ul><li><p>Minikube</p></li><li><p>OpenShift</p></li></ul></div></li></ul></div>
<div class="paragraph"><p>Referenzen</p></div>
<div class="ulist"><ul><li><p><a href="https://www.docker.com" class="bare">https://www.docker.com</a></p></li><li><p><a href="https://docs.docker.com/engine/reference/commandline/image" class="bare">https://docs.docker.com/engine/reference/commandline/image</a></p></li><li><p><a href="https://docs.docker.com/compose" class="bare">https://docs.docker.com/compose</a></p></li><li><p><a href="https://kubernetes.io" class="bare">https://kubernetes.io</a></p></li><li><p><a href="https://www.openshift.com" class="bare">https://www.openshift.com</a></p></li></ul></div></section>
<section><section id="_kennen_sie_docker_hello_world"><h2>Kennen Sie Docker Hello World?</h2><pre class="CodeRay listingblock"><code>$ docker run --rm  hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
0e03bdcc26d7: Pull complete
Digest: sha256:8c5aeeb6a5f3ba4883347d3747a7249f491766ca1caa47e5da5dfcf6b9b717c0
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/</code></pre></section><section id="_docker_bietet"><h2>Docker bietet</h2><div class="ulist"><ul><li><p>Prozess-Isolation</p></li><li><p>Virtuelle Netzwerke</p></li><li><p>Kommandozeilen-Werkzeuge</p></li></ul></div></section></section>
<section id="_übersicht_container_und_virtualisierung"><h2>Übersicht: Container und Virtualisierung</h2><div class="paragraph"><p><span class="image"><img src="images/uebersicht_container.png" alt="uebersicht container"></span></p></div></section>
<section><section id="_was_ist_kubernetes" class="columns"><h2>Was ist Kubernetes?</h2><div class="openblock"><div class="content"><div class="ulist"><ul><li><p>Cluster für Docker und rkt</p></li><li><p>"Application Server" für Container</p></li><li><p>Google-Projekt (auch: k8s, k8)</p></li><li><p>Konzepte</p><div class="ulist"><ul><li><p>Node: Maschine im Cluster</p></li><li><p>Pod:</p><div class="ulist"><ul><li><p>Kleinste Einheit, 1-n Container</p></li><li><p>1 Host, Ressource-Sharing</p></li></ul></div></li><li><p>Controller: Mind. einer pro Cluster</p></li><li><p>Service:</p><div class="ulist"><ul><li><p>Facade für Pods, z.B. ein Tier einer Application</p></li><li><p>Adressierung mittels DNS über ENV-Variablen</p></li></ul></div></li><li><p>Verschiedene Distributionen: z.B. OpenShift</p></li></ul></div></li></ul></div></div></div><div class="openblock"><div class="content"><div class="paragraph"><p><span class="image"><img src="images/kubernetes.png" alt="kubernetes" width="400"></span></p></div></div></div></section><section id="_architektur_3"><h2>Architektur</h2><div class="paragraph center"><p><span class="image"><img src="images/Kubernetes_archi.png" alt="Kubernetes archi"></span></p></div>
<div class="paragraph"><p>Bildquelle: <a href="https://en.wikipedia.org/wiki/Kubernetes#/media/File:Kubernetes.png" class="bare">https://en.wikipedia.org/wiki/Kubernetes#/media/File:Kubernetes.png</a>, Khtan66, CC-BY SA 4.0</p></div></section></section>
<section><section id="_docker_image_mit_quarkus_erzeugen_manuell"><h2>Docker Image mit Quarkus erzeugen (manuell)</h2><div class="paragraph"><p><strong>Maven Artefakt erstellen</strong></p></div><pre class="CodeRay listingblock"><code>$ mvn package
# ...
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  6.617 s
[INFO] Finished at: 2020-10-25T18:51:25+01:00
[INFO] ------------------------------------------------------------------------</code></pre><div class="paragraph"><p><strong>Image erzeugen</strong></p></div><pre class="CodeRay listingblock"><code>$ docker build -t quarkus/lesson03-rest -f src/main/docker/Dockerfile.jvm .
# ...
Successfully tagged quarkus/lesson03-rest:latest</code></pre><div class="paragraph"><p><strong>Container starten</strong></p></div><pre class="CodeRay listingblock"><code>$ docker run -it -p 4321:8080 --rm quarkus/lesson03-rest</code></pre><div class="paragraph"><p><strong>Test</strong></p></div><pre class="CodeRay listingblock"><code>$ curl -s http://localhost:4321/orders
[{&quot;customerId&quot;:42,&quot;orderDateTime&quot;:&quot;2020-10-25T17:57:44.659Z[UTC]&quot;,&quot;orderId&quot;:1,&quot;pizzaList&quot;:[&quot;Funghi&quot;],&quot;status&quot;:&quot;LOST&quot;,&quot;totalPrice&quot;:6.5}]</code></pre></section><section id="_variante_native_build"><h2>Variante: Native Build</h2><pre class="CodeRay listingblock"><code>$ mvn package -Pnative -Dnative-image.docker-build=true
# ....
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  02:25 min
[INFO] Finished at: 2020-10-25T19:05:36+01:00
[INFO] ------------------------------------------------------------------------</code></pre>
<div class="paragraph"><p><strong>Image erzeugen</strong></p></div>
<pre class="CodeRay listingblock"><code>$ docker build -t quarkus/lesson03-rest-native -f src/main/docker/Dockerfile.native .
# ...
Successfully tagged quarkus/lesson03-rest-native:latest</code></pre>
<div class="paragraph"><p><strong>Container starten</strong></p></div>
<pre class="CodeRay listingblock"><code>$ docker run -it -p 4321:8080 --rm quarkus/lesson03-rest</code></pre>
<div class="paragraph"><p><strong>Test</strong></p></div>
<pre class="CodeRay listingblock"><code>$ curl http://localhost:4321/orders
[{&quot;customerId&quot;:42,&quot;orderDateTime&quot;:&quot;2020-10-25T18:04:25.295Z[UTC]&quot;,&quot;orderId&quot;:1,&quot;pizzaList&quot;:[&quot;Funghi&quot;],&quot;status&quot;:&quot;LOST&quot;,&quot;totalPrice&quot;:6.5}]</code></pre></section></section>
<section id="_kubernetes_extension"><h2>Kubernetes Extension</h2><div class="ulist"><ul><li><p>Generierung von kubernetes.yaml und kubernetes.json</p></li><li><p>Beeinflussung durch Properties möglich</p></li><li><p>JIB: Alternative für automatisches Bauen von Images</p></li></ul></div>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>quarkus-kubernetes<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>quarkus-container-image-jib<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre></section>
<section id="_kubernetes_extension_2"><h2>Kubernetes Extension</h2><div class="paragraph"><p>application.properties:</p></div>
<pre class="CodeRay listingblock"><code>quarkus.container-image.build=true
quarkus.container-image.group=quarkus                     #optional, default to the system user name
quarkus.container-image.name=demo-app                     #optional, defaults to the application name
quarkus.container-image.tag=1.0                           #optional, defaults to the application version
quarkus.kubernetes.mounts.my-volume.path=/where/to/mount  #optional</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/deploying-to-kubernetes" class="bare">https://quarkus.io/guides/deploying-to-kubernetes</a></p></div></section>
<section id="_minikube"><h2>Minikube</h2><div class="ulist"><ul><li><p>Minimalistisches Kubernetes Cluster (1 Node)</p></li><li><p>Lokale Tests und Entwicklung</p></li><li><p>Treiber zur Virtualisierung benötigt (z.B. virtualbox, kvm2, Docker)</p></li></ul></div>
<div class="paragraph"><p><a href="https://kubernetes.io/de/docs/setup/minikube" class="bare">https://kubernetes.io/de/docs/setup/minikube</a>
<a href="https://minikube.sigs.k8s.io/docs/start" class="bare">https://minikube.sigs.k8s.io/docs/start</a></p></div>
<div class="paragraph"><p><strong>Installation auf Ubuntu</strong></p></div>
<pre class="CodeRay listingblock"><code class="bash language-bash"># KVM
$ sudo apt install qemu-kvm libvirt-daemon-system
$ sudo adduser $USER libvirt
$ sudo systemctl enable virtlogd.socket
$ sudo systemctl restart virtlogd.socket
$ exec sudo su -l $USER

# Minikube
$ curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube_latest_amd64.deb
$ sudo dpkg -i minikube_latest_amd64.deb

# kubectl
$ sudo snap install kubectl --classic</code></pre></section>
<section id="_minikube_2"><h2>Minikube</h2><div class="paragraph"><p><strong>Starten</strong></p></div>
<pre class="CodeRay listingblock"><code class="bash language-bash">$ minikube start --driver=kvm2

😄  minikube v1.16.0 auf Ubuntu 20.04
✨  Using the kvm2 driver based on existing profile
👍  Starting control plane node minikube in cluster minikube
🔄  Restarting existing kvm2 VM for &quot;minikube&quot; ...
🐳  Vorbereiten von Kubernetes v1.20.0 auf Docker 20.10.0...
🔎  Verifying Kubernetes components...
🌟  Enabled addons: storage-provisioner, default-storageclass
🏄  Done! kubectl is now configured to use &quot;minikube&quot; cluster and &quot;default&quot; namespace by default</code></pre>
<pre class="CodeRay listingblock"><code class="bash language-bash">$ kubectl get pods -A

kube-system       coredns-74ff55c5b-nhmkn            1/1     Running   2          100m
kube-system       etcd-minikube                      1/1     Running   2          100m
kube-system       kube-apiserver-minikube            1/1     Running   2          100m
kube-system       kube-controller-manager-minikube   1/1     Running   2          100m
kube-system       kube-proxy-5972h                   1/1     Running   2          100m
kube-system       kube-scheduler-minikube            1/1     Running   2          100m
kube-system       storage-provisioner                1/1     Running   4          100m</code></pre></section>
<section><section id="_minikube_extension"><h2>Minikube Extension</h2><div class="ulist"><ul><li><p>Vereinfachung des Deployments nach Minikube</p></li><li><p>Keine externe Docker Registry</p></li><li><p>NodePort statt Ingress</p></li><li><p>Generierung von minikube.yaml und minikube.json</p></li></ul></div><pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-minikube<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre></section><section id="_deployment_nach_minikube"><h2>Deployment nach Minikube</h2><pre class="CodeRay listingblock"><code># Namespace anlegen
$ kubectl create namespace lesson07-docker
namespace/lesson07-docker created

# In neuen Namespace wechseln
$ kubectl config set-context --current --namespace=lesson07-docker
Context &quot;minikube&quot; modified.

# Minikube Docker Daemon verwenden
$ eval $(minikube -p minikube docker-env)

# Projekt und Image bauen
$ mvn package

# Projekt deployen
$ kubectl apply -f target/kubernetes/kubernetes.json
# bzw.
$ kubectl apply -f target/kubernetes/minikube.json

# Deployment prüfen
$ kubectl get deployments
$ kubectl get pods
$ kubectl get services

# Ermitteln der Adresse (bei Minikube Extension -&gt; NodePort)
$ minikube service list</code></pre></section></section>
<section id="_aufgabe_lesson07_docker"><h2>Aufgabe lesson07-docker</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="ulist"><ul><li><p>Binden Sie die Minikube und JIB Extensions in das Projekt lesson04-checks ein, konfigurieren und bauen Sie es.</p></li><li><p>Starten Sie Minikube</p></li><li><p>Legen Sie das Image von lesson04-checks dort als Deployment ab.</p></li><li><p>Erzeugen Sie 10 Pods</p></li></ul></div>
<div class="paragraph"><p><strong>Hinweise</strong></p></div>
<div class="ulist"><ul><li><p>Sie können weitere Pod-Instanzen wie folgt erzeugen: <code>$ kubectl scale --replicas=3 deployment lesson07</code></p></li><li><p>Optional: Liefern Sie beide Anwendungen aus Aufgabe 4 aus. Wie können Sie die URL für den RestClient konfigurieren?</p></li></ul></div>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section>
<section id="_lektion_8_quarkus_messaging_kafka" data-state="no-title-footer"><h2>Lektion 8: Quarkus Messaging: Kafka</h2><div class="paragraph text-center"><p>Was wissen Sie über Messaging (z.B. JMS)?<br>
Haben Sie schon mal mit Kafka gearbeitet?<br></p></div>
<div class="paragraph text-center"><p>(Zusatz-Folien: Vorstellung Kafka)</p></div></section>
<section id="_kafka_einbindung_zugriff_in_kafka"><h2>Kafka: Einbindung &amp; Zugriff in Kafka</h2><div class="paragraph heading"><p>Vorbereitung</p></div>
<pre class="CodeRay listingblock"><code class="xml language-xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.quarkus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>quarkus-smallrye-reactive-messaging-kafka<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
<pre class="CodeRay listingblock"><code class="properties language-properties"># Configure the SmallRye Kafka connector
kafka.bootstrap.servers=&lt;kafka-server&gt;:9092

# Configure the Kafka sink (we write to it)
mp.messaging.outgoing.generated-price.connector=smallrye-kafka
mp.messaging.outgoing.generated-price.topic=prices
mp.messaging.outgoing.generated-price.value.serializer=org.apache.kafka.common.serialization.IntegerSerializer

# Configure the Kafka source (we read from it)
mp.messaging.incoming.prices.connector=smallrye-kafka
mp.messaging.incoming.prices.value.deserializer=org.apache.kafka.common.serialization.IntegerDeserializer</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/kafka">&#8594; Guide: Using Apache Kafka with Reactive Messaging</a></p></div></section>
<section id="_kafka_zugriff_in_java"><h2>Kafka: Zugriff in Java</h2><div class="paragraph"><p><strong>Consumer</strong></p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PriceGenerator</span> {

    <span class="annotation">@Incoming</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">prices</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> CompletionStage&lt;<span class="predefined-type">Void</span>&gt; consume(Message&lt;<span class="predefined-type">Integer</span>&gt; price) { <span class="keyword">return</span> price.ack(); }

    <span class="comment">// Alternativ</span>
    <span class="annotation">@Incoming</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">prices</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> consume(<span class="type">int</span> price) { <span class="comment">/* process your price. */</span> }
}</code></pre>
<div class="paragraph"><p><strong>Producer</strong></p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="directive">public</span> <span class="type">class</span> <span class="class">KafkaPriceProducer</span> {

    <span class="annotation">@Outgoing</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">prices</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Multi&lt;Message&lt;<span class="predefined-type">Integer</span>&gt;&gt; generate() {
        <span class="keyword">return</span> Multi.createFrom().ticks().every(<span class="predefined-type">Duration</span>.ofSeconds(<span class="integer">1</span>)).map(x -&gt; <span class="integer">4711</span>);
    }

    <span class="comment">// Alternativ</span>
    <span class="annotation">@Outgoing</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">prices</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Multi&lt;<span class="predefined-type">Integer</span>&gt; generate() {
        <span class="keyword">return</span> Multi.createFrom().ticks().every(<span class="predefined-type">Duration</span>.ofSeconds(<span class="integer">1</span>)).map(x -&gt; Message.of(random.nextDouble()));;
    }
}</code></pre>
<div class="paragraph"><p><a href="https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/3.4/kafka/kafka.html">
&#8594; SmallRye Reactive Messaging: Kafka</a></p></div></section>
<section id="_json_payload"><h2>JSON-Payload</h2><div class="paragraph"><p><strong>POJO</strong></p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Fruit</span> {

    <span class="directive">public</span> <span class="predefined-type">String</span> name;
    <span class="directive">public</span> <span class="type">int</span> price;

    <span class="directive">public</span> Fruit() { }
    <span class="directive">public</span> Fruit(<span class="predefined-type">String</span> name, <span class="type">int</span> price) { <span class="local-variable">this</span>.name = name; <span class="local-variable">this</span>.price = price;}
}</code></pre>
<div class="paragraph"><p><strong>Deserializer</strong></p></div>
<pre class="CodeRay listingblock"><code class="java language-java"><span class="directive">public</span> <span class="type">class</span> <span class="class">FruitDeserializer</span> <span class="directive">extends</span> JsonbDeserializer&lt;Fruit&gt; {
    <span class="directive">public</span> FruitDeserializer(){
        <span class="local-variable">super</span>(Fruit.class);
    }
}</code></pre>
<pre class="CodeRay listingblock"><code class="properties language-properties">mp.messaging.incoming.fruit-in.connector=smallrye-kafka
mp.messaging.incoming.fruit-in.topic=fruit-in
mp.messaging.incoming.fruit-in.value.deserializer=com.acme.fruit.jsonb.FruitDeserializer
mp.messaging.outgoing.fruit-out.connector=smallrye-kafka
mp.messaging.outgoing.fruit-out.topic=fruit-out
mp.messaging.outgoing.fruit-out.value.serializer=io.quarkus.kafka.client.serialization.JsonbSerializer</code></pre>
<div class="paragraph"><p><a href="https://quarkus.io/guides/kafka">&#8594; Guide: Using Apache Kafka with Reactive Messaging</a></p></div></section>
<section id="_lesson08_kafka"><h2>lesson08-kafka</h2><div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="paragraph"><p>Arbeiten Sie das Tutorial <a href="https://medium.com/big-data-engineering/hello-kafka-world-the-complete-guide-to-kafka-with-docker-and-python-f788e2588cfc">Hello Kafka World!</a> bis einschließlich "Hello Consumer" durch.</p></div>
<div class="paragraph"><p>Legen Sie anschließend die Topics <code>order-v1-incoming</code> und <code>order-v1-delivery</code> auf Ihrem lokalen Kafka Broker an.</p></div>
<div class="paragraph"><p>Zur Integration in das Franchise soll der Pizza-Service Aufträge danach per Kafka in JSON abwickeln:</p></div>
<div class="ulist"><ul><li><p><code>order-v1-incoming</code> wird konsumiert. Hier gehen Bestellungen ein.</p></li><li><p><code>order-v1-delivery</code> wird produziert. Hier gehen Bestellungen an die Lieferabteilung</p><div class="ulist"><ul><li><p>Eine Bestellung ist lieferbereit, wenn per REST der Status auf <code>IN_DELIVERY</code> gesetzt wird</p></li></ul></div></li></ul></div></section>
<section id="_lesson08_kafka_2"><h2>lesson08-kafka</h2><div class="paragraph"><p><strong>Hinweise</strong></p></div>
<div class="ulist"><ul><li><p>Ein Skelett liegt in lesson08-kafka. Es basiert auf <code>lesson03-panache</code>. Eine Beispiellösung liegt im
Ordner <code>solutions/lesson08-kafka</code>.</p></li><li><p>Ein einzelner Kafka Broker sowie ein Topic ohne Partitionierung und Replizierung ist ausreichend.</p></li><li><p>Port des lokalen Brokers: <code>$ docker port $(docker ps | grep 9092 | awk '{print $1}') 9092</code></p></li><li><p>Erzeugen: <code>kafkacat -b localhost:&lt;PORT&gt; -t order-v1-incoming -T -P order.json</code></p></li><li><p>Lesen : <code>kafkacat -b localhost:&lt;PORT&gt; -t order-v1-delivery</code></p></li></ul></div>
<div class="paragraph"><p><a href="https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/2.2/emitter/emitter.html">
&#8594; Emitter - Senden ohne @Outgoing</a> | <a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a>
== Aufgabe: lesson09-distributed-system</p></div>
<div class="paragraph"><p><strong>Aufgabenstellung</strong></p></div>
<div class="paragraph"><p>Implementieren Sie ein größeres, verteiltes System mit potentiell verschiedenen µServices.</p></div>
<div class="paragraph"><p><strong>Hinweise</strong></p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Die Funktionsweise ist im Verzeichnis <code>lesson09-distributed-system/use-cases.html</code> beschrieben. Es gibt einen PDF-Export</p></li><li><p>Für diese Aufgabe gibt es keine Beispiellösung. Bitte orientieren Sie sich an den vorangegangen Beispielen</p></li><li><p>Ziel der Aufgabe ist es, komplexere Fachlichkeit in einer µService Architektur zu implementieren.</p></li></ol></div>
<div class="paragraph"><p><a href="index.html#/_agenda">&#8594; Zurück zur Übersicht</a></p></div></section></div></div><script src="reveal.js-3.9.2/lib/js/head.min.js"></script><script src="reveal.js-3.9.2/js/reveal.js"></script><script>// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display controls in the bottom right corner
  controls: true,
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: true,
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Enable slide navigation via mouse wheel
  mouseWheel: true,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  previewLinks: false,
  // Theme (e.g., beige, black, league, night, serif, simple, sky, solarized, white)
  // NOTE setting the theme in the config no longer works in reveal.js 3.x
  //theme: Reveal.getQueryHash().theme || 'anderscore',
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: Reveal.getQueryHash().transition || 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1728,
  height: 972,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js-3.9.2/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js-3.9.2/plugin/title-footer/title-footer.js', async: true, callback: function()
          {title_footer.initialize('Jakarta EE Microservices mit Quarkus & MicroProfile', 'MJohenneken, ALambertz', 'anderScore GmbH • Frankenwerft 35 • 50667 Köln');}},
      { src: 'reveal.js-3.9.2/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js-3.9.2/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      
      { src: 'reveal.js-3.9.2/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js-3.9.2/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
  ]
});</script></body></html>